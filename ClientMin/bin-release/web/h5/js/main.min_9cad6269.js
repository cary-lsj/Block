var __reflect=this&&this.__reflect||function(t,e,o){t.__class__=e,o?o.push(e):o=[e],t.__types__=t.__types__?o.concat(t.__types__):o},__extends=this&&this.__extends||function(t,e){function o(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);o.prototype=e.prototype,t.prototype=new o},__awaiter=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(i,r){function a(t){try{c(n.next(t))}catch(e){r(e)}}function s(t){try{c(n["throw"](t))}catch(e){r(e)}}function c(t){t.done?i(t.value):new o(function(e){e(t.value)}).then(a,s)}c((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function o(t){return function(e){return n([t,e])}}function n(o){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,r&&(a=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[0,a.value]),o[0]){case 0:case 1:a=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,r=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){c=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){c.label=o[1];break}if(6===o[0]&&c.label<a[1]){c.label=a[1],a=o;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(o);break}a[2]&&c.ops.pop(),c.trys.pop();continue}o=e.call(t,c)}catch(n){o=[6,n],r=0}finally{i=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}var i,r,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:o(0),"throw":o(1),"return":o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},__decorate=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,a=3>r?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(3>r?i(a):r>3?i(e,o,a):i(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a},game;!function(t){var e=function(){function e(){var e=this.__injectProxyMap;for(var o in e)for(var n=e[o],i=0,r=n.length;r>i;i++){var a=n[i];this[a]=t.ModelManager.instance.getProxy(o)}}return e.prototype.dispatch=function(e){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];(i=t.Controller.instance).executeCommand.apply(i,[e].concat(o)),(r=t.Provider.instance).dispatch.apply(r,[e].concat(o));var i,r},e}();t.Notifier=e,__reflect(e.prototype,"game.Notifier",["game.INotifier"])}(game||(game={}));var game;!function(t){var e=function(e){function o(){return e.call(this)||this}return __extends(o,e),o.prototype.addListener=function(e,o,n){t.Provider.instance.addListener(e,o,n)},o.prototype.removeListener=function(e,o,n){t.Provider.instance.removeListener(e,o,n)},o}(t.Notifier);t.Observer=e,__reflect(e.prototype,"game.Observer",["game.IObserver"])}(game||(game={}));var game;!function(t){var e=function(){function e(t){this._send=t.send.bind(t)}return e.prototype.send_CreateRoom=function(){var e=new gameMsg.CreateRoomRequest;e.sID=t.GlobalInfo.account;var o=new gameMsg.Request;o.createRoomRequest=e,this.send_Msg(gameMsg.EnumMsg.createroomrequest,o)},e.prototype.send_JoinRoom=function(e){var o=new gameMsg.JoinRoomRequest;o.sRoomID=e,o.sID=t.GlobalInfo.account;var n=new gameMsg.Request;n.joinRoomRequest=o,this.send_Msg(gameMsg.EnumMsg.joinroomrequest,n)},e.prototype.send_LeaveRoom=function(e){var o=new gameMsg.LeaveRoomRequest;o.sID=t.GlobalInfo.account,o.sRoomID=e;var n=new gameMsg.Request;n.leaveRoomRequest=o,this.send_Msg(gameMsg.EnumMsg.leaveroomrequest,n)},e.prototype.send_EndGame=function(e){var o=new gameMsg.EndGameRequest;o.sID=t.GlobalInfo.account,o.sRoomID=e;var n=new gameMsg.Request;n.endGameRequest=o,this.send_Msg(gameMsg.EnumMsg.endgamerequest,n)},e.prototype.send_StarPkGame=function(e){var o=new gameMsg.StartGameRequest;o.sID=t.GlobalInfo.account,o.sRoomID=e;var n=new gameMsg.Request;n.startGameRequest=o,this.send_Msg(gameMsg.EnumMsg.startgamerequest,n)},e.prototype.send_MatchGame=function(e){var o=new gameMsg.MatchGameRequest;o.sID=t.GlobalInfo.account,o.sRoomID=e;var n=new gameMsg.Request;n.matchGameRequest=o,this.send_Msg(gameMsg.EnumMsg.matchgamerequest,n)},e.prototype.send_UseTool=function(e){var o=new gameMsg.UseToolRequest;o.sID=t.GlobalInfo.account,o.goodID=e.toString(),o.sRoomID=t.$userData.pkRoomVO.id,o.sDID=t.$userData.pkRoomVO.opponentID;var n=new gameMsg.Request;n.useToolRequest=o,this.send_Msg(gameMsg.EnumMsg.usetoolrequest,n)},e.prototype.send_AddBlock=function(e){var o=new gameMsg.PlayBlockAddRequest;o.sID=t.GlobalInfo.account,o.sRoomID=t.$userData.pkRoomVO.id,o.gateID=e;var n=new gameMsg.Request;n.playBlockAddRequest=o,this.send_Msg(gameMsg.EnumMsg.playblockaddrequest,n)},e.prototype.send_DeleteBlock=function(e){var o=new gameMsg.PlayBlockDeleteRequest;o.sID=t.GlobalInfo.account,o.sRoomID=t.$userData.pkRoomVO.id,o.gateID=e;var n=new gameMsg.Request;n.playBlockDeleteRequest=o,this.send_Msg(gameMsg.EnumMsg.playblockdeleterequest,n)},e.prototype.send_Msg=function(t,e){var o=new gameMsg.Msg;o.type=t,o.request=e,this._send(o)},e}();t.NetSender=e,__reflect(e.prototype,"game.NetSender")}(game||(game={}));var game;!function(t){var e=function(t){function e(e){var o=t.call(this)||this;return o.horizontalCenter=0,o.skinName=e,o}return __extends(e,t),Object.defineProperty(e.prototype,"layer",{get:function(){return 4},enumerable:!0,configurable:!0}),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.percentHeight=100,this._component=this.createComponent(),this.content&&this._component&&this.content.addChild(this._component)},e}(eui.Component);t.FullWindowBase=e,__reflect(e.prototype,"game.FullWindowBase",["game.IModuleView"])}(game||(game={}));var game;!function(t){function e(t){t.__cacheCommand=!0}var o=function(e){function o(){var o=e.call(this)||this;return o._facade=t.Facade.instance,o}return __extends(o,e),o}(t.Notifier);t.Command=o,__reflect(o.prototype,"game.Command",["game.ICommand"]),t.CacheCommand=e}(game||(game={}));var game;!function(t){function e(t){var e=String(t);return function(t,o){t.__injectProxyMap||(t.__injectProxyMap={});var n=t.__injectProxyMap;n[e]||(n[e]=[]);var i=n[e];-1==i.indexOf(o)&&i.push(o)}}var o=function(e){function o(o){var n=e.call(this)||this;return n._facade=t.Facade.instance,n._name=o,n}return __extends(o,e),Object.defineProperty(o.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),o.prototype.onRegister=function(){},o.prototype.onRemove=function(){},o}(t.Notifier);t.AbstractProxy=o,__reflect(o.prototype,"game.AbstractProxy",["game.IProxy"]),t.InjectProxy=e}(game||(game={}));var game;!function(t){function e(t){var e=String(t);return function(t,o,n){t.__interestNotifyList||(t.__interestNotifyList={});var i=t.__interestNotifyList;i[e]||(i[e]=[]);var r=i[e],a=n.value;-1==r.indexOf(a)&&r.push(a)}}function o(t){return function(e,o,n){e.__interestEventList||(e.__interestEventList={});var i=e.__interestEventList;i[t]||(i[t]=[]);var r=i[t],a=n.value;-1==r.indexOf(a)&&r.push(a)}}var n=function(e){function o(){var o=e.call(this)||this;return o._facade=t.Facade.instance,o}return __extends(o,e),Object.defineProperty(o.prototype,"view",{get:function(){return this._view},set:function(t){this._view=t},enumerable:!0,configurable:!0}),o.prototype.onRegister=function(){var t=this.addListener.bind(this),e=this.__interestNotifyList;for(var o in e){var n=e[o];for(var i in n){var r=n[i];t(o,r,this)}}var a=this._view.addEventListener.bind(this._view),s=this.__interestEventList;for(var c in s){var n=s[c];for(var i in n){var r=n[i];a(c,r,this)}}},o.prototype.onRemove=function(){var t=this.removeListener.bind(this),e=this.__interestNotifyList;for(var o in e){var n=e[o];for(var i in n){var r=n[i];t(o,r,this)}}var a=this._view.removeEventListener.bind(this._view),s=this.__interestEventList;for(var c in s){var n=s[c];for(var i in n){var r=n[i];a(c,r,this)}}},o}(t.Observer);t.AbstractMediator=n,__reflect(n.prototype,"game.AbstractMediator",["game.IMediator"]),t.InterestNotify=e,t.InterestEvent=o}(game||(game={}));var game;!function(t){var e=function(e){function o(){return e.call(this)||this}return __extends(o,e),o.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},o.prototype.dataChanged=function(){for(var t=this.data,e=t.data,o=0;o<e.length;o++)for(var n=e[o],i=0;i<n.length;i++){var r=n[i];1==r&&this.createSquare(o,i),2==r&&this.createSquare(o,i,"8")}},o.prototype.createSquare=function(e,o,n){void 0===n&&(n="");var i=new t.Square(n),r={x:o,y:e};t.MapUtil.getPixel(r,i),this.addChild(i)},o}(eui.ItemRenderer);t.MapBaseItem=e,__reflect(e.prototype,"game.MapBaseItem")}(game||(game={}));var game;!function(t){var e=function(){function e(t){this._send=t.send.bind(t)}return e.prototype.send_CLogin_Login=function(){var e={sID:"",sHeadimg:"",sNick:""};e.sID=t.GlobalInfo.account,e.sHeadimg=js_userInfo.avatarUrl,e.sNick=js_userInfo.nickName,this.send_Msg(gameMsg.EnumMsg.loginrequest,e,t.Route.loginwx)},e.prototype.send_Play_Begin=function(e){var o={sID:"",gateID:e};o.sID=t.$userData.account.userid+"",this.send_Msg(gameMsg.EnumMsg.playbeginrequest,o,t.Route.palybegin)},e.prototype.send_Play_End=function(e){var o={sID:"",gateID:e};o.sID=t.$userData.account.userid+"",this.send_Msg(gameMsg.EnumMsg.playendrequest,o,t.Route.palyend)},e.prototype.send_See_Ad=function(e){var o={sID:"",adID:e};o.sID=t.$userData.account.userid+"",this.send_Msg(gameMsg.EnumMsg.seeadrequest,o,t.Route.seead)},e.prototype.send_Use_Prompt=function(){var e={sID:""};e.sID=t.$userData.account.userid+"",this.send_Msg(gameMsg.EnumMsg.usepromptrequest,e,t.Route.useprompt)},e.prototype.send_Rank=function(){var e={sID:""};e.sID=t.$userData.account.userid+"",this.send_Msg(gameMsg.EnumMsg.rankrequest,e,t.Route.rank)},e.prototype.send_BuyTool=function(e){var o={goods:[],nUserID:""};o.goods=e,o.nUserID=t.$userData.account.userid,this.send_Msg(gameMsg.EnumMsg.buyrequest,o,t.Route.buy)},e.prototype.send_Msg=function(t,e,o){var n={type:t,request:{}};n.request=e,this._send(n,o)},e}();t.HttpSender=e,__reflect(e.prototype,"game.HttpSender")}(game||(game={})),function(){var t,e,o;e=Object.prototype,Object.defineProperties(e,{getPropertyDescriptor:{value:function(t){var e=Object.getOwnPropertyDescriptor(this,t);if(e)return e;var o=Object.getPrototypeOf(this);return o?o.getPropertyDescriptor(t):void 0},enumerable:!1},shallowClone:{value:function(){var t={};return this.shallowCloneTo(t),t},enumerable:!1},shallowCloneTo:{value:function(t){for(var e in this)if(e in t){var o=t.getPropertyDescriptor(e);o&&(o.set||o.writable)&&(t[e]=this[e])}else t[e]=this[e]},enumerable:!1},deepClone:{value:function(){var t=JSON.stringify(this);return JSON.parse(t)},enumerable:!1},deepCloneTo:{value:function(t){var e=this.deepClone();for(var o in e)if(o in t){var n=t.getPropertyDescriptor(o);n&&(n.set||n.writable)&&(t[o]=e[o])}else t[o]=e[o]},enumerable:!1},clearAllProperty:{value:function(){for(var t in this)delete this[t]},enumerable:!1}}),e=Number.prototype,Object.defineProperties(e,{toFormat:{value:function(){var t=this.valueOf();return t.toString()},enumerable:!1}}),e=String.prototype,Object.defineProperties(e,{splitNum:{value:function(t,e){for(var o=this.split(t,e),n=0,i=o.length;i>n;n++)o[n]=parseFloat(o[n]);return o},enumerable:!1}}),t=Array,t.NORMAL=0,t.CASEINSENSITIVE=1,t.DESCENDING=2,t.RETURNINDEXEDARRAY=4,t.NUMERIC=8,e=Array.prototype,Object.defineProperties(e,{pushUnique:{value:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var o=0,n=t;o<n.length;o++){var i=n[o];-1==this.indexOf(i)&&(this[this.length]=i)}return this.length},enumerable:!1},sortOn:{value:function(t,e){function o(t,e){e=e||0;var o=[];t&&o.push(function(){return this[t]}),o.push(e&Array.NUMERIC?function(){return parseFloat(this)}:function(){return"string"==typeof this&&this||"number"==typeof this&&""+this||this&&this.toString()||this}),e&Array.CASEINSENSITIVE&&o.push(String.prototype.toLowerCase),o.apply=Array.prototype.reduce.bind(o,function(t,e){return e.apply(t)});var n=e&Array.DESCENDING?-1:1,i=-n;return function(t,e){return t=o.apply(t),e=o.apply(e),t>e||null!=t&&null==e?n:e>t||null==t&&null!=e?i:0}}var n=this;Array.isArray(t)||(t=[t]),Array.isArray(e)||(e=[e]),t.length!==e.length&&(e=new Array(t.length).fill(0));var i=e[0]&Array.RETURNINDEXEDARRAY;i&&(n=Array.from(n));var r=t.map(function(t,n){return o(t,e[n])}),a=n.sort(function(t,e){return r.reduce(function(o,n){return o||n(t,e)},0)});return i?a:void 0},enumerable:!1},remove:{value:function(t){var e=this.indexOf(t);return e>-1?(this.splice(e,1),!0):!1},enumerable:!1}}),e=egret.EventDispatcher.prototype,e.on=e.addEventListener,e.dispatch=e.dispatchEventWith,e.off=e.removeEventListener,e=egret.ByteArray.prototype,Object.defineProperties(e,{decodeUTF8:{value:function(t){for(var e,o=!1,n=0,i=[],r=0,a=0,s=0,c=0;t.length>n;){var u=t[n++];if(u==this.EOF_byte)e=0!=a?this.decoderError(o):this.EOF_code_point;else if(0==a)this.inRange(u,0,127)?e=u:(this.inRange(u,194,223)?(a=1,c=128,r=u-192):this.inRange(u,224,239)?(a=2,c=2048,r=u-224):this.inRange(u,240,244)?(a=3,c=65536,r=u-240):this.decoderError(o),r*=Math.pow(64,a),e=null);else if(this.inRange(u,128,191))if(s+=1,r+=(u-128)*Math.pow(64,a-s),s!==a)e=null;else{var p=r,l=c;r=0,a=0,s=0,c=0,e=this.inRange(p,l,1114111)&&!this.inRange(p,55296,57343)?p:this.decoderError(o,u)}else r=0,a=0,s=0,c=0,n--,e=this.decoderError(o,u);null!==e&&e!==this.EOF_code_point&&(65535>=e?e>0&&i.push(String.fromCharCode(e)):(e-=65536,i.push(String.fromCharCode(55296+(e>>10&1023))),i.push(String.fromCharCode(56320+(1023&e)))))}return i.join("")},enumerable:!1}}),e=egret.DisplayObject.prototype,Object.defineProperties(e,{__dispatchAddedEvent:{value:function(t){return this.dispatchEventWith(egret.Event.ADDED,!0)},enumerable:!1},removeSelf:{value:function(){this.parent&&this.parent.removeChild(this)},enumerable:!1}}),e=egret.DisplayObjectContainer.prototype,o=e.$doAddChild,Object.defineProperties(e,{$doAddChild:{value:function(t,e,n){void 0===n&&(n=!0);var i=Object.getPrototypeOf(t),r=i.constructor.__isMediatorView;return r&&!this.stage&&(t instanceof eui.Component&&!t.$UIComponent[29]?t.once(eui.UIEvent.CREATION_COMPLETE,function(e){t.on(egret.Event.ADDED_TO_STAGE,t.__dispatchAddedEvent,t),t.__dispatchAddedEvent()},this):t.on(egret.Event.ADDED_TO_STAGE,t.__dispatchAddedEvent,t)),o.call(this,t,e,n)},enumerable:!1}}),Object.defineProperties(egret.Tween,{getInFight:{value:function(t,e,o,n){n&&egret.Tween.removeTweens(t);var i=new egret.Tween(t,e,o);return i.useFightRate=!0,i},enumerable:!1}}),e=egret.Tween.prototype,Object.defineProperties(e,{$tick:{value:function(t){if(!this.paused){var e;e=this.useFightRate?this._prevPosition+t*game.$clock.fightClock.runningRate:this._prevPosition+t,this.setPosition(e)}},enumerable:!1}}),Object.defineProperties(RES,{isResLoaded:{value:function(t){var e=RES.config.getResource(t);return e?!!RES.host.get(e):!1},enumerable:!1}}),e=RES.Resource.prototype,Object.defineProperties(e,{getResAsync:{value:function(t,e,o){var n=this,i=t;try{var r=RES.config.getResourceWithSubkey(t,!0),a=r.r,s=r.subkey}catch(c){return e&&e.call(o,void 0,i),RES.ResourceEvent.dispatchResourceEvent(this,RES.ResourceEvent.ITEM_LOAD_ERROR,"",a),Promise.reject(c)}return RES.queue.loadResource(a).then(function(n){RES.host.save(a,n);var r=RES.processor.isSupport(a);return r&&r.getData&&s&&(n=r.getData(RES.host,a,t,s)),e&&e.call(o,n,i),n},function(t){return RES.host.remove(a),e&&e.call(o,void 0,i),RES.ResourceEvent.dispatchResourceEvent(n,RES.ResourceEvent.ITEM_LOAD_ERROR,"",a),Promise.reject(t)})},enumerable:!1},getResByUrl:{value:function(t,e,o,n){var i=this;void 0===n&&(n="");var r=RES.config.getResource(t);if(!r&&(n||(n=RES.config.__temp__get__type__via__url(t)),r={name:t,url:t,type:n,root:"",extra:1},RES.config.addResourceData(r),r=RES.config.getResource(t),!r))throw"never";return RES.queue.loadResource(r).then(function(t){return RES.host.save(r,t),e&&r&&e.call(o,t,r.url),t},function(t){return RES.host.remove(r),e&&r&&e.call(o,void 0,r.url),RES.ResourceEvent.dispatchResourceEvent(i,RES.ResourceEvent.ITEM_LOAD_ERROR,"",r),Promise.reject(t)})},enumerable:!1}})}();var game;!function(t){var e=function(e){function o(){var t=e.call(this)||this;return t._subCommands=[],t.initializeCommands(),t}return __extends(o,e),o.prototype.addSubCommand=function(t){this._subCommands.push(t)},o.prototype.execute=function(e){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];for(;0!=this._subCommands.length;){var i=this._subCommands.shift();if(i.prototype.constructor.__cacheCommand){var r=t.recyclable(i);r.execute.apply(r,[e].concat(o)),r.recycle()}else{var r=new i;r.execute.apply(r,[e].concat(o))}}},o}(t.Command);t.CommandQueue=e,__reflect(e.prototype,"game.CommandQueue")}(game||(game={}));var game;!function(t){var e=function(t){function e(e,o){var n=t.call(this)||this;return n._modal=!0,n._tapMaskClose=!0,n._hiding=!1,o?o.shallowCloneTo(n):(n.horizontalCenter=0,n.verticalCenter=-40),n.skinName=e,n}return __extends(e,t),Object.defineProperty(e.prototype,"layer",{get:function(){return 6},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modal",{get:function(){return this._modal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tapMaskClose",{get:function(){return this._tapMaskClose},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hiding",{get:function(){return this._hiding},set:function(t){this._hiding=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"component",{get:function(){return this._component},enumerable:!0,configurable:!0}),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._component=this.createComponent(),this.content&&this._component&&this.content.addChild(this._component)},e}(eui.Component);t.DialogBase=e,__reflect(e.prototype,"game.DialogBase",["game.IDialog","egret.DisplayObject","game.IModuleView"])}(game||(game={}));var game;!function(t){var e=function(){function e(){this._controller=t.Controller.instance,this._provider=t.Provider.instance,this._modelManager=t.ModelManager.instance,this._viewManager=t.ViewManager.instance}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e)},enumerable:!0,configurable:!0}),e.prototype.dispatch=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];(n=this._controller).executeCommand.apply(n,[t].concat(e)),(i=this._provider).dispatch.apply(i,[t].concat(e));var n,i},e.prototype.registerCommand=function(t,e){this._controller.registerCommand(t,e)},e.prototype.hasCommand=function(t){return this._controller.hasCommand(t)},e.prototype.removeCommand=function(t){this._controller.removeCommand(t)},e.prototype.addListener=function(t,e,o){this._provider.addListener(t,e,o)},e.prototype.removeListener=function(t,e,o){this._provider.removeListener(t,e,o)},e.prototype.registerProxy=function(t){this._modelManager.registerProxy(t)},e.prototype.hasProxy=function(t){return this._modelManager.hasProxy(t)},e.prototype.getProxy=function(t){return this._modelManager.getProxy(t)},e.prototype.removeProxy=function(t){return this._modelManager.removeProxy(t)},Object.defineProperty(e.prototype,"contextView",{get:function(){return this._viewManager.contextView},set:function(t){this._viewManager.contextView=t},enumerable:!0,configurable:!0}),e.prototype.registerMediator=function(t,e){this._viewManager.registerMediator(t,e)},e.prototype.hasMediator=function(t){return this._viewManager.hasMediator(t)},e.prototype.getMediator=function(t){return this._viewManager.getMediator(t)},e.prototype.removeMediator=function(t,e){this._viewManager.removeMediator(t,e)},e}();t.Facade=e,__reflect(e.prototype,"game.Facade")}(game||(game={}));var game;!function(t){function e(e){var o=e.__pool;if(!o){var n=e.prototype.constructor.__cacheMaxCount||50;o=new t.ObjectPool(e,n);var i=e.prototype;i.hasOwnProperty("recycle")||(i.recycle=function(){o.join(this)}),e.__pool=o,t.POOLS[egret.getQualifiedClassName(e)]=o}return o.take()}function o(t){return function(e){e.__cacheMaxCount=t}}function n(t,e){t.prototype.constructor.__cacheMaxCount=e}t.POOLS={},t.recyclable=e,t.DeployPool=o,t.deployPool=n}(game||(game={}));var game;!function(t){var e=function(e){function o(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(o,e),o.prototype.onAddToStage=function(e){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),t.Global.init(this.stage),!egret.Capabilities.isMobile,egret.ImageLoader.crossOrigin="anonymous",egret.TextField.default_fontFamily="SimHei",egret.registerImplementation("eui.IAssetAdapter",new AssetAdapter),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter);var o=2;RES.setMaxLoadingThread(o),t.RESP.setMaxLoadingThread(o),t.SoundManager.getInstance(),t.$facade.registerCommand(2,t.ContextInitCommand),t.$facade.dispatch(2)},o}(egret.DisplayObjectContainer);t.GameApp=e,__reflect(e.prototype,"game.GameApp")}(game||(game={}));var game;!function(t){var e=function(e){function o(t){return void 0===t&&(t="gameSkin.MainSkin"),e.call(this,t)||this}return __extends(o,e),o.prototype.createComponent=function(){},o.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.btn_menu.on(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),this.btn_refresh.on(egret.TouchEvent.TOUCH_TAP,this.onRefreshClick,this),this.btn_key.on(egret.TouchEvent.TOUCH_TAP,this.onKeyClick,this),this.btn_key.group.addChild(this.keynum)},o.prototype.onMenuClick=function(){this.dispatch(4,!0)},o.prototype.onRefreshClick=function(){this.dispatch(3,!0)},o.prototype.onKeyClick=function(){this.dispatch(8,!0)},o.prototype.updateData=function(t){this.map.data=t.GameMapVO.mapData;this.map.x=(this.width-this.map.width)/2,this.map.y=this.height/56*23-this.map.height/2,this.map_rect.visible=!1,this.refreshList(t.moodListVO)},o.prototype.refreshList=function(e){e.sort(function(t,e){return Math.random()>.5?-1:1});for(var o=(this.getGenWidth(e),0);o<e.length;o++){var n=e[o];this.setcoloer(n,o);var i=this.refresh_mapmood(n);i.y=750,i.x=this._moodX,this._moodX+=(n.colGrids+1)*t.MapUtil.mapGridWidth*.5,i.initmapMood(i.x,i.y),this.grp_mood.addChild(i)}},o.prototype.setcoloer=function(t,e){e>=0&&6>e?t.type=e+1:12>e?t.type=e-5:console.log("颜色设置出错！")},o.prototype.getGenWidth=function(e){for(var o=0,n=0;n<e.length;n++){var i=e[n];if(o+=i.colGrids+1,o>25){o-=i.colGrids+1;break}}var r=(o-1)*t.MapUtil.mapGridWidth*.5;return this._moodX=(this.width-r)/2,this._moodX},o.prototype.refresh_mapmood=function(e){var o=new t.MapMoodItem;return o.data=e,this.dispatch(9,!0,e),o},o.prototype.refresh_keymood=function(e){var o=new t.KeyMoodItem;return o.data=e,o},o.prototype.gameover=function(){this.map.removeChildren(),this.grp_mood.removeChildren()},o}(t.FullWindowBase);t.MainFullWindow=e,__reflect(e.prototype,"game.MainFullWindow")}(game||(game={}));var game;!function(t){var e=function(){function t(){this._checkTime=1e4,this._resMap={}}return Object.defineProperty(t.prototype,"checkTime",{get:function(){return this._checkTime},set:function(t){this._checkTime=t},enumerable:!0,configurable:!0}),t.prototype.clearRes=function(t){for(var e in this._resMap){var o=this._resMap[e];2==o.status&&o.usingCount<=0&&o.lastUseTime+o.liveTime<=t&&(o.destroy(),o.recycle(),delete this._resMap[e])}},t.prototype.forceClear=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(t&&0!=t.length){if(1==t.length)return this.destroyRes(t[0]);for(var o=[],n=0,i=t;n<i.length;n++){var r=i[n];o.push(this.destroyRes(r))}return o}},t.prototype.destroyRes=function(t){var e=this._resMap[t];if(!e||2!=e.status||e.usingCount>0)return!1;var o=e.destroy();return e.recycle(),delete this._resMap[t],o},t}();t.ResMgrBase=e,__reflect(e.prototype,"game.ResMgrBase")}(game||(game={}));var game;!function(t){var e=function(e){function o(){return e.call(this)||this}return __extends(o,e),o.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},o.prototype.dataChanged=function(){for(var t=this.data,e=t.type+"",o=t.data,n=0;n<o.length;n++)for(var i=o[n],r=0;r<i.length;r++){var a=i[r];1==a&&this._createSquare(n,r,e)}},o.prototype._createSquare=function(e,o,n){var i=new t.Square(n),r={x:o,y:e};t.MapUtil.getMoodPixel(r,i),this.addChild(i)},o}(t.MapBaseItem);t.MoodBase=e,__reflect(e.prototype,"game.MoodBase")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var o=e.call(this)||this;return o._panelState=t.PanelStateManager.instance,o}return __extends(o,e),o.prototype.onRegister=function(){e.prototype.onRegister.call(this)},o.prototype.onRemove=function(){e.prototype.onRemove.call(this),this._panelState.targetRemoved(this._view)},o}(t.AbstractMediator);t.MediatorBase=e,__reflect(e.prototype,"game.MediatorBase")}(game||(game={}));var game;!function(t){function e(t){return function(e,o,n){e.__interestMessageList||(e.__interestMessageList={});var i=e.__interestMessageList;i[t]||(i[t]=[]);var r=i[t],a=n.value;-1==r.indexOf(a)&&r.push(a)}}var o=function(t){function e(e){var o=t.call(this,e)||this;o._connect=n.instance,o._sender=i.getInstance(o._connect),o._http=r.instance,o._senderHttp=a.getInstance(o._http);var s=o._http.addEventListener.bind(o._http),c=o._connect.addEventListener.bind(o._connect),u=o.__interestMessageList;for(var p in u){var l=u[p];for(var h in l){var d=l[h];c(p,d,o),s(p,d,o)}}return o}return __extends(e,t),e.prototype.send=function(t){this._connect.send(t)},e}(t.AbstractProxy);t.ProxyBase=o,__reflect(o.prototype,"game.ProxyBase"),t.InterestMessage=e;var n=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new t.ServerConnect)},enumerable:!0,configurable:!0}),e}();__reflect(n.prototype,"ServerConnectInst");var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.getInstance=function(t){return e._instance||(e._instance=new e(t))},e}(t.NetSender);__reflect(i.prototype,"NetSenderInst");var r=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new t.HttpRequest)},enumerable:!0,configurable:!0}),e}();__reflect(r.prototype,"HttpRequestInst");var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.getInstance=function(t){return e._instance||(e._instance=new e(t))},e}(t.HttpSender);__reflect(a.prototype,"HttpSenderInst")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.prototype.update=function(t){var e=this;e.id=t.sRoomID,e.gamerList=[],e.bossID=t.sBossID,e.updateGamerList(t.gamers)},e.prototype.updateGamerList=function(t){for(var e=0;e<t.length;e++){var o=t[e];this.updateOneGamer(o)}},e.prototype.updateOneGamer=function(e){var o=new t.GamerVO;o.update(e),this.gamerList.push(o)},e.prototype.updataRoomID=function(t){this.id=t},e.prototype.updataTimeTick=function(e){this.timeTick=e,t.$facade.dispatch(20)},e.prototype.updataPortPKId=function(t){this.playProtPKId=t},e.prototype.getGamer=function(t){for(var e=0;e<this.gamerList.length;e++)if(this.gamerList[e].sID===t)return this.gamerList[e]},e.prototype.removeGamer=function(t){for(var e=0;e<this.gamerList.length;e++)this.gamerList[e].sID===t&&this.gamerList.remove(this.gamerList[e])},e}();t.RoomVO=e,__reflect(e.prototype,"game.RoomVO")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var t=e.call(this)||this;return o.inputBuffer=new ArrayBuffer(o.maxSendBufferSize),t}return __extends(o,e),o.prototype.sendPostRequest=function(e,o){var n=new egret.HttpRequest;n.responseType=egret.HttpResponseType.TEXT;var i=t.ServerIP.HttpType+t.ServerIP.serverIP+":"+t.ServerIP.port+o;n.open(i,egret.HttpMethod.POST),n.send(e),n.addEventListener(egret.Event.COMPLETE,this.onPostComplete,this),n.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onPostIOError,this),n.addEventListener(egret.ProgressEvent.PROGRESS,this.onPostProgress,this)},o.prototype.onPostComplete=function(e){var o=e.currentTarget,n=JSON.parse(o.response);n.response.nErrorCode==gameMsg.ErrorCode.success?this.dispatch(n.type,!1,n):t.$facade.addModule(t.ModuleID.msg,void 0,t.ErrorCodeText[n.response.nErrorCode])},o.prototype.onPostIOError=function(t){},o.prototype.onPostProgress=function(t){},o.prototype.send=function(t,e){var o=JSON.stringify(t);this.sendPostRequest(o,e)},o.maxSendBufferSize=6144,o}(egret.EventDispatcher);t.HttpRequest=e,__reflect(e.prototype,"game.HttpRequest")}(game||(game={}));var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,void 0]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var game;!function(t){var e;!function(e){function o(t){h.init(t)}function n(t){h.maskVisible=t}function i(){return h.hasMask()}function r(t,e){h.addDialog(t,e)}function a(t){h.setToTop(t)}function s(t){return h.hasDialog(t)}function c(t){h.removeDialog(t)}function u(){h.removeAllDialog()}var p=!1;e.init=o,e.setMaskVisible=n,e.hasMask=i,e.addDialog=r,e.setToTop=a,e.hasDialog=s,e.removeDialog=c,e.removeAllDialog=u;var l=function(){function e(){this._dialogList=[],this._dialogMap={},this._moduleIDMap={}}return Object.defineProperty(e.prototype,"maskVisible",{get:function(){return this._mask.visible},set:function(t){this._mask.visible=t},enumerable:!0,configurable:!0}),e.prototype.init=function(t){this._container=t;var e=this._mask=new eui.Rect;e.percentWidth=100,e.percentHeight=100,e.fillColor=0,e.fillAlpha=.75,e.on(egret.TouchEvent.TOUCH_TAP,this.onMaskTap,this)},e.prototype.onMaskTap=function(e){for(var o=this._dialogList.length-1;o>=0;o--){var n=this._dialogList[o];if(n.modal&&!n.hiding){if(n.tapMaskClose){var i=this._moduleIDMap[n.hashCode];t.$facade.removeModule(i)}break}}},e.prototype.checkMask=function(){var t=this._dialogList,e=this._mask,o=this._container;if(0==t.length)e.removeSelf();else for(var n=t.length-1;n>=0;n--)if(t[n].modal){e.parent?o.setChildIndex(e,o.numChildren-1):o.addChild(e),o.setChildIndex(e,n);break}},e.prototype.hasMask=function(){return!!this._mask.stage},e.prototype.addDialog=function(t,e){return this._dialogMap[t]?void this.setToTop(t):(this._dialogList.push(e),this._dialogMap[t]=e,this._moduleIDMap[e.hashCode]=t,this.checkMask(),void(p&&(e.alpha=0,egret.Tween.get(e).to({alpha:1},200))))},e.prototype.setToTop=function(t){var e=this._dialogMap[t];e&&(this._mask.removeSelf(),this._container.setChildIndex(e,this._container.numChildren-1),this.checkMask())},e.prototype.hasDialog=function(t){return!!this._dialogMap[t]},e.prototype.removeDialog=function(t){var e=this._dialogMap[t];e&&(this._dialogList.remove(e),delete this._dialogMap[t],delete this._moduleIDMap[e.hashCode],p?(e.hiding=!0,egret.Tween.get(e).to({alpha:0},100).call(this.closeDialog,this,[e,t])):this.closeDialog(e,t))},e.prototype.closeDialog=function(t,e){t.hiding=!1,t.removeSelf(),this.checkMask()},e.prototype.removeAllDialog=function(){for(var e in this._moduleIDMap){var o=this._moduleIDMap[e];t.$facade.removeModule(o)}},e}();__reflect(l.prototype,"Impl");var h=new l}(e=t.DialogManager||(t.DialogManager={}))}(game||(game={}));var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,o,n){function i(t){e.call(n,t)}function r(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),o.call(n))}"undefined"!=typeof generateEUI?egret.callLater(function(){e.call(n,generateEUI)},this):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),game.RESP.getResByUrl(t,i,this,RES.ResourceItem.TYPE_TEXT,6))
},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var game;!function(t){var e;!function(e){function o(t){p.init(t)}function n(t){p.maskVisible=t}function i(){return p.moduleID}function r(t,e){p.addFullWindow(t,e)}function a(){return p.hasFullWindow()}function s(){p.removeFullWindow()}function c(){p.closeFullWindow()}e.init=o,e.setMaskVisible=n,e.getNowModuleID=i,e.addFullWindow=r,e.hasFullWindow=a,e.removeFullWindow=s,e.closeFullWindow=c;var u=function(){function e(){}return Object.defineProperty(e.prototype,"maskVisible",{get:function(){return this._mask.visible},set:function(t){this._mask.visible=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"moduleID",{get:function(){return this._moduleID},enumerable:!0,configurable:!0}),e.prototype.init=function(t){this._container=t;var e=this._mask=new eui.Rect;e.percentWidth=100,e.percentHeight=100,e.fillColor=0,e.fillAlpha=0},e.prototype.addFullWindow=function(t,e){this.closeFullWindow(),this._moduleID=t,this._fullWindow=e,this._container.addChildAt(this._mask,0)},e.prototype.hasFullWindow=function(){return!isNaN(this._moduleID)},e.prototype.removeFullWindow=function(){isNaN(this._moduleID)||(this._fullWindow.removeSelf(),this._mask.removeSelf(),this._moduleID=void 0,this._fullWindow=void 0)},e.prototype.closeFullWindow=function(){isNaN(this._moduleID)||t.$facade.removeModule(this._moduleID)},e}();__reflect(u.prototype,"Impl");var p=new u}(e=t.FullWindowManager||(t.FullWindowManager={}))}(game||(game={}));var game;!function(t){function e(t,e){i.init(t,e)}function o(t){return i.getLocalstrageInfo(t)}t.setItem=e,t.getItem=o;var n=function(){function t(){}return t.prototype.getLocalstrageInfo=function(t){return localStorage.getItem(t)},t.prototype.init=function(t,e){localStorage.setItem(t,e)},t}();__reflect(n.prototype,"Ilsm");var i=new n}(game||(game={}));var game;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._scaleValue=1.05,e._useImageSize=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"scaleValue",{get:function(){return this._scaleValue},set:function(t){this._scaleValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useImageSize",{get:function(){return this._useImageSize},set:function(t){this._useImageSize=t},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){if(t.prototype.childrenCreated.call(this),this.numChildren>0){var e=this.getChildAt(0);e instanceof eui.Image&&(this._bg=e)}this._bg&&(this._bg=this.getChildAt(0),this._bg.includeInLayout=!1,this._useImageSize&&(this.updateSize(),this._bg.on(egret.Event.COMPLETE,this.updateSize,this))),this.group&&(this.group.includeInLayout=!1)},e.prototype.updateSize=function(t){this._bg.texture&&(this.width=this._bg.texture.textureWidth,this.height=this._bg.texture.textureHeight)},e.prototype.onTouchBegin=function(e){t.prototype.onTouchBegin.call(this,e),this.$stage.on(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd2,this),this._bg&&(this._bg.scaleX=this._bg.scaleY=this._scaleValue),this.group&&(this.group.scaleX=this.group.scaleY=this._scaleValue)},e.prototype.onTouchCancle=function(e){t.prototype.onTouchCancle.call(this,e),e.$currentTarget.off(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd2,this),this._bg&&(this._bg.scaleX=this._bg.scaleY=1),this.group&&(this.group.scaleX=this.group.scaleY=1)},e.prototype.onStageTouchEnd2=function(t){t.$currentTarget.off(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd2,this),this._bg&&(this._bg.scaleX=this._bg.scaleY=1),this.group&&(this.group.scaleX=this.group.scaleY=1)},e.prototype.updateDisplayList=function(e,o){t.prototype.updateDisplayList.call(this,e,o);var n=this._bg,i=this.group;n&&(n.width=e,n.height=o,n.x=n.anchorOffsetX=e>>1,n.y=n.anchorOffsetY=o>>1),i&&(i.width=e,i.height=o,i.x=i.anchorOffsetX=e>>1,i.y=i.anchorOffsetY=o>>1)},e}(eui.Button);t.ScaleButton=e,__reflect(e.prototype,"game.ScaleButton"),eui.registerProperty(e,"scaleValue","number"),eui.registerProperty(e,"useImageSize","boolean"),window.ScaleButton=e}(game||(game={}));var Facade=game.Facade;!function(){var t;t=Facade.prototype,Object.defineProperties(t,{addModule:{value:function(t,e){for(var o=[],n=2;n<arguments.length;n++)o[n-2]=arguments[n];(i=game.ModuleManager).addModule.apply(i,[t,e].concat(o));var i},enumerable:!1},removeModule:{value:function(t){game.ModuleManager.removeModule(t)},enumerable:!1}})}();var game;!function(t){function e(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return function(o){if(o.__resPolicy=t,e&&e.length>0){var n=o.__releaseResList;n||(o.__releaseResList=n=[]);for(var i=0,r=e;i<r.length;i++){var a=r[i];-1==n.indexOf(a)&&n.push(a)}}}}t.ReleaseRes=e}(game||(game={}));var game;!function(t){var e;!function(e){function o(t){c.init(t)}function n(t,e){c.mapModule(t,e)}function i(t,e){for(var o=[],n=2;n<arguments.length;n++)o[n-2]=arguments[n];c.addModule.apply(c,[t,e].concat(o))}function r(t){return c.hasModule(t)}function a(t){c.removeModule(t)}e.init=o,e.mapModule=n,e.addModule=i,e.hasModule=r,e.removeModule=a;var s=function(){function e(){this._viewClassMap={},this._viewMap={},this._showViewMap={}}return e.prototype.init=function(e){this._container=e,this._viewResMgr=t.$singlon(t.ModuleResMgr)},e.prototype.mapModule=function(t,e){this._viewClassMap[t]=e},e.prototype.addModule=function(e,o){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(this._showViewMap[e]){var r=this._viewMap[e],a=t.$facade.getMediator(r);return o&&o.tabData&&o.tabData.length&&"function"==typeof a.setTabData&&(l=a).setTabData.apply(l,o.tabData),void("function"==typeof a.setModuleData&&(h=a).setModuleData.apply(h,n))}if(!this._viewMap[e]){var s=this._viewClassMap[e];if(!s)throw new Error("没有对应的模块视图类映射！");this._viewMap[e]=this._viewResMgr.getRes(e,s)}var c=this._viewMap[e],u=this.getModuleLayer(c.layer);u.addChild(c);var p=t.$facade.getMediator(c);switch(o&&o.tabData&&o.tabData.length&&"function"==typeof p.setTabData&&(d=p).setTabData.apply(d,o.tabData),"function"==typeof p.setModuleData&&(g=p).setModuleData.apply(g,n),this._showViewMap[e]=!0,c.layer){case 4:t.FullWindowManager.addFullWindow(e,c);break;case 6:t.DialogManager.addDialog(e,c)}o&&!isNaN(o.prevModuleID)?t.PrevModuleLogic.record(e,o):t.PrevModuleLogic.clear(e),t.$facade.dispatch(4,e);var l,h,d,g},e.prototype.getModuleLayer=function(t){switch(t){case 0:return this._container.sceneLayer;case 1:return this._container.weatherLayer;case 2:return this._container.bottomLayer;case 3:return this._container.bottomUILayer;case 4:return this._container.fullWindowLayer;case 5:return this._container.mainUILayer;case 6:return this._container.dialogLayer;case 7:return this._container.popLayer;case 8:return this._container.alertLayer;case 9:return this._container.guideLayer;case 10:return this._container.messageLayer;case 11:return this._container.topLayer}},e.prototype.hasModule=function(t){return!!this._showViewMap[t]},e.prototype.removeModule=function(e){if(this._showViewMap[e]){var o=this._viewMap[e];switch(4!=o.layer&&6!=o.layer&&o.removeSelf(),this._viewResMgr.putRes(e),delete this._showViewMap[e],delete this._viewMap[e],o.layer){case 4:t.FullWindowManager.removeFullWindow();break;case 6:t.DialogManager.removeDialog(e)}t.$facade.dispatch(5,e)}},e}();__reflect(s.prototype,"Impl");var c=new s}(e=t.ModuleManager||(t.ModuleManager={}))}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.record=function(t,e){this._prevMap[t]=e},e.back=function(e){var o=this._prevMap;if(o[e]){var n=o[e];return delete o[e],t.$facade.addModule.apply(t.$facade,[n.prevModuleID,o[n.prevModuleID]].concat(n.prevModuleData)),!0}return!1},e.clear=function(t){delete this._prevMap[t]},e._prevMap={},e}();t.PrevModuleLogic=e,__reflect(e.prototype,"game.PrevModuleLogic")}(game||(game={}));var game;!function(t){var e;!function(e){function o(t){a.init(t)}function n(t){a.show(t)}function i(t,e){a.ExcuteMsg(t,e)}e.init=o,e.show=n,e.ExcuteMsg=i;var r=function(){function e(){this._noticeList=[]}return e.prototype.init=function(t){this._container=t},e.prototype.show=function(e){if(this._running)this._noticeList.push(e);else{if(this._running=!0,!this._view){var o=this._view=t.recyclable(t.NoticeView);this._container.addChild(o)}this._view.init(e)}},e.prototype.ExcuteMsg=function(e,o){var n=this,i=o.txt_notice;o.bg_notice.visible=!0;var r=o.sc_marqueen.width+i.width+110;o._duration=7*r,i.x=o.sc_marqueen.x+o.sc_marqueen.width,egret.Tween.get(i).to({x:i.x-r},o._duration).wait(1e3).call(function(){if(i.x+=r,n._running=!1,i.textFlow=t.$parseHtml(""),n._noticeList.length>0){var e=n._noticeList.shift();n.show(e)}else egret.Tween.removeTweens(i),n.closeNotice(o)},o)},e.prototype.closeNotice=function(t){this._running=!1,this._view=void 0,t.removeSelf(),t.onRecycle(),t.recycle()},e}();__reflect(r.prototype,"Impl");var a=new r}(e=t.Notice||(t.Notice={}))}(game||(game={}));var game;!function(t){var e=function(e){function o(){var t=e.call(this)||this;return t.horizontalCenter=0,t.top=230,t}return __extends(o,e),o.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.bg_notice.visible=!1},o.prototype.init=function(t){this._notice=t,this.invalidateProperties()},o.prototype.commitProperties=function(){e.prototype.commitProperties.call(this),this.txt_notice.textFlow=t.$parseHtml(this._notice),t.Notice.ExcuteMsg(this._notice,this)},o.prototype.dispose=function(){this._notice=void 0,this.bg_notice.visible=!1},o.prototype.onRecycle=function(){this.dispose()},o}(eui.Component);t.NoticeView=e,__reflect(e.prototype,"game.NoticeView",["game.ICacheable","game.IDispose"])}(game||(game={}));var game;!function(t){var e=function(){function e(){}return Object.defineProperty(e,"orientation",{get:function(){return this._orientation},set:function(e){this._orientation!=e&&(e==egret.OrientationMode.PORTRAIT||e==egret.OrientationMode.LANDSCAPE||e==egret.OrientationMode.LANDSCAPE_FLIPPED)&&(this._orientation=e,t.$stage.orientation=this._orientation,this._orientation==egret.OrientationMode.PORTRAIT?t.$stage.setContentSize(this._designWidth,this._designHeight):t.$stage.setContentSize(this._designHeight,this._designWidth),t.$facade.dispatch(1))},enumerable:!0,configurable:!0}),e._orientation=egret.OrientationMode.PORTRAIT,e._designWidth=640,e._designHeight=1136,e}();t.OrientationManager=e,__reflect(e.prototype,"game.OrientationManager")}(game||(game={}));var game;!function(t){var e=function(t){function e(e){void 0===e&&(e="");var o=t.call(this)||this;return o.Type=e,o.init(),o}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){},e.prototype.init=function(){this.currentState=this.Type},e}(eui.ItemRenderer);t.Square=e,__reflect(e.prototype,"game.Square")}(game||(game={}));var game;!function(t){var e=function(){function e(){this._animationTime=0,this._moduleTime=0,this._dragonBonesTime=0,this._particleTime=0,this._animationResMgr=t.$singlon(t.AnimationResMgr),this._moduleResMgr=t.$singlon(t.ModuleResMgr),this._dragonBonesResMgr=t.$singlon(t.DragonBonesResMgr),this._particleResMgr=t.$singlon(t.ParticleResMgr),t.$clock.commonClock.addClockClient(this)}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e)},enumerable:!0,configurable:!0}),e.prototype.update=function(e){var o=t.GameTime.timer;this._animationTime+=e,this._animationTime>=this._animationResMgr.checkTime&&(this._animationTime=0,this._animationResMgr.clearRes(o)),this._moduleTime+=e,this._moduleTime>=this._moduleResMgr.checkTime&&(this._moduleTime=0,this._moduleResMgr.clearRes(o)),this._dragonBonesTime+=e,this._dragonBonesTime>=this._dragonBonesResMgr.checkTime&&(this._dragonBonesTime=0,this._dragonBonesResMgr.clearRes(o)),this._particleTime+=e,this._particleTime>=this._particleResMgr.checkTime&&(this._particleTime=0,this._particleResMgr.clearRes(o))},e}();t.ResourceManager=e,__reflect(e.prototype,"game.ResourceManager",["game.IClockClient"])}(game||(game={}));var game;!function(t){var e=function(e){function o(){var o=null!==e&&e.apply(this,arguments)||this;return o._status=0,o._usingCount=0,o._data=new t.AnimationData,o}return __extends(o,e),Object.defineProperty(o.prototype,"url",{get:function(){return this._jsonUrl},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"usingCount",{get:function(){return this._usingCount},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"lastUseTime",{get:function(){return this._lastUseTime},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"liveTime",{get:function(){return this._liveTime},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),o.prototype.init=function(e,o){this._inConfig=RES.hasRes(e+"_json"),this._inConfig?(this._jsonUrl=e+"_json",this._pngUrl=e+"_png"):(this._jsonUrl=t.RESVersion.getRealUrl(e+".json"),this._pngUrl=t.RESVersion.getRealUrl(e+".png")),this._liveTime=o},o.prototype.addUsing=function(){++this._usingCount},o.prototype.subtractUsing=function(){--this._usingCount,this._usingCount<=0&&(this._lastUseTime=t.GameTime.timer)},o.prototype.load=function(){1!=this._status&&(0==this._status||3==this._status)&&(this._status=1,this._inConfig?t.RESP.getResAsync(this._jsonUrl,this.onJsonLoaded,this,5):t.RESP.getResByUrl(this._jsonUrl,this.onJsonLoaded,this,RES.ResourceItem.TYPE_JSON,5))},o.prototype.onJsonLoaded=function(e,o){return e?(this._data.data=e,void(this._inConfig?t.RESP.getResAsync(this._pngUrl,this.onImageLoaded,this,5):t.RESP.getResByUrl(this._pngUrl,this.onImageLoaded,this,RES.ResourceItem.TYPE_IMAGE,5))):void console.error('"'+o+'"加载失败！')},o.prototype.onImageLoaded=function(t,e){return t?(this._status=2,this._data.texture=t,this._data.parse(),void this.dispatch(egret.Event.COMPLETE)):void console.error('"'+e+'"加载失败！')},o.prototype.destroy=function(){return 2==this._status?(this._status=3,this._data.clear(),RES.destroyRes(this._jsonUrl),RES.destroyRes(this._pngUrl),!0):!1},o.prototype.dispose=function(){this._usingCount=0,this._status=0,this._inConfig=void 0,this._jsonUrl=void 0,this._pngUrl=void 0,this._data.clear()},o.prototype.onRecycle=function(){this.dispose()},o=__decorate([t.DeployPool(500)],o)}(egret.EventDispatcher);t.AnimationRes=e,__reflect(e.prototype,"game.AnimationRes",["game.IRes","game.IDestroy","game.IDispose","game.ICacheable"])}(game||(game={}));var game;!function(t){var e=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t._defaultLiveTime=1e4,t}return __extends(o,e),o.prototype.getRes=function(e,o){if(isNaN(o)&&(o=this._defaultLiveTime),!this._resMap[e]){var n=t.recyclable(t.AnimationRes);n.init(e,o),this._resMap[e]=n}return this._resMap[e]},o}(t.ResMgrBase);t.AnimationResMgr=e,__reflect(e.prototype,"game.AnimationResMgr")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var t=e.call(this)||this;return t._status=0,t._usingCount=0,t._hasBonesData=!1,t._armatureList=[],t}return __extends(o,e),Object.defineProperty(o.prototype,"url",{get:function(){return this._dataUrl},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"usingCount",{get:function(){return this._usingCount},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"lastUseTime",{get:function(){return this._lastUseTime},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"liveTime",{get:function(){return this._liveTime},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),o.prototype.init=function(e,o){this._inConfig=RES.hasRes(e+"_ske_dbbin"),this._inConfig?(this._dataUrl=e+"_ske_dbbin",this._texDataUrl=e+"_tex_json",this._texPngUrl=e+"_tex_png"):(this._dataUrl=t.RESVersion.getRealUrl(e+"_ske.dbbin"),this._texDataUrl=t.RESVersion.getRealUrl(e+"_tex.json"),this._texPngUrl=t.RESVersion.getRealUrl(e+"_tex.png")),this._liveTime=o},o.prototype.addUsing=function(){++this._usingCount},o.prototype.subtractUsing=function(){--this._usingCount,this._usingCount<=0&&(this._lastUseTime=t.GameTime.timer)},o.prototype.load=function(){1!=this._status&&(0==this._status||3==this._status)&&(this._status=1,this._hasBonesData?this.loadTexture():this.loadData())},o.prototype.loadData=function(){this._inConfig?t.RESP.getResAsync(this._dataUrl,this.onDataLoaded,this,6):t.RESP.getResByUrl(this._dataUrl,this.onDataLoaded,this,RES.ResourceItem.TYPE_JSON,6)},o.prototype.onDataLoaded=function(t,e){return t?(this._hasBonesData=!0,this._data=new dragonBones.EgretFactory,this._data.parseDragonBonesData(t),void this.loadTexture()):void console.error('"'+e+'"加载失败！')},o.prototype.loadTexture=function(){return __awaiter(this,void 0,void 0,function(){var e,o;return __generator(this,function(n){switch(n.label){case 0:return this._inConfig?[4,t.RESP.getResAsyncAsync(this._texDataUrl,6)]:[3,3];case 1:return e=n.sent(),[4,t.RESP.getResAsyncAsync(this._texPngUrl,6)];case 2:return o=n.sent(),[3,6];case 3:return[4,t.RESP.getResByUrlAsync(this._texDataUrl,RES.ResourceItem.TYPE_JSON,6)];case 4:return e=n.sent(),[4,t.RESP.getResByUrlAsync(this._texPngUrl,RES.ResourceItem.TYPE_IMAGE,6)];case 5:o=n.sent(),n.label=6;case 6:return this._status=2,this._atlasName=this._data.parseTextureAtlasData(e,o).name,this.dispatch(egret.Event.COMPLETE),[2]}})})},o.prototype.takeArmatureDisplay=function(t){if(2==this._status){var e=this._data.buildArmatureDisplay(t);return this._armatureList.push(e),e}},o.prototype.disposeArmatureDisplay=function(t){this._armatureList.remove(t),t.removeSelf(),t.dispose()},o.prototype.destroy=function(){if(2==this._status){this._status=3;for(var t=0,e=this._armatureList;t<e.length;t++){var o=e[t];o.removeSelf(),o.dispose()}return this._armatureList.length=0,this._data.removeTextureAtlasData(this._atlasName,!0),RES.destroyRes(this._texDataUrl),RES.destroyRes(this._texPngUrl),this._hasBonesData=!1,this._data=void 0,this._atlasName=void 0,this.dispatch(egret.Event.REMOVED),!0}return!1},o}(egret.EventDispatcher);t.DragonBonesRes=e,__reflect(e.prototype,"game.DragonBonesRes",["game.IRes","game.IDestroy"])}(game||(game={}));var game;!function(t){var e=function(){function e(){this._checkTime=1e4,this._defaultLiveTime=1e4,this._resMap={}}return Object.defineProperty(e.prototype,"checkTime",{get:function(){return this._checkTime},set:function(t){this._checkTime=t},enumerable:!0,configurable:!0}),e.prototype.getRes=function(e,o){isNaN(o)&&(o=this._defaultLiveTime);var n;return this._resMap[e]?n=this._resMap[e]:(n=new t.DragonBonesRes,this._resMap[e]=n),n.init(e,o),this._resMap[e]},e.prototype.clearRes=function(t){for(var e in this._resMap){var o=this._resMap[e];2==o.status&&o.usingCount<=0&&o.lastUseTime+o.liveTime<=t&&o.destroy()}},e.prototype.forceClear=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(t&&0!=t.length){if(1==t.length)return this.destroyRes(t[0]);for(var o=[],n=0,i=t;n<i.length;n++){var r=i[n];o.push(this.destroyRes(r))}return o}},e.prototype.destroyRes=function(t){var e=this._resMap[t];if(!e||2!=e.status||e.usingCount>0)return!1;var o=e.destroy();return o},e}();t.DragonBonesResMgr=e,__reflect(e.prototype,"game.DragonBonesResMgr")}(game||(game={}));var game;!function(t){var e=function(){function e(){this._using=!1}return Object.defineProperty(e.prototype,"moduleID",{get:function(){return this._moduleID},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"using",{get:function(){return this._using},set:function(t){this._using=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastUseTime",{get:function(){return this._lastUseTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"liveTime",{get:function(){return this._liveTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"view",{get:function(){return this._view},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resNames",{get:function(){return this._resNames},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resPolicy",{get:function(){return this._resPolicy},enumerable:!0,configurable:!0}),e.prototype.init=function(t,e,o){this._moduleID=t,this._view=new e;var n=this._view.constructor.__releaseResList;n&&n.length>0&&(this._resNames=n.concat()),this._resPolicy=this._view.constructor.__resPolicy||0,1==this._resPolicy&&(this._liveTime=o)},e.prototype.recordLastUseTime=function(){this._lastUseTime=t.GameTime.timer},e.prototype.dispose=function(){0!=this._resPolicy&&(this._view=void 0)},e.prototype.destroy=function(){if(0!=this._resPolicy){if(this._resNames)for(var t=0;t<this._resNames.length;t++)RES.destroyRes(this._resNames[t])&&(this._resNames.splice(t,1),--t);return!this._resNames||0==this._resNames.length}},e}();t.ModuleRes=e,__reflect(e.prototype,"game.ModuleRes")}(game||(game={}));var game;!function(t){var e=function(){function e(){this._checkTime=1e4,this._smartLiveTime=6e4,this._resMap={}}return Object.defineProperty(e.prototype,"checkTime",{get:function(){return this._checkTime},set:function(t){this._checkTime=t},enumerable:!0,configurable:!0}),e.prototype.getRes=function(e,o){if(this._resMap[e]){var n=this._resMap[e];if(0==n.resPolicy||1==n.resPolicy&&n.view)return n.using=!0,n.view}var i=new t.ModuleRes;return i.using=!0,i.init(e,o,this._smartLiveTime),this._resMap[e]=i,i.view},e.prototype.putRes=function(t){if(this._resMap[t]){var e=this._resMap[t];e.using=!1,1==e.resPolicy?e.recordLastUseTime():2==e.resPolicy&&(e.dispose(),e.destroy()&&delete this._resMap[t])}},e.prototype.clearRes=function(t){for(var e in this._resMap){var o=this._resMap[e];if(!o.using&&0!=o.resPolicy){if(1==o.resPolicy){if(!(o.lastUseTime+o.liveTime<=t))continue;o.dispose()}o.destroy()&&delete this._resMap[o.moduleID]}}},e}();t.ModuleResMgr=e,__reflect(e.prototype,"game.ModuleResMgr")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t._status=0,t._usingCount=0,t}return __extends(o,e),Object.defineProperty(o.prototype,"url",{get:function(){return this._jsonUrl},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"usingCount",{get:function(){return this._usingCount},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"lastUseTime",{get:function(){return this._lastUseTime},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"liveTime",{get:function(){return this._liveTime},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"data",{get:function(){var t=new egret.MovieClipDataFactory(this._jsonData,this._imageData);return new egret.MovieClip(t.generateMovieClipData(this._url))},enumerable:!0,configurable:!0}),o.prototype.init=function(e,o){this._inConfig=RES.hasRes(e+"_json"),this._url=e,this._inConfig?(this._jsonUrl=e+"_json",this._pngUrl=e+"_png"):(this._jsonUrl=t.RESVersion.getRealUrl(e+".json"),this._pngUrl=t.RESVersion.getRealUrl(e+".png")),this._liveTime=o},o.prototype.addUsing=function(){++this._usingCount},o.prototype.subtractUsing=function(){--this._usingCount,this._usingCount<=0&&(this._lastUseTime=t.GameTime.timer)},o.prototype.load=function(){1!=this._status&&(0==this._status||3==this._status)&&(this._status=1,this.loadData())},o.prototype.loadData=function(){return __awaiter(this,void 0,void 0,function(){var e,o;return __generator(this,function(n){switch(n.label){case 0:return this._inConfig?[4,t.RESP.getResAsyncAsync(this._jsonUrl,2)]:[3,3];case 1:return e=n.sent(),[4,t.RESP.getResAsyncAsync(this._pngUrl,2)];case 2:return o=n.sent(),[3,6];case 3:return[4,t.RESP.getResByUrlAsync(this._jsonUrl,RES.ResourceItem.TYPE_JSON,2)];case 4:return e=n.sent(),[4,t.RESP.getResByUrlAsync(this._pngUrl,RES.ResourceItem.TYPE_IMAGE,2)];case 5:o=n.sent(),n.label=6;case 6:return this._status=2,this._jsonData=e,this._imageData=o,this.dispatch(egret.Event.COMPLETE),[2]}})})},o.prototype.destroy=function(){return 2==this._status?(this._status=3,this._jsonData=void 0,this._imageData=void 0,RES.destroyRes(this._jsonUrl),RES.destroyRes(this._pngUrl),this.dispatch(egret.Event.REMOVED),!0):!1},o.prototype.dispose=function(){this._usingCount=0,this._status=0,this._inConfig=void 0,this._jsonUrl=void 0,this._pngUrl=void 0,this._jsonData=void 0,this._imageData=void 0},o.prototype.onRecycle=function(){this.dispose()},o}(egret.EventDispatcher);t.MovieRes=e,__reflect(e.prototype,"game.MovieRes",["game.IRes","game.IDestroy"])}(game||(game={}));var game;!function(t){var e=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t._defaultLiveTime=1e4,t}return __extends(o,e),o.prototype.getRes=function(e,o){if(isNaN(o)&&(o=this._defaultLiveTime),!this._resMap[e]){var n=t.recyclable(t.MovieRes);n.init(e,o),this._resMap[e]=n}return this._resMap[e]},o}(t.ResMgrBase);t.MovieResMgr=e,__reflect(e.prototype,"game.MovieResMgr")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t._status=0,t._usingCount=0,t}return __extends(o,e),Object.defineProperty(o.prototype,"url",{get:function(){return this._jsonUrl},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"usingCount",{get:function(){return this._usingCount},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"lastUseTime",{get:function(){return this._lastUseTime},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"liveTime",{get:function(){return this._liveTime},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"data",{get:function(){return new particle.GravityParticleSystem(this._imageData,this._jsonData)},enumerable:!0,configurable:!0}),o.prototype.init=function(e,o){this._inConfig=RES.hasRes(e+"_json"),this._inConfig?(this._jsonUrl=e+"_json",this._pngUrl=e+"_png"):(this._jsonUrl=t.RESVersion.getRealUrl(e+".json"),this._pngUrl=t.RESVersion.getRealUrl(e+".png")),this._liveTime=o},o.prototype.addUsing=function(){++this._usingCount},o.prototype.subtractUsing=function(){--this._usingCount,this._usingCount<=0&&(this._lastUseTime=t.GameTime.timer)},o.prototype.load=function(){1!=this._status&&(0==this._status||3==this._status)&&(this._status=1,this.loadData())},o.prototype.loadData=function(){return __awaiter(this,void 0,void 0,function(){var e,o;return __generator(this,function(n){switch(n.label){case 0:return this._inConfig?[4,t.RESP.getResAsyncAsync(this._jsonUrl,2)]:[3,3];case 1:return e=n.sent(),[4,t.RESP.getResAsyncAsync(this._pngUrl,2)];case 2:return o=n.sent(),[3,6];case 3:return[4,t.RESP.getResByUrlAsync(this._jsonUrl,RES.ResourceItem.TYPE_JSON,2)];case 4:return e=n.sent(),[4,t.RESP.getResByUrlAsync(this._pngUrl,RES.ResourceItem.TYPE_IMAGE,2)];case 5:o=n.sent(),n.label=6;case 6:return this._status=2,this._jsonData=e,this._imageData=o,this.dispatch(egret.Event.COMPLETE),[2]}})})},o.prototype.destroy=function(){return 2==this._status?(this._status=3,this._jsonData=void 0,this._imageData=void 0,RES.destroyRes(this._jsonUrl),RES.destroyRes(this._pngUrl),this.dispatch(egret.Event.REMOVED),!0):!1},o.prototype.dispose=function(){this._usingCount=0,this._status=0,this._inConfig=void 0,this._jsonUrl=void 0,this._pngUrl=void 0,this._jsonData=void 0,this._imageData=void 0},o.prototype.onRecycle=function(){this.dispose()},o}(egret.EventDispatcher);t.ParticleRes=e,__reflect(e.prototype,"game.ParticleRes",["game.IRes","game.IDestroy"])}(game||(game={}));var game;!function(t){var e=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t._defaultLiveTime=1e4,t}return __extends(o,e),o.prototype.getRes=function(e,o){if(isNaN(o)&&(o=this._defaultLiveTime),!this._resMap[e]){var n=t.recyclable(t.ParticleRes);n.init(e,o),this._resMap[e]=n}return this._resMap[e]},o}(t.ResMgrBase);t.ParticleResMgr=e,__reflect(e.prototype,"game.ParticleResMgr")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new t.SoundManager,this._instance.InitSoundManager()),this._instance},e.prototype.InitSoundManager=function(){this.mBGAudio=new egret.Sound,this.mBGAudio.load(e.mBGAudioUrl),this.mPKAudio=new egret.Sound,this.mPKAudio.load(e.mPKAudioUrl),"iOS"==egret.Capabilities.os?this.mBGAudio.on(egret.Event.COMPLETE,this.PlayMusicIOS,this):this.mBGAudio.on(egret.Event.COMPLETE,this.playBgMusic,this)},e.prototype.playPKMusic=function(){this.mPKAudio&&this.isMusic&&(this.mSoundChanne2=this.mPKAudio.play(0,0))},e.prototype.stopPKMusic=function(){this.mSoundChanne2&&(this.mSoundChanne2.stop(),this.mSoundChanne2=null)},e.prototype.playBgMusic=function(){this.mBGAudio&&this.isMusic&&(this.mSoundChannel=this.mBGAudio.play(0,0))},e.prototype.stopBgMusic=function(){this.mSoundChannel&&(this.mSoundChannel.stop(),this.mSoundChannel=null)},e.prototype.PlayMusicIOS=function(t){var e=this;window.addEventListener("touchstart",function(){e.playBgMusic(),e.playPKMusic()})},e.prototype.PlaySound=function(t){if(this.isEffect){var e=new egret.Sound;e.load(t),e.on(egret.Event.COMPLETE,function(){e.play(0,1)},this)}},Object.defineProperty(e.prototype,"isMusic",{get:function(){var t=egret.localStorage.getItem("isMusic");return""==t||null==t?!0:"1"==t},set:function(t){t?(egret.localStorage.setItem("isMusic","1"),this.playBgMusic()):(egret.localStorage.setItem("isMusic","0"),this.stopBgMusic())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEffect",{get:function(){var t=egret.localStorage.getItem("isSound");return null==t||""==t?!0:"1"==t},set:function(t){t?egret.localStorage.setItem("isSound","1"):egret.localStorage.setItem("isSound","0")},enumerable:!0,configurable:!0}),e.mBGAudioUrl="resource/sound/bg_music_test.mp3",e.mClickAudioUrl="resource/sound/click_test.mp3",e.mDropAudioUrl="resource/sound/block_drop.mp3",e.mWinAudioUrl="resource/sound/win.mp3",e.mPKAudioUrl="resource/sound/pk_music_50s.mp3",e.mClockAudioUrl="resource/sound/clock1.mp3",e.mShorterAudioUrl="resource/sound/shorter_time.mp3",e.mLongerAudioUrl="resource/sound/longer_time.mp3",e.mBlastingAudioUrl="resource/sound/shorter_time.mp3",e.mSmogAudioUrl="resource/sound/longer_time.mp3",e}();t.SoundManager=e,__reflect(e.prototype,"game.SoundManager")}(game||(game={}));var game;!function(t){var e=function(){function e(){this._commandMap={}}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e)},enumerable:!0,configurable:!0}),e.prototype.registerCommand=function(t,e){var o=String(t);if(o&&e){this.hasCommand(o)||(this._commandMap[o]=[]);var n=this._commandMap[o];-1==n.indexOf(e)&&n.push(e)}},e.prototype.hasCommand=function(t){return this._commandMap.hasOwnProperty(String(t))},e.prototype.removeCommand=function(t){var e=String(t);e&&this.hasCommand(e)&&delete this._commandMap[e]},e.prototype.executeCommand=function(e){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];var i=String(e);if(this.hasCommand(i)){var r=this._commandMap[i];for(var a in r){var s=r[a];if(s.prototype.constructor.__cacheCommand){var c=t.recyclable(s);c.execute.apply(c,[e].concat(o)),c.recycle()}else{var c=new s;c.execute.apply(c,[e].concat(o))}}}},e}();t.Controller=e,__reflect(e.prototype,"game.Controller")}(game||(game={}));var game;!function(t){var e=function(){function t(){this._GamerInfoMap={0:{sID:"1",sHeadImg:"1",sNick:"一壶酒化流年",nRankLevel:1},1:{sID:"2",sHeadImg:"1",sNick:"简单粗暴我就是王道",nRankLevel:1},2:{sID:"3",sHeadImg:"1",sNick:"江山与你",nRankLevel:1},3:{sID:"4",sHeadImg:"1",sNick:"丑的惊动了上帝",nRankLevel:1},4:{sID:"5",sHeadImg:"1",sNick:"何弃疗",nRankLevel:1},5:{sID:"5",sHeadImg:"1",sNick:"き冷月葬花あ",nRankLevel:1},6:{sID:"6",sHeadImg:"1",sNick:"烟笼彼海至予雨巷",nRankLevel:1},7:{sID:"7",sHeadImg:"1",sNick:"画扇悲风殇月夜",nRankLevel:1},8:{sID:"8",sHeadImg:"1",sNick:"遍地·梧桐花",nRankLevel:1},9:{sID:"9",sHeadImg:"1",sNick:"躲目",nRankLevel:1},10:{sID:"1",sHeadImg:"2",sNick:"青衣沽酒醉风尘",nRankLevel:1},11:{sID:"2",sHeadImg:"2",sNick:"白日依山尽",nRankLevel:1},12:{sID:"3",sHeadImg:"2",sNick:"笑忘身是客",nRankLevel:1},13:{sID:"4",sHeadImg:"2",sNick:"平生相见即眉开",nRankLevel:1},14:{sID:"5",sHeadImg:"2",sNick:"恬淡成诗",nRankLevel:1},15:{sID:"6",sHeadImg:"2",sNick:"青山独归远",nRankLevel:1},16:{sID:"7",sHeadImg:"2",sNick:"来往不逢人",nRankLevel:1},17:{sID:"8",sHeadImg:"2",sNick:"风劲角弓鸣",nRankLevel:1},18:{sID:"9",sHeadImg:"2",sNick:"我亦好歌亦好酒",nRankLevel:1},19:{sID:"11",sHeadImg:"1",sNick:"落日桥头细感风",nRankLevel:1},20:{sID:"12",sHeadImg:"1",sNick:"稳握江山权",nRankLevel:1},21:{sID:"13",sHeadImg:"1",sNick:"提笔废江山",nRankLevel:1},22:{sID:"14",sHeadImg:"1",sNick:"挥剑战天地",nRankLevel:1},23:{sID:"15",sHeadImg:"1",sNick:"王位之上",nRankLevel:1},24:{sID:"16",sHeadImg:"1",sNick:"王与冠",nRankLevel:1},25:{sID:"17",sHeadImg:"1",sNick:"弑神自封",nRankLevel:1},26:{sID:"18",sHeadImg:"1",sNick:"本宫不死丶你终究是妃",nRankLevel:1},27:{sID:"19",sHeadImg:"1",sNick:"理想三旬",nRankLevel:1},28:{sID:"11",sHeadImg:"2",sNick:"笑望人非",nRankLevel:1},29:{sID:"12",sHeadImg:"2",sNick:"半步沧桑",nRankLevel:1},30:{sID:"13",sHeadImg:"2",sNick:"再见ろ、天真",nRankLevel:1},31:{sID:"14",sHeadImg:"2",sNick:"欲握玫瑰必承其痛",nRankLevel:1},32:{sID:"15",sHeadImg:"2",sNick:"深知你是梦遥不可及",nRankLevel:1},33:{sID:"16",sHeadImg:"2",sNick:"靠天靠地不如靠自己",nRankLevel:1},34:{sID:"17",sHeadImg:"2",sNick:"中国移不动€",nRankLevel:1},35:{sID:"18",sHeadImg:"2",sNick:"蓉嬷嬷当年一枝花",nRankLevel:1},36:{sID:"19",sHeadImg:"2",sNick:"一身懵逼正气",nRankLevel:1},37:{sID:"20",sHeadImg:"1",sNick:"夏至春掩",nRankLevel:1},38:{sID:"21",sHeadImg:"1",sNick:"白衣未央",nRankLevel:1},39:{sID:"22",sHeadImg:"1",sNick:"蓝色树叶熊",nRankLevel:1},40:{sID:"23",sHeadImg:"1",sNick:"我一路向北、无怨无悔",nRankLevel:1},41:{sID:"24",sHeadImg:"1",sNick:"含笑半步颠",nRankLevel:1},42:{sID:"20",sHeadImg:"2",sNick:"少年ㄨ痴狂梦",nRankLevel:1},43:{sID:"21",sHeadImg:"2",sNick:"简单的等待",nRankLevel:1},44:{sID:"22",sHeadImg:"2",sNick:"君踏桃花归",nRankLevel:1},45:{sID:"23",sHeadImg:"2",sNick:"白衣卿相",nRankLevel:1},46:{sID:"24",sHeadImg:"2",sNick:"红衣枯骨女",nRankLevel:1},47:{sID:"25",sHeadImg:"2",sNick:"孑然一身。",nRankLevel:1}}
}return t.prototype.getGamerInfo=function(){var t=this.RandomNumBoth(0,47);return this._GamerInfoMap[t]},t.prototype.RandomNumBoth=function(t,e){var o=e-t,n=Math.random(),i=t+Math.round(n*o);return i},t}();t.GamerInfoCFG=e,__reflect(e.prototype,"game.GamerInfoCFG")}(game||(game={}));var game;!function(t){var e=function(){function t(){var t=this._goodList=[{id:0,desc:"加时卡",type:0,gold:500,money:0,rmb:0,extra:5},{id:1,desc:"减时卡",type:0,gold:0,money:2,rmb:0,extra:-5}];this._goodMap={};for(var e=0,o=t;e<o.length;e++){var n=o[e];this._goodMap[n.id]=n}}return t.prototype.getGoodCFG=function(t){return this._goodMap[t]},t.prototype.getGoodList=function(){return this._goodList},t}();t.GoodsCFG=e,__reflect(e.prototype,"game.GoodsCFG")}(game||(game={}));var game;!function(t){var e=function(){function t(){this._MealMap={0:{toolId:0,num:5,gold:2500,money:0,rmb:0},1:{toolId:0,num:10,gold:5e3,money:0,rmb:0},2:{toolId:0,num:20,gold:1e4,money:0,rmb:0},3:{toolId:1,num:5,gold:0,money:10,rmb:0},4:{toolId:1,num:10,gold:0,money:20,rmb:0}},this._DiamondMap={0:{num:5,rmb:1},1:{num:10,rmb:2},2:{num:50,rmb:5},3:{num:100,rmb:8}}}return t.prototype.getSetMealCFG=function(t){return this._MealMap[t]},t.prototype.getAllSetMealCFG=function(){return this._MealMap},t.prototype.getSetMealLength=function(){return 5},t.prototype.getDiamondCFG=function(t){return this._DiamondMap[t]},t.prototype.getAllDiamondCFG=function(){return this._DiamondMap},t.prototype.getDiamondLength=function(){return 4},t}();t.SetMealCFG=e,__reflect(e.prototype,"game.SetMealCFG")}(game||(game={}));var game;!function(t){var e;!function(t){t[t.test=0]="test",t[t.scene=1]="scene",t[t.main=2]="main",t[t.menu=3]="menu",t[t.port=4]="port",t[t.rank=5]="rank",t[t.win=6]="win",t[t.humor=7]="humor",t[t.ad=8]="ad",t[t.room=9]="room",t[t.pkmain=10]="pkmain",t[t.pkwin=11]="pkwin",t[t.pklose=12]="pklose",t[t.shop=13]="shop",t[t.login=14]="login",t[t.tool=15]="tool",t[t.msg=16]="msg"}(e=t.ModuleID||(t.ModuleID={}))}(game||(game={}));var game;!function(t){var e=function(){function e(){this._callbackMap={}}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e)},enumerable:!0,configurable:!0}),e.prototype.addListener=function(e,n,i){var r=String(e);this._callbackMap.hasOwnProperty(r)||(this._callbackMap[r]=[]);for(var a=this._callbackMap[r],s=0,c=a.length;c>s;s++){var u=a[s];if(u&&u.callback==n&&u.thisObj==i)return}var p=t.recyclable(o);p.callback=n,p.thisObj=i,a[a.length]=p},e.prototype.removeListener=function(t,e,o){var n=String(t);if(this._callbackMap.hasOwnProperty(n))for(var i=this._callbackMap[n],r=0,a=i.length;a>r;r++){var s=i[r];if(s&&s.callback==e&&s.thisObj==o){s.recycle(),i[r]=void 0;break}}},e.prototype.dispatch=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];var n=String(t);if(this._callbackMap.hasOwnProperty(n)){var i=this._callbackMap[n],r=i.length;if(0==r)return;for(var a=0,s=0;r>s;s++){var c=i[s];c&&(a!=s&&(i[a]=c,i[s]=void 0),c.callback.apply(c.thisObj,[n].concat(e)),a++)}if(a!=s){for(r=i.length;r>s;)i[a++]=i[s++];i.length=a}}},e}();t.Provider=e,__reflect(e.prototype,"game.Provider");var o=function(){function t(){}return t.prototype.onRecycle=function(){this.callback=void 0,this.thisObj=void 0},t}();__reflect(o.prototype,"CallbackInfo",["game.ICacheable"])}(game||(game={}));var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,o){function n(n){e.call(o,n,t)}if(RES.hasRes(t)){var i=game.RESP.getRes(t);i?n(i):game.RESP.getResAsync(t,n,this,6)}else game.RESP.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE,6)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var game;!function(t){var e=function(){function t(){this._proxyMap={}}return Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t)},enumerable:!0,configurable:!0}),t.prototype.registerProxy=function(t){var e=String(t.name);if(this.hasProxy(e))throw new Error("需要注册的代理名称已经存在！");this._proxyMap[e]=t,t.onRegister()},t.prototype.hasProxy=function(t){return this._proxyMap.hasOwnProperty(String(t))},t.prototype.getProxy=function(t){return this._proxyMap[String(t)]},t.prototype.removeProxy=function(t){var e=String(t),o=this.getProxy(e);return o&&(o.onRemove(),delete this._proxyMap[e]),o},t}();t.ModelManager=e,__reflect(e.prototype,"game.ModelManager")}(game||(game={}));var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e.addEventListener(egret.Event.ADDED_TO_STAGE,e.createView,e),e}return __extends(e,t),e.prototype.createView=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return this.width=640,this.height=1136,this.Bg=new egret.Bitmap,this.Bg.texture=RES.getRes("load_gif"),this.Bg.width=this.width,this.Bg.height=this.height,this.addChild(this.Bg),this.textField=new egret.TextField,this.addChild(this.textField),this.textField.width=480,this.textField.height=20,this.textField.y=this.height/2-this.textField.height/2,this.textField.size=14,this.textField.textAlign="center",[2]})})},e.prototype.onProgress=function(t,e){this.textField&&(this.textField.text="Loading..."+t+"/"+e)},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var game;!function(t){var e=function(){function e(){this._classMap={},this._viewMap=new t.Dictionary}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contextView",{get:function(){return this._contextView},set:function(t){this._contextView!=t&&(this._contextView&&this.removeListeners(),this._contextView=t,this._contextView&&this.addListeners())},enumerable:!0,configurable:!0}),e.prototype.addListeners=function(){this._contextView.on(egret.Event.ADDED,this.onViewAdded,this,!0)},e.prototype.removeListeners=function(){this._contextView.off(egret.Event.ADDED,this.onViewAdded,this,!0)},e.prototype.onViewAdded=function(t){var e=t.target;this.addView(e)},e.prototype.addView=function(t){var e=egret.getQualifiedClassName(t);this._classMap.hasOwnProperty(e)&&this.createMediator(t)},e.prototype.createMediator=function(e){if(!this._viewMap.has(e)){if(!e)throw new Error("参数不能为空！");var o=egret.getQualifiedClassName(e);if(!this._classMap.hasOwnProperty(o))throw new Error("没有映射关系！");e.once(egret.Event.REMOVED_FROM_STAGE,this.onViewRemoved,this);var n=this._classMap[o],i=t.recyclable(n);i.view=e,i.onRegister(),this._viewMap.add(e,i)}},e.prototype.onViewRemoved=function(t){var e=t.currentTarget;this._viewMap.has(e)&&this.destroyMediator(e)},e.prototype.destroyMediator=function(t){if(!t)throw new Error("参数不能为空！");if(this._viewMap.has(t)){var e=this._viewMap.get(t);e.onRemove(),e.recycle(),this._viewMap.remove(t)}},e.prototype.registerMediator=function(t,e){if(!t||!e)throw new Error("参数不能为空！");var o=egret.getQualifiedClassName(t);if(this._classMap.hasOwnProperty(o))throw new Error("映射已经存在，不能重复添加映射关系！");this._classMap[o]=e,t.__isMediatorView=!0},e.prototype.hasMediator=function(t){var e=egret.getQualifiedClassName(t);return this._classMap.hasOwnProperty(e)},e.prototype.getMediator=function(t){return this._viewMap.get(t)},e.prototype.removeMediator=function(t,e){if(!t||!e)throw new Error("参数不能为空！");var o=egret.getQualifiedClassName(t);delete this._classMap[o]},e}();t.ViewManager=e,__reflect(e.prototype,"game.ViewManager")}(game||(game={}));var game;!function(t){var e;!function(t){function e(t){c.setMaxLoadingThread(t)}function o(t){return RES.getRes(t)}function n(t,e,o,n){void 0===n&&(n=0),c.getResAsync(t,e,o,n)}function i(t,e){return void 0===e&&(e=0),c.getResAsyncAsync(t,e)}function r(t,e,o,n,i){void 0===i&&(i=0),c.getResByUrl(t,e,o,n,i)}function a(t,e,o){return void 0===o&&(o=0),c.getResByUrlAsync(t,e,o)}t.setMaxLoadingThread=e,t.getRes=o,t.getResAsync=n,t.getResAsyncAsync=i,t.getResByUrl=r,t.getResByUrlAsync=a;var s=function(){function e(){this._maxLoadingThread=2,this._nowLoadingThread=0,this._priorityList=[],this._priorityMap={}}return e.prototype.setMaxLoadingThread=function(t){this._maxLoadingThread=Math.max(t,1)},e.prototype.getResAsync=function(t,e,o,n){void 0===n&&(n=0),this._priorityMap[n]||(this._priorityList.push(n),this._priorityList.sort(this.sortFunc),this._priorityMap[n]=[]);var i=this._priorityMap[n];i.push({inConfig:!0,key:t,compFunc:e,thisObject:o}),this.loadNext()},e.prototype.getResAsyncAsync=function(e,o){var n=this;return void 0===o&&(o=0),new Promise(function(i,r){t.getResAsync(e,function(t,e){i(t)},n,o)})},e.prototype.getResByUrl=function(t,e,o,n,i){void 0===i&&(i=0),this._priorityMap[i]||(this._priorityList.push(i),this._priorityList.sort(this.sortFunc),this._priorityMap[i]=[]);var r=this._priorityMap[i];r.push({inConfig:!1,url:t,compFunc:e,thisObject:o,type:n}),this.loadNext()},e.prototype.getResByUrlAsync=function(e,o,n){var i=this;return void 0===n&&(n=0),new Promise(function(r,a){t.getResByUrl(e,function(t,e){r(t)},i,o,n)})},e.prototype.sortFunc=function(t,e){return e-t},e.prototype.loadNext=function(){var t=this;if(!(this._nowLoadingThread>=this._maxLoadingThread)){for(var e,o=0,n=this._priorityList;o<n.length;o++){var i=n[o],r=this._priorityMap[i];if(r.length>0){e=r.shift();break}}e&&(e.inConfig?(this._nowLoadingThread++,RES.getResAsync(e.key,function(o,n){t._nowLoadingThread--,e.compFunc&&e.compFunc.call(e.thisObject,o,n),t.loadNext()},this)):(this._nowLoadingThread++,RES.getResByUrl(e.url,function(o,n){t._nowLoadingThread--,e.compFunc&&e.compFunc.call(e.thisObject,o,n),t.loadNext()},this,e.type)))}},e}();__reflect(s.prototype,"Resource");var c=new s}(e=t.RESP||(t.RESP={}))}(game||(game={}));var game;!function(t){var e;!function(t){function e(t){i.init(t)}function o(t){return i.getRealUrl(t)}t.init=e,t.getRealUrl=o;var n=function(){function t(){}return t.prototype.init=function(t){this._map=t},t.prototype.getRealUrl=function(t){return this._map[t]?this._map[t]:t},t}();__reflect(n.prototype,"Impl");var i=new n}(e=t.RESVersion||(t.RESVersion={}))}(game||(game={}));var game;!function(t){var e=function(){function e(){this._targetMap=new t.Dictionary}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(t){var e=this;this._state!=t&&(this._state=t,this._targetMap.forEach(function(t,o){e.checkVisible(o,t)}))},enumerable:!0,configurable:!0}),e.prototype.includeIn=function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var r=t.recyclable(o);r.isIncludIn=!0,r.list=n,this._targetMap.add(e,r),this.checkVisible(e,r)},e.prototype.includeOut=function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var r=t.recyclable(o);r.isIncludIn=!1,r.list=n,this._targetMap.add(e,r),this.checkVisible(e,r)},e.prototype.checkVisible=function(t,e){return isNaN(this._state)?void(t.visible=!0):void(t.visible=e.getVisible(this._state))},e.prototype.targetRemoved=function(t){var e=this._targetMap.get(t);e&&(this._targetMap.remove(t),e.recycle(),t.visible=!0)},e}();t.PanelStateManager=e,__reflect(e.prototype,"game.PanelStateManager");var o=function(){function t(){}return t.prototype.getVisible=function(t){var e=-1!=this.list.indexOf(t);return this.isIncludIn?e:!e},t.prototype.onRecycle=function(){this.isIncludIn=void 0,this.list=void 0},t}();__reflect(o.prototype,"PanelState",["game.ICacheable"])}(game||(game={}));var game;!function(t){var e=function(e){function o(){var o=e.call(this)||this;return o._playing=!1,o._autoStop=!0,o._resMgr=t.$singlon(t.ParticleResMgr),o.on(egret.Event.ADDED_TO_STAGE,o.onAddedToStage,o),o.on(egret.Event.REMOVED_FROM_STAGE,o.onRemovedFromStage,o),o}return __extends(o,e),Object.defineProperty(o.prototype,"autoStop",{get:function(){return this._autoStop},set:function(t){this._autoStop=t},enumerable:!0,configurable:!0}),o.prototype.setPath=function(t){this._url=t},o.prototype.play=function(){this._data&&(this._data.removeSelf(),this._data.stop(!0),this._data=void 0),this._res&&(this.stage&&this._res.subtractUsing(),this._res.off(egret.Event.COMPLETE,this.onLoaded,this),this._res.off(egret.Event.REMOVED,this.onDispose,this),this._res=void 0),this._playing=!0,this.$play()},o.prototype.$play=function(){this._url&&(this._res=this._resMgr.getRes(this._url),this.stage&&this._res.addUsing(),2==this._res.status?this.onLoaded():(this._res.on(egret.Event.COMPLETE,this.onLoaded,this),this._res.on(egret.Event.REMOVED,this.onDispose,this),this._res.load()))},o.prototype.onLoaded=function(t){this._data=this._res.data,this.addChild(this._data),this._playing&&this._data.start()},o.prototype.onDispose=function(t){this._data&&(this._data.removeSelf(),this._data.stop(!0),this._data=void 0),this._res&&(this._res.off(egret.Event.COMPLETE,this.onLoaded,this),this._res.off(egret.Event.REMOVED,this.onDispose,this),this._res=void 0)},o.prototype.resume=function(){!this._playing&&this._data&&(this._playing=!0,this._data.start())},o.prototype.stop=function(t){this._playing&&this._data&&(this._playing=!1,this._data.stop(t))},o.prototype.onAddedToStage=function(t){this._res?(this._res.addUsing(),2==this._res.status&&this.onLoaded(),this._autoStop&&this.resume()):this._url&&this.$play()},o.prototype.onRemovedFromStage=function(t){this._res&&this._res.subtractUsing(),this._autoStop&&this.stop()},o.prototype.dispose=function(){this._data&&(this._data.removeSelf(),this._data.stop(!0),this._data=void 0),this._res&&(this.stage&&this._res.subtractUsing(),this._res.off(egret.Event.COMPLETE,this.onLoaded,this),this._res.off(egret.Event.REMOVED,this.onDispose,this),this._res=void 0),this._url=void 0,this._playing=!1,this._autoStop=!0},o}(egret.DisplayObjectContainer);t.ParticleClip=e,__reflect(e.prototype,"game.ParticleClip",["game.IDispose"])}(game||(game={}));var game;!function(t){var e;!function(e){function o(t,e,o,n){return void 0===o&&(o=0),void 0===n&&(n=0),a.play(t,e,o,n)}function n(t){a.clear(t)}function i(t){a.recycle(t)}e.play=o,e.clear=n,e.recycle=i;var r=function(){function e(){}return e.prototype.play=function(e,o,n,i){void 0===n&&(n=0),void 0===i&&(i=0);var r=t.recyclable(t.ParticleClip);return r.x=n,r.y=i,r.setPath(e),r.play(),o.addChild(r),r},e.prototype.clear=function(e){for(var o=0;o<e.numChildren;o++){var n=e.getChildAt(o);n instanceof t.ParticleClip&&(this.recycle(n),o--)}},e.prototype.recycle=function(t){t.removeSelf(),t.dispose(),t.recycle()},e}();__reflect(r.prototype,"Impl");var a=new r}(e=t.ParticleManager||(t.ParticleManager={}))}(game||(game={}));var game;!function(t){var e=function(e){function o(){var t=e.call(this)||this;return t._connected=!1,t._reconnectCount=0,t._isRelogin=!1,t}return __extends(o,e),Object.defineProperty(o.prototype,"host",{get:function(){return this._host},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"port",{get:function(){return this._port},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"connected",{get:function(){return this._connected},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"packgeInfo",{get:function(){return this._socket?this._socket.packgeInfo:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isRelogin",{get:function(){return this._isRelogin},set:function(t){this._isRelogin=t},enumerable:!0,configurable:!0}),o.prototype.connect=function(){this._connected&&this.close(),this._socket=new t.SocketConnect,this._socket.on(egret.Event.CONNECT,this.onOpen,this),this._socket.on(t.SocketConnect.PACKET,this.onPacket,this),this._socket.on(egret.Event.CLOSE,this.onReconnect,this),this._socket.on(egret.IOErrorEvent.IO_ERROR,this.onReconnect,this);var e=t.ServerIP.serverIP,o=t.ServerIP.port;this._url=t.ServerIP.SocketType+e+":"+o+t.Route.game+"?id="+t.GlobalInfo.account,this._socket.connect(this._url),this._host=e,this._port=o},o.prototype.reconnect=function(){this.connect()},o.prototype.send=function(t){this._socket?this._socket.send(t):(this._netVO=t,this.connect())},o.prototype.onOpen=function(t){this._connected=!0,this._socket.off(egret.Event.CLOSE,this.onReconnect,this),this._socket.off(egret.IOErrorEvent.IO_ERROR,this.onReconnect,this),this._socket.on(egret.Event.CLOSE,this.onDisconnect,this),this._socket.on(egret.IOErrorEvent.IO_ERROR,this.onDisconnect,this),this._netVO&&(this.send(this._netVO),this._netVO=void 0)},o.prototype.onPacket=function(e){var o=e.data;o.response?o.response.nErrorCode==gameMsg.ErrorCode.success?this.dispatch(o.type,!1,o.response):t.$facade.addModule(t.ModuleID.msg,void 0,t.ErrorCodeText[o.response.nErrorCode]):o.notify&&this.dispatch(o.type,!1,o.notify)},o.prototype.onReconnect=function(t){this._reconnectCount>=o._maxReconnectCount?(alert("服务端连接失败！"),this._socket=void 0):(this._reconnectCount++,this._socket.connect(this._url))},o.prototype.onDisconnect=function(e){this.close(),t.$facade.dispatch(8)},o.prototype.close=function(){this._connected=!1,this._socket.off(egret.Event.CONNECT,this.onOpen,this),this._socket.off(t.SocketConnect.PACKET,this.onPacket,this),this._socket.off(egret.Event.CLOSE,this.onReconnect,this),this._socket.off(egret.IOErrorEvent.IO_ERROR,this.onReconnect,this),this._socket.off(egret.Event.CLOSE,this.onDisconnect,this),this._socket.off(egret.IOErrorEvent.IO_ERROR,this.onDisconnect,this),this._socket.close(),this._socket=void 0,this._url=void 0,this._reconnectCount=0},o._maxReconnectCount=5,o}(egret.EventDispatcher);t.ServerConnect=e,__reflect(e.prototype,"game.ServerConnect")}(game||(game={}));var game;!function(t){var e=function(t){function e(e,o){return t.call(this,e,o)||this}return __extends(e,t),e.prototype.validate=function(t){var e=this._bytes.length;return e>0&&this._position+t<=e?!0:(this.vo,void egret.$error(1025))},e.prototype.readLong=function(){var t,e;return 1==this.$endian?(t=this.readUnsignedInt(),e=this.readUnsignedInt()):(e=this.readUnsignedInt(),t=this.readUnsignedInt()),this.toNumber(t,e)},e.prototype.toNumber=function(t,e,o){return!o&&t>>>31?(e=~e+1>>>0,t=~t>>>0,e||(t=t+1>>>0),-(e+4294967296*t)):e+4294967296*t},e.prototype.writeLong=function(t){var e=0,o=0;if(0!==t){var n=0>t;n&&(t=-t),o=t>>>0,e=(t-o)/4294967296>>>0,n&&(e=~e>>>0,o=~o>>>0,++o>4294967295&&(o=0,++e>4294967295&&(e=0)))}1==this.$endian?(this.writeUnsignedInt(e),this.writeUnsignedInt(o)):(this.writeUnsignedInt(o),this.writeUnsignedInt(e))},e.prototype.readByteArray=function(){for(var t=this.readShort(),e=[],o=0;t>o;o++)e[o]=this.readByte();return e},e.prototype.writeByteArray=function(t){if(!t)return void this.writeShort(0);this.writeShort(t.length);for(var e=0;e<t.length;e++)this.writeByte(t[e])},e.prototype.readShortArray=function(){for(var t=this.readShort(),e=[],o=0;t>o;o++)e[o]=this.readShort();return e},e.prototype.writeShortArray=function(t){if(!t)return void this.writeShort(0);this.writeShort(t.length);for(var e=0;e<t.length;e++)this.writeShort(t[e])},e.prototype.readIntArray=function(){for(var t=this.readShort(),e=[],o=0;t>o;o++)e[o]=this.readInt();return e},e.prototype.writeIntArray=function(t){if(!t)return void this.writeShort(0);this.writeShort(t.length);for(var e=0;e<t.length;e++)this.writeInt(t[e])},e.prototype.readLongArray=function(){for(var t=this.readShort(),e=[],o=0;t>o;o++)e[o]=this.readLong();return e},e.prototype.writeLongArray=function(t){if(!t)return void this.writeShort(0);this.writeShort(t.length);for(var e=0;e<t.length;e++)this.writeLong(t[e])},e.prototype.readFloatArray=function(){for(var t=this.readShort(),e=[],o=0;t>o;o++)e[o]=this.readFloat();return e},e.prototype.writeFloatArray=function(t){if(!t)return void this.writeShort(0);this.writeShort(t.length);for(var e=0;e<t.length;e++)this.writeFloat(t[e])},e.prototype.readUTFArray=function(){for(var t=this.readShort(),e=[],o=0;t>o;o++)e[o]=this.readUTF();return e},e.prototype.writeUTFArray=function(t){if(!t)return void this.writeShort(0);this.writeShort(t.length);for(var e=0;e<t.length;e++)this.writeUTF(t[e])},e}(egret.ByteArray);t.BinaryBuffer=e,__reflect(e.prototype,"game.BinaryBuffer")}(game||(game={}));var game;!function(t){var e=function(t){function e(){var o=t.call(this)||this;return o._packgeInfo={},e.inputBuffer=new ArrayBuffer(e.maxSendBufferSize),o}return __extends(e,t),Object.defineProperty(e.prototype,"connected",{get:function(){return this._socket?this._socket.connected:!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"packgeInfo",{get:function(){return this._packgeInfo},enumerable:!0,configurable:!0}),e.prototype.connect=function(t){this._socket&&this.close(),this._socket=new egret.WebSocket,this._socket.type=egret.WebSocket.TYPE_BINARY,this._socket.on(egret.Event.CONNECT,this.onOpen,this),this._socket.on(egret.ProgressEvent.SOCKET_DATA,this.onMessage,this),this._socket.on(egret.Event.CLOSE,this.onClose,this),this._socket.on(egret.IOErrorEvent.IO_ERROR,this.onError,this),this._socket.connectByUrl(t)},e.prototype.send=function(t){var e=gameMsg.Msg.verify(t);if(e)throw Error(e);var o=gameMsg.Msg.create(t),n=gameMsg.Msg.encode(o).finish(),i=new egret.ByteArray(n);this._socket&&(this._socket.writeBytes(i,0,i.bytesAvailable),this._socket.flush())},e.prototype.onOpen=function(t){this.dispatchEvent(t)},e.prototype.onMessage=function(t){if(t){var o=new egret.ByteArray;this._socket.readBytes(o);var n=gameMsg.Msg.decode(o.bytes);this.dispatch(e.PACKET,!1,n)}},e.prototype.onClose=function(t){this.dispatchEvent(t)},e.prototype.onError=function(t){this.dispatchEvent(t)},e.prototype.close=function(){this._socket&&(this._socket.off(egret.Event.CONNECT,this.onOpen,this),this._socket.off(egret.ProgressEvent.SOCKET_DATA,this.onMessage,this),this._socket.off(egret.Event.CLOSE,this.onClose,this),this._socket.off(egret.IOErrorEvent.IO_ERROR,this.onError,this),this._socket.close(),this._socket=void 0)},e.maxSendBufferSize=6144,e.PACKET="packet",e}(egret.EventDispatcher);t.SocketConnect=e,__reflect(e.prototype,"game.SocketConnect")}(game||(game={}));var game;!function(t){var e=function(){function t(t){this._map=t||{},this._keyMap={},this._size=0}return Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),t.prototype.getKey=function(t){return t instanceof egret.HashObject?t.hashCode.toString():t.toString()},t.prototype.add=function(t,e){var o=this.getKey(t);this._map.hasOwnProperty(o)||++this._size,this._map[o]=e,this._keyMap[o]=t},t.prototype.has=function(t){var e=this.getKey(t);return this._map.hasOwnProperty(e)},t.prototype.get=function(t){var e=this.getKey(t);return this._map[e]},t.prototype.forEach=function(t,e){for(var o in this._map)this._map.hasOwnProperty(o)&&t.call(e,this._map[o],this._keyMap[o],this)},t.prototype.remove=function(t){var e=this.getKey(t);return this._map.hasOwnProperty(e)?(delete this._map[e],delete this._keyMap[e],--this._size,!0):!1},t.prototype.clear=function(){this._map={},this._keyMap={},this._size=0},t.prototype.toString=function(){var t=[];for(var e in this._map)this._map.hasOwnProperty(e)&&t.push("{key:"+this._keyMap[e]+", value:"+this._map[e]+"}");return"{"+t.join(", ")+"}"},t.prototype.keyOf=function(){return this._keyMap},t.prototype.valueOf=function(){return this._map},t}();t.Dictionary=e,__reflect(e.prototype,"game.Dictionary")}(game||(game={}));var game;!function(t){function e(t){var e=t.__instance;return e||(e=t.__instance=new t),e}t.getSinglon=e}(game||(game={}));var game;!function(t){var e=function(e){function o(o){void 0===o&&(o=!0);var n=e.call(this)||this;return n._facade=t.Facade.instance,o&&n.map(),n}return __extends(o,e),o.prototype.map=function(){var e=t.$facade.addListener.bind(t.$facade),o=this.__interestNotifyList;for(var n in o){var i=o[n];for(var r in i){var a=i[r];e(n,a,this)}}},o.prototype.unmap=function(){var e=t.$facade.removeListener.bind(t.$facade),o=this.__interestNotifyList;for(var n in o){var i=o[n];for(var r in i){var a=i[r];e(n,a,this)}}},o}(t.Notifier);t.InjectableObject=e,__reflect(e.prototype,"game.InjectableObject")}(game||(game={}));var game;!function(t){var e=function(){function t(t,e){void 0===e&&(e=50),this._creator=t,this._maxCount=e,this._list=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this._list.length},enumerable:!0,configurable:!0}),t.prototype.join=function(t){"function"==typeof t.onRecycle&&t.onRecycle(),this._list.length<this._maxCount&&this._list.pushUnique(t)},t.prototype.take=function(){var t;return 0==this._list.length?t=new this._creator:(t=this._list.pop(),"function"==typeof t.onReuse&&t.onReuse()),t},t.prototype.clear=function(){this._list.length=0},t}();t.ObjectPool=e,__reflect(e.prototype,"game.ObjectPool")}(game||(game={}));var game;!function(t){var e=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.initializeCommands=function(){t.$facade.removeCommand(2),this.addSubCommand(t.InitCommand),this.addSubCommand(t.InitModel),this.addSubCommand(t.InitView),this.addSubCommand(t.GamePreloadCommand)},o}(t.CommandQueue);t.ContextInitCommand=e,__reflect(e.prototype,"game.ContextInitCommand")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"timer",{get:function(){return this._timer},enumerable:!0,configurable:!0}),Object.defineProperty(t,"deltaTime",{get:function(){return this._deltaTime},enumerable:!0,configurable:!0}),Object.defineProperty(t,"loginTime",{get:function(){return this._loginTime},enumerable:!0,configurable:!0}),Object.defineProperty(t,"serverTime",{get:function(){return Date.now()+this._timeDif},enumerable:!0,configurable:!0}),t.tick=function(){this._timer=egret.getTimer(),this._deltaTime=this._timer-this._lastTime,this._lastTime=this._timer},t.setServerTime=function(t){this._loginTime=t,this._timeDif=t-Date.now()},t._lastTime=0,t}();t.GameTime=e,__reflect(e.prototype,"game.GameTime")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t)},enumerable:!0,configurable:!0}),t}();t.UserData=e,__reflect(e.prototype,"game.UserData")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t}();t.AccountVO=e,__reflect(e.prototype,"game.AccountVO")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.prototype.init=function(e,o){this.map=new t.MapVO,this.map.rowGrids=e,this.map.colGrids=o,this.map.initMap(),this.mapData=new t.MapVO,this.mapData.rowGrids=e+2,this.mapData.colGrids=o+2,this.mapData.initMap()},e.prototype.update=function(t){this.updateMap(t),this.updateDataMap(t)},e.prototype.updateMap=function(t){for(var e=t.data,o=0;o<e.length;o++)for(var n=e[o],i=0;i<n.length;i++){var r=n[i];1==r&&(this.map.data[o][i]=3)}},e.prototype.updateDataMap=function(t){for(var e=t.data,o=0;o<t.rowGrids;o++)for(var n=e[o],i=0;i<t.colGrids;i++){var r=n[i];this.mapData.data[o+1][i+1]=r}},e.prototype.addMood=function(t){this.map.addMood(t)},e.prototype.removeMood=function(t){this.map.removeMood(t)},e}();t.GameMapVO=e,__reflect(e.prototype,"game.GameMapVO")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.prototype.update=function(e){this.curPort=e,this.updateMoods(e.moodListVO);var o=this.GameMapVO=new t.GameMapVO;o.map=new t.MapVO,o.init(this.curPort.mapVO.rowGrids,this.curPort.mapVO.colGrids),o.update(e.mapVO)},e.prototype.updateMoods=function(e){this.moodListVO=[];for(var o=0,n=e;o<n.length;o++){var i=n[o],r=new t.MapVO;r.row=-1,r.col=-1,r.rowGrids=i.rowGrids,r.colGrids=i.colGrids,r.type=i.type,r.initMap(),r.addMap(1,1,i.data),this.moodListVO.push(r)}},e.prototype.addMood=function(){},e.prototype.removeMood=function(){},e}();t.GamePortVO=e,__reflect(e.prototype,"game.GamePortVO")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.prototype.update=function(t){var e=this;e.sID=t.sID,e.sHeadImg=t.sHeadImg,e.sNick=t.sNick,e.nRankLevel=t.nRankLevel},t}();t.GamerVO=e,__reflect(e.prototype,"game.GamerVO")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.prototype.init=function(t){if(this.rowGrids=t.row,this.colGrids=t.col,this.initMap(),t.point)for(var e=0,o=t.point;e<o.length;e++){var n=o[e],i=n.row-1,r=n.col-1;this.data[i][r]=2}},e.prototype.initMap=function(){this.data=[];for(var t=0;t<this.rowGrids;t++){for(var e=[],o=0;o<this.colGrids;o++)e.push(0);this.data.push(e)}},e.prototype.initPos=function(){this.col=-1,this.row=-1},e.prototype.update=function(e){this.row=parseInt(e.row),this.col=parseInt(e.col),this.data=t.ConfigManager.getMoodInfo(e.moodId),this.rowGrids=this.data.length,this.colGrids=this.data[0].length},e.prototype.addMood=function(t){this.addMap(t.row,t.col,t.data)},e.prototype.addMap=function(t,e,o){for(var n=0;n<o.length;n++)for(var i=o[n],r=0;r<i.length;r++){var a=i[r];if(1==a){var s=n+t-1,c=r+e-1;this.data[s][c]=1}}},e.prototype.removeMood=function(t){for(var e=t.data,o=0;o<e.length;o++)for(var n=e[o],i=0;i<n.length;i++){var r=n[i];if(1==r){var a=o+t.row-1,s=i+t.col-1;this.data[a][s]=3}}},e}();t.MapVO=e,__reflect(e.prototype,"game.MapVO")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.prototype.updateTool=function(e){for(var o=this,n=0,i=o.toolList;n<i.length;n++){var r=i[n];r.count=0}if(e)for(var a=e.split(";"),s=0,c=a;s<c.length;s++){var u=c[s],p=u.split(":");o.toolMap[p[0]].count=p[1]}t.$facade.dispatch(27)},e.prototype.updateOneTool=function(e){for(var o=this,n=0,i=o.toolList;n<i.length;n++){var r=i[n];r.id===e.id&&(r.count=e.count)}o.toolMap[e.id].count=e.count,t.$facade.dispatch(27)},e}();t.PlayerVO=e,__reflect(e.prototype,"game.PlayerVO")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t}();t.ToolVO=e,__reflect(e.prototype,"game.ToolVO")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.prototype.updateList=function(e){for(var o=0;o<e.length;o++){var n=e[o],i=new t.PortVO,r=i.mapVO=new t.MapVO;i.moodListVO=[];r.init(n),i.starNum=0,i.id=o+1,0==o?i.state=1:i.state=0;try{i.update(n.map)}catch(a){console.log(a),console.log("第"+i.id+"关卡数据错误")}this.portList.push(i)}},e.prototype.updatePorts=function(t,e){for(var o=0;o<t.length;o++)t[o]&&this.portList[o]&&(this.portList[o].starNum=t[o].gatestar,this.portList[o].state=1)},e.prototype.updatePort=function(t,e){t<this.portList.length?(this.portList[t-1].starNum=e,this.portList[t].state=1):t==this.portList.length&&(this.portList[t-1].starNum=e)},e.prototype.updateStarNum=function(e){this.starNum=this.typeTransfrom(e),t.$facade.dispatch(17)},e.prototype.updateKeyNum=function(e){this.keyNum=this.typeTransfrom(e),t.$facade.dispatch(16)},e.prototype.typeTransfrom=function(t){var e=""+t;return 1===e.length?e="00"+e:2===e.length&&(e="0"+e),e},e.prototype.getPort=function(t){return this.portList[t-1]},e}();t.PortListVO=e,__reflect(e.prototype,"game.PortListVO")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.prototype.update=function(e){for(var o=0;o<e.length;o++){var n=e[o],i=new t.MapVO;i.update(n),i.type=o+1,this.moodListVO.push(i),this.mapVO.addMood(i)}},e.prototype.updateStart=function(e){this.starNum=e,t.$facade.dispatch(11)},e}();t.PortVO=e,__reflect(e.prototype,"game.PortVO")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.prototype.updateList=function(e){for(var o=0;o<e.length;o++){var n=e[o],i=new t.RankVO;i.rank=n.rank,i.starNum=n.starNum,this.rankList.push(i)}},e}();t.RankListVo=e,__reflect(e.prototype,"game.RankListVo")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t}();t.RankVO=e,__reflect(e.prototype,"game.RankVO")}(game||(game={}));var game;!function(t){var e=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.execute=function(e){var o=t.$facade.registerCommand.bind(t.$facade);o(3,t.GameStartupCommand)},o}(t.Command);t.InitCommand=e,__reflect(e.prototype,"game.InitCommand")
}(game||(game={}));var game;!function(t){var e=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.execute=function(e){var o=t.$facade.registerProxy.bind(t.$facade);o(new t.TestProxy),o(new t.LoginProxy),o(new t.PortProxy),o(new t.RankProxy),o(new t.WinProxy),o(new t.MainProxy),o(new t.RoomProxy),o(new t.MenuProxy),o(new t.PkMainproxy),o(new t.ShopProxy),o(new t.PKWinproxy)},o}(t.Command);t.InitModel=e,__reflect(e.prototype,"game.InitModel")}(game||(game={}));var game;!function(t){var e=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.onRegister=function(){e.prototype.onRegister.call(this)},o.prototype.click=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),t.$facade.removeModule(t.ModuleID.ad)},__decorate([t.InterestEvent(0)],o.prototype,"click",null),o}(t.MediatorBase);t.AdMediator=e,__reflect(e.prototype,"game.AdMediator")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return t.call(this,"gameSkin.AdSkin")||this}return __extends(e,t),e.prototype.createComponent=function(){},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.btn_close.on(egret.TouchEvent.TOUCH_TAP,this.onCloseClick,this)},e.prototype.onCloseClick=function(t){this.dispatch(0,!0)},e}(t.DialogBase);t.AdDialog=e,__reflect(e.prototype,"game.AdDialog")}(game||(game={}));var game;!function(t){var e=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.execute=function(t){switch(t){case 8:break;case 9:}},o.prototype.onReconnect=function(){},__decorate([t.InjectProxy(1)],o.prototype,"model",void 0),o}(t.Command);t.ConnectBreakCommand=e,__reflect(e.prototype,"game.ConnectBreakCommand")}(game||(game={}));var game;!function(t){var e=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.execute=function(e){var o=this;t.ResourceManager.instance,t.$stage.addChild(new t.GameView),this.load().then(function(){o.model.reqLogin(),t.$facade.addModule(t.ModuleID.scene)})},o.prototype.load=function(){return __awaiter(this,void 0,void 0,function(){var e,o,n;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,this.loadTheme()];case 2:return i.sent(),[4,RES.loadGroup("preload",0,this)];case 3:return i.sent(),e=t.RESP.getRes("mapinfo_json"),t.ConfigManager.init(e),this.initPort(e),[4,platform.login()];case 4:return o=i.sent(),t.GlobalInfo.initAccount(o),[3,6];case 5:return n=i.sent(),console.error(n),[3,6];case 6:return[2]}})})},o.prototype.initPort=function(e){var o=t.$userData.portList=new t.PortListVO;o.portList=[],o.updateList(e.port)},o.prototype.initPKPort=function(e){var o=t.$userData.portPKList=new t.PortListVO;o.portList=[],o.updateList(e.port)},o.prototype.onProgress=function(t,e){console.log("加载进度: "+t+"/"+e)},o.prototype.loadTheme=function(){var e=this;return new Promise(function(o,n){removeEventListener;var i=new eui.Theme("resource/default.thm.json",t.$stage);i.addEventListener(eui.UIEvent.COMPLETE,function(){o()},e)})},__decorate([t.InjectProxy(1)],o.prototype,"model",void 0),o}(t.Command);t.GamePreloadCommand=e,__reflect(e.prototype,"game.GamePreloadCommand",["RES.PromiseTaskReporter"])}(game||(game={}));var game;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.execute=function(t,e){},e}(t.Command);t.GameStartupCommand=e,__reflect(e.prototype,"game.GameStartupCommand")}(game||(game={}));var game;!function(t){var e=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.onRegister=function(){e.prototype.onRegister.call(this),t.ModuleManager.init(this._view),t.FullWindowManager.init(this._view.fullWindowLayer),t.DialogManager.init(this._view.dialogLayer),t.Notice.init(this._view.messageLayer)},o}(t.MediatorBase);t.GameMediator=e,__reflect(e.prototype,"game.GameMediator")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return t.call(this,1)||this}return __extends(e,t),e}(t.ProxyBase);t.GameProxy=e,__reflect(e.prototype,"game.GameProxy")}(game||(game={}));var game;!function(t){var e=egret.DisplayObjectContainer,o=eui.Group,n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.sceneLayer=new e,this.sceneLayer.touchEnabled=!1,this.sceneLayer.touchChildren=!0,this.addChild(this.sceneLayer),this.weatherLayer=new o,this.weatherLayer.percentWidth=this.weatherLayer.percentHeight=100,this.weatherLayer.touchEnabled=this.weatherLayer.touchChildren=!1,this.weatherLayer.touchThrough=!0,this.addChild(this.weatherLayer),this.bottomLayer=new o,this.bottomLayer.percentWidth=this.bottomLayer.percentHeight=100,this.bottomLayer.touchThrough=!0,this.addChild(this.bottomLayer),this.bottomUILayer=new o,this.bottomUILayer.percentWidth=this.bottomUILayer.percentHeight=100,this.bottomUILayer.touchThrough=!0,this.addChild(this.bottomUILayer),this.fullWindowLayer=new o,this.fullWindowLayer.percentWidth=this.fullWindowLayer.percentHeight=100,this.fullWindowLayer.touchThrough=!0,this.addChild(this.fullWindowLayer),this.mainUILayer=new o,this.mainUILayer.percentWidth=this.mainUILayer.percentHeight=100,this.mainUILayer.touchThrough=!0,this.addChild(this.mainUILayer),this.dialogLayer=new o,this.dialogLayer.percentWidth=this.dialogLayer.percentHeight=100,this.dialogLayer.touchThrough=!0,this.addChild(this.dialogLayer),this.popLayer=new o,this.popLayer.percentWidth=this.popLayer.percentHeight=100,this.popLayer.touchThrough=!0,this.addChild(this.popLayer),this.alertLayer=new o,this.alertLayer.percentWidth=this.alertLayer.percentHeight=100,this.alertLayer.touchThrough=!0,this.addChild(this.alertLayer),this.guideLayer=new o,this.guideLayer.percentWidth=this.guideLayer.percentHeight=100,this.guideLayer.touchThrough=!0,this.addChild(this.guideLayer),this.messageLayer=new o,this.messageLayer.percentWidth=this.messageLayer.percentHeight=100,this.messageLayer.touchEnabled=this.messageLayer.touchChildren=!1,this.messageLayer.touchThrough=!0,this.addChild(this.messageLayer),this.topLayer=new o,this.topLayer.percentWidth=this.topLayer.percentHeight=100,this.topLayer.touchThrough=!0,this.addChild(this.topLayer)},n}(eui.UILayer);t.GameView=n,__reflect(n.prototype,"game.GameView",["game.IModuleContainer"])}(game||(game={}));var game;!function(t){var e=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.execute=function(e){t.ViewManager.instance.contextView=t.$stage;var o=t.$facade.registerMediator.bind(t.$facade),n=function(e,n,i){o(n,i),t.ModuleManager.mapModule(e,n)};o(t.GameView,t.GameMediator),n(t.ModuleID.scene,t.SceneView,t.SceneMediator),n(t.ModuleID.test,t.TestView,t.TestMediator),n(t.ModuleID.menu,t.MenuFullWindow,t.MenuMediator),n(t.ModuleID.main,t.MainFullWindow,t.MainMediator),n(t.ModuleID.port,t.PortFullWindow,t.PortMediator),o(t.SetView,t.SetMediator),n(t.ModuleID.win,t.WinDialog,t.WinMediator),n(t.ModuleID.rank,t.RankDialog,t.RankMediator),n(t.ModuleID.humor,t.HumorDialog,t.HumorMediator),n(t.ModuleID.ad,t.AdDialog,t.AdMediator),n(t.ModuleID.room,t.RoomFullWindow,t.RoomMediator),n(t.ModuleID.pkmain,t.PKMainFullWindow,t.PKMainMediator),n(t.ModuleID.pkwin,t.PKWinFullWindow,t.PKWinMediator),n(t.ModuleID.pklose,t.PkLoseView,t.PkLoseMediator),n(t.ModuleID.shop,t.ShopView,t.ShopMediator),n(t.ModuleID.tool,t.ToolView,t.ToolMediator),n(t.ModuleID.login,t.LoginFullWindow,t.LoginMediator),n(t.ModuleID.msg,t.MsgDialog,t.MsgMediator)},o}(t.Command);t.InitView=e,__reflect(e.prototype,"game.InitView")}(game||(game={}));var game;!function(t){var e=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.onRegister=function(){e.prototype.onRegister.call(this)},o.prototype.setModuleData=function(t){1==t?this._view.showBuyaoImg():this._view.showBunengImg()},o.prototype.click=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),t.$facade.removeModule(t.ModuleID.humor)},o.prototype.portClick=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),t.$facade.removeModule(t.ModuleID.humor)},__decorate([t.InterestEvent(0)],o.prototype,"click",null),__decorate([t.InterestEvent(1)],o.prototype,"portClick",null),o}(t.MediatorBase);t.HumorMediator=e,__reflect(e.prototype,"game.HumorMediator")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return t.call(this,"gameSkin.HumorSkin")||this}return __extends(e,t),e.prototype.createComponent=function(){},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.btn_close.on(egret.TouchEvent.TOUCH_TAP,this.onCloseClick,this),this.btn_port.on(egret.TouchEvent.TOUCH_TAP,this.onPortClick,this),this.edit_text.prompt="内容不要超过两百字哟"},e.prototype.onPortClick=function(){this.dispatch(1,!0)},e.prototype.onCloseClick=function(t){this.dispatch(0,!0)},e.prototype.showBuyaoImg=function(){},e.prototype.showBunengImg=function(){},e}(t.DialogBase);t.HumorDialog=e,__reflect(e.prototype,"game.HumorDialog")}(game||(game={}));var game;!function(t){var e=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.execute=function(e,o){t.GameTime.setServerTime(o.serverTime)},o}(t.Command);t.UserDataInitCommand=e,__reflect(e.prototype,"game.UserDataInitCommand")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.execute=function(t,e){},e}(t.Command);t.UserDataUpdateCommand=e,__reflect(e.prototype,"game.UserDataUpdateCommand")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var o=e.call(this)||this;return o._timeScale=1,o._filp=!1,o._scale=1,o._immediatePlay=!0,o._playing=!1,o._nowFrame=-1,o._resMgr=t.$singlon(t.AnimationResMgr),o}return __extends(o,e),Object.defineProperty(o.prototype,"scale",{get:function(){return this._scale},set:function(t){this._scale!=t&&(this._scale=t,this.updateScale())},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"frameRate",{get:function(){return this._frameRate},set:function(t){if(this._frameRate!=t){this._frameRate=t;var e=isNaN(this._frameRate)?this._data.speed:this._frameRate;this._interval=1e3/e,this._playing&&this._data&&(this._onceTime=this._interval*this._data.frameCount)}},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"timeScale",{get:function(){return this._timeScale},set:function(t){this._timeScale=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"immediatePlay",{get:function(){return this._immediatePlay},set:function(t){this._immediatePlay=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"playing",{get:function(){return this._playing},enumerable:!0,configurable:!0}),o.prototype.setPath=function(t){this._url=t},o.prototype.play=function(t,e,o,n){void 0===t&&(t=0),void 0===e&&(e=1);for(var i=[],r=4;r<arguments.length;r++)i[r-4]=arguments[r];this._res&&(this._res.off(egret.Event.COMPLETE,this.onLoaded,this),this._res.subtractUsing(),this._res=void 0),this._playing=!0,this._data=void 0,this._times=e,this._completeHandler=o,this._thisObj=n,this._args=i,this._lastTime=t,this.$play()},o.prototype.$play=function(){this._resInvalid=!0;var t=this._url;this._res=this._resMgr.getRes(t),this._res.addUsing(),2==this._res.status?this.onLoaded():(this._res.on(egret.Event.COMPLETE,this.onLoaded,this),this._res.load())},o.prototype.onLoaded=function(t){this._data=this._res.data;var e=isNaN(this._frameRate)?this._data.speed:this._frameRate;if(this._interval=1e3/e,this._onceTime=this._interval*this._data.frameCount,t){this._res.off(egret.Event.COMPLETE,this.onLoaded,this);var o=0,n=0;this._immediatePlay&&(o=Math.floor(this._lastTime/this._onceTime),n=Math.floor(this._lastTime%this._onceTime/this._interval)),this._times<=0?(this._nowTimes=o,this.showFrame(n)):o>=this._times?(this.showFrame(this._data.frameCount-1),this.playComplete()):(this._nowTimes=o,this.showFrame(n))}else this._nowTimes=0,this.showFrame(0)},o.prototype.update=function(t){if(this._playing&&(this._lastTime+=t*this._timeScale,this._data)){for(;this._lastTime>=this._onceTime*(this._nowTimes+1);)++this._nowTimes;if(this._times>0&&this._nowTimes>=this._times)this.showFrame(this._data.frameCount-1),this.playComplete();else{var e=Math.floor(this._lastTime%this._onceTime/this._interval);this.showFrame(e)}}},o.prototype.showFrame=function(t){if(this._resInvalid||this._nowFrame!=t){this._resInvalid=!1,this._nowFrame=t;var e=this._data.getFrame(t);this.anchorOffsetX=-e.offsetX,this.anchorOffsetY=-e.offsetY,this.texture=e.texture,this.updateScale()}},o.prototype.updateScale=function(){this.scaleX=this._scale*(this._filp?-1:1),this.scaleY=this._scale},o.prototype.playComplete=function(){var t=this._completeHandler,e=this._thisObj,o=this._args;this.onPlayComplete(),t&&t.call.apply(t,[e,this].concat(o))},o.prototype.onPlayComplete=function(){},o.prototype.dispose=function(){this._res&&(this._res.off(egret.Event.COMPLETE,this.onLoaded,this),this._res.subtractUsing(),this._res=void 0),this._url=void 0,this._frameRate=void 0,this._filp=!1,this._scale=1,this._immediatePlay=!0,this._times=void 0,this._completeHandler=void 0,this._thisObj=void 0,this._args=void 0,this._playing=!1,this._data=void 0,this._resInvalid=void 0,this._interval=void 0,this._lastTime=void 0,this._onceTime=void 0,this._nowTimes=void 0,this._nowFrame=-1,this.anchorOffsetX=0,this.anchorOffsetY=0,this.texture=void 0,this.scaleX=this.scaleY=1,this.alpha=1,this.visible=!0},o}(egret.Bitmap);t.AnimationClip=e,__reflect(e.prototype,"game.AnimationClip",["game.IClockClient","game.IDispose"])}(game||(game={}));var game;!function(t){var e=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.onRegister=function(){e.prototype.onRegister.call(this),this._view._initView()},o.prototype.clickLogin=function(e){var o=this._view.text_username.text;return""===o?void t.$facade.addModule(t.ModuleID.msg,void 0,"请输入登录信息"):(t.GlobalInfo.account=o,t.$userData.account.userid=o,void this.model.reqLogin())},__decorate([t.InjectProxy(1)],o.prototype,"model",void 0),__decorate([t.InterestEvent(0)],o.prototype,"clickLogin",null),o}(t.MediatorBase);t.LoginMediator=e,__reflect(e.prototype,"game.LoginMediator")}(game||(game={}));var game;!function(t){var e=function(e){function o(){return e.call(this,1)||this}return __extends(o,e),o.prototype.reqLogin=function(){this.loginresponse()},o.prototype.loginresponse=function(e){var o={gates:[],nTotalGate:0,nTotalStar:0,nUserID:"123",sNick:"嗷嗷嗷",gold:123,money:123,sHeadimg:""};t.$userData.portList.updatePorts(o.gates,o.nTotalGate),t.$userData.portList.updateStarNum(o.nTotalStar);var n=t.$userData.portList.getPort(1),i=t.$userData.gamePortVO=new t.GamePortVO;i.update(n),this.updatePlayer(o),t.$facade.addModule(t.ModuleID.menu)},o.prototype.updatePlayer=function(e){var o=t.$userData.playerVO=new t.PlayerVO;o.sID=e.nUserID,o.sNick=e.sNick,o.sHeadImg=e.sHeadimg,o.nGold=e.gold,o.nMoney=e.money,o.nTotalGate=e.nTotalGate,o.nTotalStar=e.nTotalStar;for(var n=o.toolList=[],i=o.toolMap=[],r=t.$singlon(t.GoodsCFG).getGoodList(),a=0,s=r;a<s.length;a++){var c=s[a],u=new t.ToolVO;u.id=c.id,n.push(u),i[u.id]=u}o.updateTool(e.goods)},__decorate([t.InterestMessage(gameMsg.EnumMsg.loginresponse)],o.prototype,"loginresponse",null),o}(t.ProxyBase);t.LoginProxy=e,__reflect(e.prototype,"game.LoginProxy")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.start=function(){this._list=[],this.requestOnce()},e.prototype.requestOnce=function(){if(this._list.length>0){var t=this._list.shift();t.call(this),egret.callLater(this.requestOnce,this)}},e}(t.Notifier);t.LoginRequests=e,__reflect(e.prototype,"game.LoginRequests")}(game||(game={}));var game;!function(t){var e=function(e){function o(){return e.call(this,"gameSkin.LoginSkin")||this}return __extends(o,e),o.prototype.createComponent=function(){},o.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.btn_login.on(egret.TouchEvent.TOUCH_TAP,this.onLoginClick,this)},o.prototype.onLoginClick=function(){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),this.dispatch(0,!0)},o.prototype._initView=function(){this.text_username.text=""},o}(t.FullWindowBase);t.LoginFullWindow=e,__reflect(e.prototype,"game.LoginFullWindow")}(game||(game={}));var game;!function(t){var e=function(){function e(){this._frames=[]}return Object.defineProperty(e.prototype,"speed",{get:function(){return this.data.speed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameCount",{get:function(){return this.data.subs.length},enumerable:!0,configurable:!0}),e.prototype.parse=function(){for(var e=new egret.SpriteSheet(this.texture),n=this.data.subs,i=0;i<n.length;i++){var r=i.toString(),a=n[i];e.createTexture(r,a.x,a.y,a.width,a.height);var s=t.recyclable(o);s.offsetX=a.ofx,s.offsetY=a.ofy,s.texture=e.getTexture(r),this._frames.push(s)}},e.prototype.getFrame=function(t){return this._frames[t]},e.prototype.clear=function(){this.data=void 0,this.texture=void 0,this._frames.forEach(function(t){t.recycle()}),this._frames.length=0},e}();t.AnimationData=e,__reflect(e.prototype,"game.AnimationData");var o=function(){function e(){}return e.prototype.onRecycle=function(){this.texture=void 0},e=__decorate([t.DeployPool(1e3)],e)}();t.FrameData=o,__reflect(o.prototype,"game.FrameData",["game.ICacheable"])}(game||(game={}));var game;!function(t){var e=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.onRegister=function(){this.useKey=0,e.prototype.onRegister.call(this),this.gameStart()},o.prototype.gameNext=function(e){this.useKey=0;var o=t.$userData.gamePortVO.playProId,n=t.$userData.portList.getPort(o+1),i=t.$userData.gamePortVO;i.update(n),i.playProId=o+1,this._view.gameover(),this.gameStart()},o.prototype.gameStart=function(){var e=t.$userData.gamePortVO;this._view.updateData(e),this.model.gamebegin(),this._view.starnum.text=t.$userData.portList.starNum},o.prototype.updateKey=function(){this._view.keynum.text=t.$userData.portList.keyNum},o.prototype.updateStar=function(){this._view.starnum.text=t.$userData.portList.starNum},o.prototype.addMood=function(e){var o=e.data;t.$userData.gamePortVO.GameMapVO.addMood(o),this.chechFillMap()&&(t.SoundManager.getInstance().PlaySound(t.SoundManager.mWinAudioUrl),this.model.gameend(),this._view.map_rect.visible=!0)},o.prototype.initPos=function(t){var e=t.data;e.initPos()},o.prototype.removeMood=function(e){var o=e.data;t.$userData.gamePortVO.GameMapVO.removeMood(o)},o.prototype.chechFillMap=function(){for(var e=t.$userData.gamePortVO.GameMapVO.map,o=e.data,n=0,i=o;n<i.length;n++)for(var r=i[n],a=0,s=r;a<s.length;a++){var c=s[a];if(3==c)return!1}return!0},o.prototype.beginMood=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl);var o=e.target;o.index=this._view.grp_mood.getChildIndex(o),this._view.grp_mood.setChildIndex(o,99);var n=this.getlattice(o.x,o.y);return n.y<=t.$userData.gamePortVO.GameMapVO.map.rowGrids&&n.x<=t.$userData.gamePortVO.GameMapVO.map.colGrids&&n.y>=0&&n.x>=0?void o.removemood():void 0},o.prototype.endMood=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mDropAudioUrl);var o=e.target,n=o.data,i=this.getlattice(o.x,o.y);if(i.y>t.$userData.gamePortVO.GameMapVO.map.rowGrids||i.x>t.$userData.gamePortVO.GameMapVO.map.colGrids||i.y<0||i.x<0)return void o.restart();if(n.col=i.x+1,n.row=i.y+1,this.chechPlace(n)){var r={x:n.col,y:n.row};return t.MapUtil.getPixel(r,o),o.x+=this._view.map.x,o.y+=this._view.map.y,o.modifymapdata(n),void o.rechindex()}return void o.restart()},o.prototype.rechildindex=function(t){var e=t.target;this._view.grp_mood.setChildIndex(e,e.index),e.index=null},o.prototype.getlattice=function(e,o){var n=e-this._view.map.x,i=o-this._view.map.y,r=new egret.Point(n,i),a=t.MapUtil.getGrid(r);return a},o.prototype.getOVPixel=function(e,o){var n=new egret.Point(e,o),i=t.MapUtil.getPixel(n);return i.x+=this._view.map.x,i.y+=this._view.map.y,i},o.prototype.chechPlace=function(e){for(var o=e.data,n=t.$userData.gamePortVO.GameMapVO.map.data,i=0;i<o.length;i++)for(var r=i+e.row-1,a=o[i],s=0;s<a.length;s++){var c=s+e.col-1,u=a[s];if(r>=t.$userData.gamePortVO.GameMapVO.map.rowGrids||c>=t.$userData.gamePortVO.GameMapVO.map.colGrids)return!1;if(1==u&&3!=n[r][c])return!1}return!0},o.prototype.removeKeymood=function(){for(var e=this._view.grp_mood.numChildren,o=t.$userData.gamePortVO.curPort.moodListVO.length,n=0;e-o>n;n++)this._view.grp_mood.removeChildAt(o-1)},o.prototype.clickMenu=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),this._view.grp_mood.removeChildren(),this._view.map.removeChildren(),t.$facade.addModule(t.ModuleID.menu)},o.prototype.clickRefresh=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),this.gameAgain()},o.prototype.clickKey=function(){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl);var e=parseInt(t.$userData.portList.keyNum);if(1>e)return void console.log("提示机会不足！");for(var o=t.$userData.gamePortVO.curPort,n=o.moodListVO,i=0,r=this.useKey;r<n.length;r++){var a=this._view.grp_mood.getChildAt(r),s=this.getOVPixel(n[r].col,n[r].row);if((a.data.col!=n[r].col||a.data.row!=n[r].row)&&(a.data.col<o.mapVO.colGrids&&a.data.row<o.mapVO.rowGrids&&a.data.col>0&&a.data.row>0&&(a.removemood(),a.restart()),0==i)){i=1;var c=this._view.refresh_keymood(n[r]);c.x=s.x,c.y=s.y,this._view.grp_mood.addChild(c),this.useKey=r+1}if(r==n.length-1&&0==i)return void console.log("已过关！")}e-=1,t.$userData.portList.updateKeyNum(e),this.model.userprompt()},o.prototype.gameAgain=function(){this._view.gameover();t.$userData.portList.getPort(t.$userData.gamePortVO.playProId);this.useKey=0;var e=t.$userData.gamePortVO;t.$userData.gamePortVO.GameMapVO.update(e.curPort.mapVO),this.gameStart()},__decorate([t.InjectProxy(5)],o.prototype,"model",void 0),__decorate([t.InterestNotify(15)],o.prototype,"gameNext",null),__decorate([t.InterestNotify(12)],o.prototype,"gameStart",null),__decorate([t.InterestNotify(16)],o.prototype,"updateKey",null),__decorate([t.InterestNotify(17)],o.prototype,"updateStar",null),__decorate([t.InterestEvent(1)],o.prototype,"addMood",null),__decorate([t.InterestEvent(9)],o.prototype,"initPos",null),__decorate([t.InterestEvent(2)],o.prototype,"removeMood",null),__decorate([t.InterestEvent(6)],o.prototype,"beginMood",null),__decorate([t.InterestEvent(7)],o.prototype,"endMood",null),__decorate([t.InterestEvent(11)],o.prototype,"rechildindex",null),__decorate([t.InterestEvent(10)],o.prototype,"removeKeymood",null),__decorate([t.InterestEvent(4)],o.prototype,"clickMenu",null),__decorate([t.InterestEvent(3)],o.prototype,"clickRefresh",null),__decorate([t.InterestEvent(8)],o.prototype,"clickKey",null),__decorate([t.InterestNotify(14)],o.prototype,"gameAgain",null),o}(t.MediatorBase);t.MainMediator=e,__reflect(e.prototype,"game.MainMediator")}(game||(game={}));var game;!function(t){var e=function(e){function o(){return e.call(this,5)||this}return __extends(o,e),o.prototype.gamebegin=function(){},o.prototype.playbeginresponse=function(e){var o=e.data;t.$userData.portList.updateKeyNum(o.response.nPrompt)},o.prototype.gameend=function(){this.playendresponse()},o.prototype.playendresponse=function(e){var o={response:{nTotalStar:+t.$userData.portList.starNum+3,nTopStar:3}};t.$userData.portList.updateStarNum(o.response.nTotalStar);var n=t.$userData.gamePortVO.playProId;t.$userData.portList.updatePort(n,o.response.nTopStar),t.$facade.addModule(t.ModuleID.win)},o.prototype.userprompt=function(){this._senderHttp.send_Use_Prompt()},o.prototype.usepromptresponse=function(t){t.data},__decorate([t.InterestMessage(gameMsg.EnumMsg.playbeginresponse)],o.prototype,"playbeginresponse",null),__decorate([t.InterestMessage(gameMsg.EnumMsg.playendresponse)],o.prototype,"playendresponse",null),__decorate([t.InterestMessage(gameMsg.EnumMsg.usepromptresponse)],o.prototype,"usepromptresponse",null),o}(t.ProxyBase);t.MainProxy=e,__reflect(e.prototype,"game.MainProxy")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){this.currentState=this.data},e}(eui.ItemRenderer);t.BorderItem=e,__reflect(e.prototype,"game.BorderItem")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.alpha=.3},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this)},e}(t.MoodBase);t.KeyMoodItem=e,__reflect(e.prototype,"game.KeyMoodItem")}(game||(game={}));var game;!function(t){var e=function(e){function o(){return e.call(this)||this}return __extends(o,e),o.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},o.prototype.dataChanged=function(){e.prototype.dataChanged.call(this);for(var t=this.data,o=t.data,n=0;n<o.length-1;n++)for(var i=o[n],r=0;r<i.length-1;r++){i[r];this.createBorder(n,r)}},o.prototype.createBorder=function(e,o){var n=t.MapBorderUtil.getBorderType(e,o);if(""!=n){var i=new t.BorderItem,r={x:o,y:e};t.MapBorderUtil.getMapBorderPixel(r,i),i.data=n,this.addChild(i)}},o}(t.MapBaseItem);t.MapMainItem=e,__reflect(e.prototype,"game.MapMainItem")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var t=e.call(this)||this;return t._isDown=!1,t}return __extends(o,e),o.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.on(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBeginHadler,this),this.on(egret.TouchEvent.TOUCH_END,this.onTouchEndHadler,this),this.on(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEndHadler,this),this.on(egret.TouchEvent.TOUCH_TAP,this.onTouchTapHadler,this)},o.prototype.initmapMood=function(t,e){this.startX=t,this.startY=e,this.scaleX=.6,this.scaleY=.6},o.prototype.dataChanged=function(){e.prototype.dataChanged.call(this)},o.prototype.onTouchTapHadler=function(t){this.dispatch(7,!0)},o.prototype.onTouchBeginHadler=function(e){this._isDown=!0;var o=new egret.Point(e.stageX,e.stageY);this.dispatch(6,!0,o),this._OffsetX=e.stageX-this.x,this._OffsetY=e.stageY-this.y,t.$stage.on(egret.TouchEvent.TOUCH_MOVE,this.onTouchMoveHadler,this),this.on(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),egret.Tween.get(this).to({scaleX:1,scaleY:1},50,egret.Ease.sineIn)},o.prototype.onTouchMoveHadler=function(t){this.x=t.stageX-this._OffsetX,this.y=t.stageY-this._OffsetY,this.dispatch(10,!0),this.off(egret.TouchEvent.TOUCH_TAP,this.onTouchTapHadler,this)},o.prototype.onTouchEndHadler=function(e){this._isDown&&(this._isDown=!1,t.$stage.off(egret.TouchEvent.TOUCH_MOVE,this.onTouchMoveHadler,this),this.dispatch(7,!0))},o.prototype.onTouchTap=function(){},o.prototype.removemood=function(){var t=this.data;this.dispatch(2,!0,t)},o.prototype.restart=function(){egret.Tween.get(this).to({x:this.startX,y:this.startY,scaleX:.6,scaleY:.6},500,egret.Ease.backInOut).call(this.rechindex,this);var t=this.data;this.dispatch(9,!0,t)},o.prototype.rechindex=function(){null!=this.index&&this.dispatch(11,!0)},o.prototype.modifymapdata=function(t){this.dispatch(1,!0,t)},o}(t.MoodBase);t.MapMoodItem=e,__reflect(e.prototype,"game.MapMoodItem")}(game||(game={}));var game;!function(t){var e=function(){function t(){this._initialized=!1,this._paused=!1,this._runningRate=1,this._lastTime=0}return Object.defineProperty(t.prototype,"paused",{get:function(){return this._paused},set:function(t){this._paused=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"runningRate",{get:function(){return this._runningRate},set:function(t){(0>t||isNaN(t))&&(t=0),this._runningRate=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){return this._lastTime},enumerable:!0,configurable:!0}),t.prototype.addClockClient=function(t){this._initialized||(this.initialize(),this._initialized=!0),t&&-1==this._clientList.indexOf(t)&&this._clientList.push(t)},t.prototype.initialize=function(){this._lastTime=egret.getTimer(),this._clientList=[],egret.startTick(this.update,this)},t.prototype.update=function(t){if(!this._paused){var e=t-this._lastTime;this._lastTime=t;var o=this._clientList.length;if(0!=o){e*=this._runningRate;for(var n=0,i=0;o>i;i++){var r=this._clientList[i];r&&(n!=i&&(this._clientList[n]=r,this._clientList[i]=void 0),r.update(e),n++)}if(n!=i){for(o=this._clientList.length;o>i;)this._clientList[n++]=this._clientList[i++];this._clientList.length=n}return!1}}},t.prototype.hasClockClient=function(t){return-1!=this._clientList.indexOf(t)},t.prototype.removeClockClient=function(t){var e=this._clientList.indexOf(t);-1!=e&&(this._clientList[e]=void 0)},t.prototype.clear=function(){this._clientList.length=0},t}();t.ClockManagerImpl=e,__reflect(e.prototype,"game.ClockManagerImpl",["game.IClockManager"])}(game||(game={}));var game;!function(t){var e;!function(t){function e(t){i.init(t)}function o(t){return i.getMoodInfo(t)}t.init=e,t.getMoodInfo=o;var n=function(){function t(){this._moodData={},this._mapData={}}return t.prototype.getMoodInfo=function(t){return this._moodData[t]},t.prototype.init=function(t){this._moodData=t.mood},t}();__reflect(n.prototype,"Impl");var i=new n}(e=t.ConfigManager||(t.ConfigManager={}))}(game||(game={}));var game;!function(t){var e=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.onRegister=function(){e.prototype.onRegister.call(this),this._view.updateAssets()},o.prototype.clickRank=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),this.dispatch(10,!0),t.$facade.addModule(t.ModuleID.rank)},o.prototype.clickStart=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),t.$facade.addModule(t.ModuleID.port)},o.prototype.clickFight=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),t.$facade.addModule(t.ModuleID.room)},o.prototype.clickcontinue=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),t.$facade.addModule(t.ModuleID.humor,void 0,2)},o.prototype.clickShop=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),t.$facade.addModule(t.ModuleID.shop)},o.prototype.toolUpdate=function(){this._view.updateAssets()},o.prototype.updateUserProperty=function(){this._view.updateAssets()},__decorate([t.InjectProxy(9)],o.prototype,"_model",void 0),__decorate([t.InterestEvent(2)],o.prototype,"clickRank",null),__decorate([t.InterestEvent(1)],o.prototype,"clickStart",null),__decorate([t.InterestEvent(3)],o.prototype,"clickFight",null),__decorate([t.InterestEvent(4)],o.prototype,"clickcontinue",null),__decorate([t.InterestEvent(5)],o.prototype,"clickShop",null),__decorate([t.InterestNotify(27)],o.prototype,"toolUpdate",null),__decorate([t.InterestNotify(29)],o.prototype,"updateUserProperty",null),o}(t.MediatorBase);t.MenuMediator=e,__reflect(e.prototype,"game.MenuMediator")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return t.call(this,9)||this}return __extends(e,t),e}(t.ProxyBase);t.MenuProxy=e,__reflect(e.prototype,"game.MenuProxy")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var o=e.call(this,"gameSkin.MenuSkin")||this;return t.SoundManager.getInstance(),o}return __extends(o,e),o.prototype.createComponent=function(){},o.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.btn_start.on(egret.TouchEvent.TOUCH_TAP,this.onStartClick,this),this.btn_rank.on(egret.TouchEvent.TOUCH_TAP,this.onRankClick,this),this.btn_fight.on(egret.TouchEvent.TOUCH_TAP,this.onFightClick,this),this.btn_continue.on(egret.TouchEvent.TOUCH_TAP,this.onContinueClick,this),this.btn_shop.on(egret.TouchEvent.TOUCH_TAP,this.onShopClick,this),this.updateAssets()
},o.prototype.onFightClick=function(t){this.dispatch(3,!0)},o.prototype.onContinueClick=function(t){this.dispatch(4,!0)},o.prototype.onStartClick=function(t){this.dispatch(1,!0)},o.prototype.onRankClick=function(t){this.dispatch(2,!0)},o.prototype.onShopClick=function(t){this.dispatch(5,!0)},o.prototype.updateAssets=function(){this.DiamondText.text="0",this.GoldText.text="0",void 0!==t.$userData.playerVO.nMoney&&(this.DiamondText.text=t.$userData.playerVO.nMoney.toString()),void 0!==t.$userData.playerVO.nGold&&(this.GoldText.text=t.$userData.playerVO.nGold.toString())},o}(t.FullWindowBase);t.MenuFullWindow=e,__reflect(e.prototype,"game.MenuFullWindow")}(game||(game={}));var game;!function(t){var e=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.onRegister=function(){e.prototype.onRegister.call(this)},o.prototype.setModuleData=function(t){console.log(t),this._view.msg_txt.text=t},o.prototype.clickSet=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),t.$facade.removeModule(t.ModuleID.msg)},__decorate([t.InterestEvent(2)],o.prototype,"clickSet",null),o}(t.MediatorBase);t.MsgMediator=e,__reflect(e.prototype,"game.MsgMediator")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return t.call(this,"gameSkin.msgSkin")||this}return __extends(e,t),e.prototype.createComponent=function(){},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.btn_close.on(egret.TouchEvent.TOUCH_TAP,this.onBackClick,this)},e.prototype.onBackClick=function(t){this.dispatch(2,!0)},e}(t.DialogBase);t.MsgDialog=e,__reflect(e.prototype,"game.MsgDialog")}(game||(game={}));var game;!function(t){var e=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.clickNext=function(e){t.$facade.removeModule(t.ModuleID.win);var o=t.$userData.gamePortVO.playProId;o<t.$userData.portList.portList.length&&t.$facade.dispatch(15)},__decorate([t.InterestEvent(2)],o.prototype,"clickNext",null),o}(t.MediatorBase);t.PkLoseMediator=e,__reflect(e.prototype,"game.PkLoseMediator")}(game||(game={}));var game;!function(t){var e=function(e){function o(){return e.call(this,"gameSkin.PkLoseSkin")||this}return __extends(o,e),o.prototype.createComponent=function(){},o.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.btn_leave.on(egret.TouchEvent.TOUCH_TAP,this.onLeaveClick,this),this.btn_again.on(egret.TouchEvent.TOUCH_TAP,this.onAgainClick,this)},o.prototype.onLeaveClick=function(t){this.dispatch(4,!0)},o.prototype.onAgainClick=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),this.dispatch(2,!0)},o}(t.FullWindowBase);t.PkLoseView=e,__reflect(e.prototype,"game.PkLoseView")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var o=e.call(this)||this;return o._playing=!1,o._autoStop=!0,o._resMgr=t.$singlon(t.MovieResMgr),o}return __extends(o,e),Object.defineProperty(o.prototype,"autoStop",{get:function(){return this._autoStop},set:function(t){this._autoStop=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"frameRate",{get:function(){return this._frameRate},set:function(t){this._frameRate!=t&&(this._frameRate=t)},enumerable:!0,configurable:!0}),o.prototype.setPath=function(t){this._url=t},o.prototype.play=function(t,e,o){void 0===t&&(t=1);for(var n=[],i=3;i<arguments.length;i++)n[i-3]=arguments[i];this._data&&(this._data.removeSelf(),this._data.stop(),this._data=void 0),this._res&&(this.stage&&this._res.subtractUsing(),this._res.off(egret.Event.COMPLETE,this.onLoaded,this),this._res.off(egret.Event.REMOVED,this.onDispose,this),this._res=void 0),this._times=t,this._completeHandler=e,this._thisObj=o,this._args=n,this._playing=!0,this.$play()},o.prototype.$play=function(){this._url&&(this._res=this._resMgr.getRes(this._url),this.stage&&this._res.addUsing(),2==this._res.status?this.onLoaded():(this._res.on(egret.Event.COMPLETE,this.onLoaded,this),this._res.on(egret.Event.REMOVED,this.onDispose,this),this._res.load()))},o.prototype.onLoaded=function(e){var o=this;this._data=this._res.data,this.addChild(this._data),this._playing&&(this._data.play(this._times),this._data.on(egret.Event.COMPLETE,function(){t.EffectManager.recycle(o);var e=o._completeHandler,n=o._thisObj,i=o._args;e&&e.call.apply(e,[n,o].concat(i))},this._thisObj))},o.prototype.onDispose=function(t){this._data&&(this._data.removeSelf(),this._data.stop(),this._data=void 0),this._res&&(this._res.off(egret.Event.COMPLETE,this.onLoaded,this),this._res.off(egret.Event.REMOVED,this.onDispose,this),this._res=void 0)},o.prototype.resume=function(){!this._playing&&this._data&&(this._playing=!0,this._data.play())},o.prototype.stop=function(){this._playing&&this._data&&(this._playing=!1,this._data.stop())},o.prototype.dispose=function(){this._data&&(this._data.removeSelf(),this._data.stop(),this._data=void 0),this._res&&(this.stage&&this._res.subtractUsing(),this._res.off(egret.Event.COMPLETE,this.onLoaded,this),this._res.off(egret.Event.REMOVED,this.onDispose,this),this._res=void 0),this._url=void 0,this._playing=!1,this._autoStop=!0},o}(egret.DisplayObjectContainer);t.EffectClip=e,__reflect(e.prototype,"game.EffectClip",["game.IDispose"])}(game||(game={}));var game;!function(t){var e=function(e){function o(){var o=null!==e&&e.apply(this,arguments)||this;return o._GamerInfo=t.$singlon(t.GamerInfoCFG),o}return __extends(o,e),o.prototype.onRegister=function(){e.prototype.onRegister.call(this),this.gameStart(),this._view.showGamerInfo()},o.prototype.clickMenu=function(){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl)},o.prototype.gameStart=function(){this._view.gameover();var e=t.$userData.gamePortVO;this._view.updateData(e)},o.prototype.addMood=function(e){this.changeMoodPosition(!0);var o=e.data;t.$userData.gamePortVO.GameMapVO.addMood(o),this.chechFillMap()&&(t.SoundManager.getInstance().PlaySound(t.SoundManager.mWinAudioUrl),this.endpkgame())},o.prototype.endpkgame=function(){this.model.reqEndGame()},o.prototype.initPos=function(t){var e=t.data;e.initPos()},o.prototype.removeMood=function(e){this.changeMoodPosition(!1);var o=e.data;t.$userData.gamePortVO.GameMapVO.removeMood(o)},o.prototype.chechFillMap=function(){for(var e=t.$userData.gamePortVO.GameMapVO.map,o=e.data,n=0,i=o;n<i.length;n++)for(var r=i[n],a=0,s=r;a<s.length;a++){var c=s[a];if(3==c)return!1}return!0},o.prototype.beginMood=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl);var o=e.target;o.index=this._view.grp_mood.getChildIndex(o),this._view.grp_mood.setChildIndex(o,97);var n=this.getlattice(o.x,o.y);return n.y<=t.$userData.gamePortVO.GameMapVO.map.rowGrids&&n.x<=t.$userData.gamePortVO.GameMapVO.map.colGrids&&n.y>=0&&n.x>=0?void o.removemood():void 0},o.prototype.endMood=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mDropAudioUrl);var o=e.target,n=o.data,i=this.getlattice(o.x,o.y);if(i.y>t.$userData.gamePortVO.GameMapVO.map.rowGrids||i.x>t.$userData.gamePortVO.GameMapVO.map.colGrids||i.y<0||i.x<0)return void o.restart();if(n.col=i.x+1,n.row=i.y+1,this.chechPlace(n)){var r={x:n.col,y:n.row};return t.MapUtil.getPixel(r,o),o.x+=this._view.map.x,o.y+=this._view.map.y,o.modifymapdata(n),void o.rechindex()}return void o.restart()},o.prototype.rechildindex=function(t){var e=t.target;this._view.grp_mood.setChildIndex(e,e.index),e.index=null},o.prototype.getlattice=function(e,o){var n=e-this._view.map.x,i=o-this._view.map.y,r=new egret.Point(n,i),a=t.MapUtil.getGrid(r);return a},o.prototype.getOVPixel=function(e,o){var n=new egret.Point(e,o),i=t.MapUtil.getPixel(n);return i.x+=this._view.map.x,i.y+=this._view.map.y,i},o.prototype.chechPlace=function(e){for(var o=e.data,n=t.$userData.gamePortVO.GameMapVO.map.data,i=0;i<o.length;i++)for(var r=i+e.row-1,a=o[i],s=0;s<a.length;s++){var c=s+e.col-1,u=a[s];if(r>=t.$userData.gamePortVO.GameMapVO.map.rowGrids||c>=t.$userData.gamePortVO.GameMapVO.map.colGrids)return!1;if(1==u&&3!=n[r][c])return!1}return!0},o.prototype.clickRefresh=function(){var e=this._GamerInfo.RandomNumBoth(0,50),o=t.$userData.portPKList.getPort(e),n=t.$userData.gamePortVO=new t.GamePortVO;n.update(o);var i=t.$userData.gamePortVO;this._view.updateData(i)},o.prototype.clickKey=function(){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),console.log("点击提示")},o.prototype.updatePKTime=function(){var e=t.$userData.pkRoomVO.timeTick,o=e.toString();this._view.timebar.text=o,10>=e&&this._view.timePrompt()},o.prototype.useMinusTimeTool=function(){if("0"===this._view.reduceTime_Num.text)return void t.$facade.addModule(t.ModuleID.msg,void 0,"道具不足");t.$userData.pkRoomVO.opponentID;this.model.reqUseTool(1),t.SoundManager.getInstance().PlaySound(t.SoundManager.mShorterAudioUrl)},o.prototype.updateGameSituation=function(){var t=this.model.Msg;this._view.gamerSituation_label.text=t;var e=this.model.sDID;this._view.updateGamerPercent(e,!1,"animation")},o.prototype.clickAddTimeTool=function(){return"0"===this._view.addTime_Num.text?void t.$facade.addModule(t.ModuleID.msg,void 0,"道具不足"):(t.$userData.pkRoomVO.opponentID=t.$userData.account.userid.toString(),this.model.reqUseTool(0),void(t.$userData.pkRoomVO.toolID=0))},o.prototype.toolUpdate=function(){this._view.updateToolNum()},o.prototype.changeMoodPosition=function(t){t?(console.log("添加木块"),this.model.reqPlayBlockAdd()):(console.log("减少木块"),this.model.reqPlayBlockDelete())},o.prototype.moveMoodPosition=function(){var t=this.model.sID,e=this.model.playBlockIsAdd;this._view.updateGamerPercent(t,e,"percent")},__decorate([t.InjectProxy(7)],o.prototype,"model",void 0),__decorate([t.InterestEvent(4)],o.prototype,"clickMenu",null),__decorate([t.InterestEvent(1)],o.prototype,"addMood",null),__decorate([t.InterestEvent(12)],o.prototype,"endpkgame",null),__decorate([t.InterestEvent(9)],o.prototype,"initPos",null),__decorate([t.InterestEvent(2)],o.prototype,"removeMood",null),__decorate([t.InterestEvent(6)],o.prototype,"beginMood",null),__decorate([t.InterestEvent(7)],o.prototype,"endMood",null),__decorate([t.InterestEvent(11)],o.prototype,"rechildindex",null),__decorate([t.InterestEvent(3)],o.prototype,"clickRefresh",null),__decorate([t.InterestEvent(8)],o.prototype,"clickKey",null),__decorate([t.InterestNotify(20)],o.prototype,"updatePKTime",null),__decorate([t.InterestNotify(23)],o.prototype,"useMinusTimeTool",null),__decorate([t.InterestNotify(24)],o.prototype,"updateGameSituation",null),__decorate([t.InterestEvent(13)],o.prototype,"clickAddTimeTool",null),__decorate([t.InterestNotify(27)],o.prototype,"toolUpdate",null),__decorate([t.InterestNotify(30)],o.prototype,"moveMoodPosition",null),o}(t.MediatorBase);t.PKMainMediator=e,__reflect(e.prototype,"game.PKMainMediator")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var o=e.call(this,7)||this;return o.roomId=t.getItem("roomId"),o.Msg="",o}return __extends(o,e),o.prototype.pkgamebegin=function(){},o.prototype.userprompt=function(){this._senderHttp.send_Use_Prompt()},o.prototype.usepromptresponse=function(t){t.data},o.prototype.reqEndGame=function(){var e=t.getItem("roomId");console.log(e),this._sender.send_EndGame(t.$userData.pkRoomVO.id)},o.prototype.endgameresponse=function(e){var o=e.data;console.log("游戏结束 响应");var n={type:1,Info:o.endGameResponse.nRank};t.$facade.removeModule(t.ModuleID.pkmain),t.$facade.addModule(t.ModuleID.pkwin,void 0,n)},o.prototype.overtimenotify=function(e){var o=e.data;console.log("游戏超时 通知");var n={type:1,Info:o.overTimeNotify.nRank};t.$facade.removeModule(t.ModuleID.pkmain),t.$facade.addModule(t.ModuleID.pkwin,void 0,n)},o.prototype.gametimeticknotify=function(e){var o=e.data,n=o.gameTimeTickNotify.nLeft;t.$userData.pkRoomVO.updataTimeTick(n),console.log("时钟启动"+n)},o.prototype.reqUseTool=function(t){this._sender.send_UseTool(t)},o.prototype.usetoolnotify=function(e){for(var o=e.data,n=o.useToolNotify.sID,i=o.useToolNotify.goodID,r=o.useToolNotify.sDID,a=t.$userData.pkRoomVO.gamerList,s="",c="",u=t.$singlon(t.GoodsCFG),p=u.getGoodCFG(i),l=p.desc,h=a.length,d=0;h>d;d++)a[d].sID===n&&(s=a[d].sNick+n),a[d].sID===r&&(c=a[d].sNick+r);r===n?this.Msg=c+"使用了"+l+"道具":(t.$userData.account.userid===n&&(s="我"),t.$userData.account.userid===r&&(c="我"),console.log(s+"对"+c+"使用了"+l+"道具"),this.Msg=s+"对"+c+"使用了"+l+"道具"),this.sDID=r,t.$facade.dispatch(24)},o.prototype.usetoolresponse=function(e){e.data;this.Msg="使用道具成功";var o=t.$userData.playerVO.toolMap[t.$userData.pkRoomVO.toolID].count-1;o=o>=0?o:0;var n=new t.ToolVO;n.id=t.$userData.pkRoomVO.toolID,n.count=o,t.$userData.playerVO.updateOneTool(n),this.sDID=t.$userData.pkRoomVO.opponentID,t.$facade.dispatch(24)},o.prototype.reqPlayBlockAdd=function(){var e=t.$userData.pkRoomVO.playProtPKId;this._sender.send_AddBlock(e)},o.prototype.playblockaddresponse=function(e){this.sID=t.$userData.playerVO.sID,this.playBlockIsAdd=!0,t.$facade.dispatch(30)},o.prototype.reqPlayBlockDelete=function(){var e=t.$userData.pkRoomVO.playProtPKId;this._sender.send_DeleteBlock(e)},o.prototype.playblockdeleteresponse=function(e){this.sID=t.$userData.playerVO.sID,this.playBlockIsAdd=!1,t.$facade.dispatch(30)},o.prototype.playblockdeletenotify=function(e){var o=e.data;o.playBlockNotify.sRoomID;this.sID=o.playBlockNotify.sID,this.playBlockIsAdd=o.playBlockNotify.isAdd,t.$facade.dispatch(30)},__decorate([t.InterestMessage(gameMsg.EnumMsg.usepromptresponse)],o.prototype,"usepromptresponse",null),__decorate([t.InterestMessage(gameMsg.EnumMsg.endgameresponse)],o.prototype,"endgameresponse",null),__decorate([t.InterestMessage(gameMsg.EnumMsg.overtimenotify)],o.prototype,"overtimenotify",null),__decorate([t.InterestMessage(gameMsg.EnumMsg.gametimeticknotify)],o.prototype,"gametimeticknotify",null),__decorate([t.InterestMessage(gameMsg.EnumMsg.usetoolnotify)],o.prototype,"usetoolnotify",null),__decorate([t.InterestMessage(gameMsg.EnumMsg.usetoolresponse)],o.prototype,"usetoolresponse",null),__decorate([t.InterestMessage(gameMsg.EnumMsg.playblockaddresponse)],o.prototype,"playblockaddresponse",null),__decorate([t.InterestMessage(gameMsg.EnumMsg.playblockdeleteresponse)],o.prototype,"playblockdeleteresponse",null),__decorate([t.InterestMessage(gameMsg.EnumMsg.playblocknotify)],o.prototype,"playblockdeletenotify",null),o}(t.ProxyBase);t.PkMainproxy=e,__reflect(e.prototype,"game.PkMainproxy")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var o=e.call(this,"gameSkin.PKMainSkin")||this;return o._grptimerbarW=0,o._GamerInfo=t.$singlon(t.GamerInfoCFG),o._listData=new eui.ArrayCollection,o.btn_tool_addtime.on(egret.TouchEvent.TOUCH_TAP,o.onAddTimeClick,o),o.btn_tool_other.on(egret.TouchEvent.TOUCH_TAP,o.onDeleteTimeClick,o),o}return __extends(o,e),o.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.gamer_list.dataProvider=this._listData,this.gamer_list.itemRenderer=t.GamerInfo},o.prototype.init=function(){},o.prototype.update=function(t){this._listData.source=t,this._listData.refresh()},o.prototype.onMenuClick=function(){console.log("clickmenu"),this.dispatch(4,!0)},o.prototype.onRefreshClick=function(){console.log("clickre"),this.dispatch(3,!0)},o.prototype.onKeyClick=function(){console.log("clickkey"),this.dispatch(8,!0)},o.prototype.timerbarstar=function(){},o.prototype.timerRun=function(t){},o.prototype.onAddTimeClick=function(){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),this.dispatch(13,!0)},o.prototype.onDeleteTimeClick=function(){t.$facade.addModule(t.ModuleID.tool)},o.prototype.showGamerInfo=function(){this.gamerSituation_label.text="";var e=t.$userData.pkRoomVO.gamerList;this.update(e),this.updateToolNum(),this.showPercent()},o.prototype.updateToolNum=function(){this.addTime_Num.text=t.$userData.playerVO.toolMap[0].count.toString(),this.reduceTime_Num.text=t.$userData.playerVO.toolMap[1].count.toString()},o.prototype.showPercent=function(){var e=t.$userData.pkRoomVO.gamerList,o=[];for(var n in e){var i={sNick:e[n].sNick,sID:e[n].sID,sHeadImg:e[n].sHeadImg,nRankLevel:e[n].nRankLevel,percent:0,animation:!1};o.push(i)}this.update(o)},o.prototype.updateGamerPercent=function(e,o,n){for(var i=(this._listData,[]),r=0,a=this._listData.source;r<a.length;r++){var s=a[r];"percent"===n&&s.sID===e&&(o?s.percent=s.percent+1>=t.$userData.pkRoomVO.playProtMoodNum?t.$userData.pkRoomVO.playProtMoodNum:s.percent+1:s.percent=s.percent-1<=0?0:s.percent-1,s.animation=!1),"animation"===n&&s.sID===e&&(s.animation=!0);var c=s;i.push(c)}this.update(i)},o.prototype.timePrompt=function(){var e=egret.Tween.get(this.timebar,{loop:!1});e.to({scaleX:2,scaleY:2},300).call(function(){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClockAudioUrl)}).wait(400).to({scaleX:1,scaleY:1},100).wait(200)},o.prototype.showToolEffect=function(){this.animationGroup.visible=!0,this.animationGroup.scaleY=1.9,this.animationGroup.scaleX=1.4,t.SoundManager.getInstance().PlaySound(t.SoundManager.mBlastingAudioUrl),t.EffectManager.play("blast",this.animationGroup,0,0,1,60,this.clearToolEffect,this)},o.prototype.clearToolEffect=function(){this.animationGroup.visible=!1},o}(t.MainFullWindow);t.PKMainFullWindow=e,__reflect(e.prototype,"game.PKMainFullWindow",["game.IModuleView"])}(game||(game={}));var game;!function(t){var e=function(e){function o(){var t=e.call(this)||this;return t.shape=new egret.Shape,t.angle=0,t.percentLabel=new eui.Label,t}return __extends(o,e),o.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.drawMask(this.headImg_bg,this.headImg),this.addChild(this.shape),this.percentLabel.width=90,this.percentLabel.height=90,this.percentLabel.textColor=16777215,this.percentLabel.size=25,this.percentLabel.textAlign="center",this.percentLabel.verticalAlign="middle",this.addChild(this.percentLabel),this.animationGroup.x=0,this.animationGroup.y=0,this.animationGroup.scaleX=.6,this.animationGroup.scaleY=.6},o.prototype.dataChanged=function(){var e=this.data;if(void 0!==e.percent){var o=(parseInt(e.percent)/t.$userData.pkRoomVO.playProtMoodNum*100).toFixed(0),n=e.percent/t.$userData.pkRoomVO.playProtMoodNum*360;this.changeGraphics(n),console.log("dataChanged"),o="100"===o?"已完成":o+"%",this.percentLabel.text=o}if(e.animation&&this.showAnimation(),this.gamer_name.text=e.sNick,e.sHeadImg.length>=2)this.headImg.source=e.sHeadImg;else{var i="resource/assets/ai"+("/img_head_t_"+e.sHeadImg+"_v_"+e.sID+".png");this.getHeadImg(i,e.sID)}},o.prototype.drawMask=function(t,e){var o=new egret.Shape;o.graphics.beginFill(255),o.graphics.drawCircle(45,45,45),o.graphics.endFill(),this.addChild(o),t.mask=o;var n=new egret.Shape;n.graphics.beginFill(255),n.graphics.drawCircle(45,44,40),n.graphics.endFill(),this.addChild(n),e.mask=n},o.prototype.changeGraphics=function(t){this.shape.graphics.clear(),this.shape.graphics.beginFill(16711680,.3),this.shape.graphics.moveTo(45,45),this.shape.graphics.lineTo(90,45),this.shape.graphics.drawArc(45,45,45,0,t*Math.PI/180,!1),this.shape.graphics.lineTo(45,45),this.shape.graphics.endFill()},o.prototype.getHeadImg=function(e,o){var n=this,i=new egret.ImageLoader;i.crossOrigin="anonymous",i.load(e),i.once(egret.Event.COMPLETE,function(i){if(i.currentTarget.data){n.headImg.source=e;var r=t.$userData.pkRoomVO.getGamer(o);r.sHeadImg=e,t.$userData.pkRoomVO.getGamer(o).update(r)}},this),i.once(egret.IOErrorEvent.IO_ERROR,function(t){var e="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erb9KD8YAjeDxh2z5yMaVxxtHEaPkkKTfRrDCU1UWbE0RrfE64aHiclZAtB2OkoFWSYBiaymbNpc5aQ/132";n.headImg.source=e},this)},o.prototype.showAnimation=function(){t.SoundManager.getInstance().PlaySound(t.SoundManager.mSmogAudioUrl),t.EffectManager.play("smog",this.animationGroup,0,0,1,60)},o}(eui.ItemRenderer);t.GamerInfo=e,__reflect(e.prototype,"game.GamerInfo")}(game||(game={}));var game;!function(t){var e;!function(e){function o(t,e,o,n,i,r,s,c){void 0===o&&(o=0),void 0===n&&(n=0),void 0===i&&(i=1),void 0===r&&(r=12);for(var u=[],p=8;p<arguments.length;p++)u[p-8]=arguments[p];return a.play.apply(a,[t,e,o,n,i,r,s,c].concat(u))}function n(t){a.clear(t)}function i(t){a.recycle(t)}e.play=o,e.clear=n,e.recycle=i;var r=function(){function e(){}return e.prototype.play=function(e,o,n,i,r,a,s,c){for(var u=[],p=8;p<arguments.length;p++)u[p-8]=arguments[p];var l=t.recyclable(t.EffectClip);return l.x=n,l.y=i,l.frameRate=a,l.setPath(e),l.play.apply(l,[r,s,c].concat(u)),o.addChild(l),l},e.prototype.clear=function(e){for(var o=0;o<e.numChildren;o++){var n=e.getChildAt(o);n instanceof t.EffectClip&&(this.recycle(n),o--)}},e.prototype.recycle=function(t){t.removeSelf(),t.dispose(),t.recycle()},e}();__reflect(r.prototype,"Impl");var a=new r}(e=t.EffectManager||(t.EffectManager={}))}(game||(game={}));var game;!function(t){var e=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.balanceInfo={},t}return __extends(o,e),o.prototype.onRegister=function(){e.prototype.onRegister.call(this),this._view._initView()},o.prototype.setModuleData=function(t){console.log(t),1===t.type?this.showPersonInfo(t):this.showBalanceInfo(t)},o.prototype.showPersonInfo=function(t){console.log(t),this._view.analysisInfo(t)},o.prototype.showBalanceInfo=function(e){for(var o=[],n=0,i=0;i<e.length;i++){var r=t.$userData.pkRoomVO.getGamer(e[i].sGamerID);if(void 0===r)return;var a={sHeadImg:r.sHeadImg,sNick:r.sNick,time:e[i].nTime,gold:e[i].nGold,nRank:e[i].nRank,nLevel:e[i].nLevel,sID:e[i].sGamerID};o.push(a),r.sID===t.$userData.account.userid.toString()&&(n=e[i].nGold)}var s=void 0===t.$userData.playerVO.nGold?0:t.$userData.playerVO.nGold;t.$userData.playerVO.nGold=s+n,t.$facade.dispatch(29),console.log(o);var c=this.orderby(o,function(t){return t.nRank});this._view.analysisBalanceData(c)},o.prototype.clickNext=function(e){t.$facade.removeModule(t.ModuleID.pkwin),t.$facade.addModule(t.ModuleID.room,void 0,"wait")},o.prototype.clickExit=function(t){this.model.reqLeaveRoom()},o.prototype.clickSeeRank=function(e){this.showBalanceInfo(this.model.balanceInfo),this._view.group_pklevel.visible=!0,this._view.group_pkNRank.visible=!1,this._view.btn_lookRank.visible=!1,t.SoundManager.getInstance().stopPKMusic(),t.SoundManager.getInstance().playBgMusic()},o.prototype.pkGameStart=function(){t.$facade.removeModule(t.ModuleID.pkwin),t.$facade.addModule(t.ModuleID.pkmain)},o.prototype.pkGameEnd=function(){this._view.group_countDown.visible=!1,this._view.btn_lookRank.visible=!0},o.prototype.orderby=function(t,e){if(t.length<=1)return t;for(var o=Math.floor(t.length/2),n=t.splice(o,1)[0],i=[],r=[],a=0,s=t;a<s.length;a++){var c=s[a];e(c)<e(n)?i.push(c):r.push(c)}return this.orderby(i,e).concat([n],this.orderby(r,e))},o.prototype.updatePKTime=function(){var e=this,o=t.$userData.pkRoomVO.timeTick,n=o.toString();"1"===n&&setTimeout(function(){e._view.countDown_txt.text="有人使用加时道具，还需等待",e._view.countDown_num.text=""},2e3),this._view.countDown_num.text=n},__decorate([t.InjectProxy(8)],o.prototype,"model",void 0),__decorate([t.InterestEvent(1)],o.prototype,"clickNext",null),__decorate([t.InterestEvent(0)],o.prototype,"clickExit",null),__decorate([t.InterestEvent(2)],o.prototype,"clickSeeRank",null),__decorate([t.InterestNotify(18)],o.prototype,"pkGameStart",null),__decorate([t.InterestNotify(19)],o.prototype,"pkGameEnd",null),__decorate([t.InterestNotify(20)],o.prototype,"updatePKTime",null),o}(t.MediatorBase);t.PKWinMediator=e,__reflect(e.prototype,"game.PKWinMediator")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var t=e.call(this,8)||this;return t.balanceInfo=[],t}return __extends(o,e),o.prototype.reqStarGame=function(){var e=t.$userData.pkRoomVO.id;this._sender.send_StarPkGame(e)},o.prototype.endgamenotify=function(e){var o=e.data.endGameNotify;this.balanceInfo=o.rankEndGameDatas,t.$facade.dispatch(19)},o.prototype.reqLeaveRoom=function(){console.log("离开房间"),this._sender.send_LeaveRoom(t.$userData.pkRoomVO.id)},__decorate([t.InterestMessage(gameMsg.EnumMsg.endgamenotify)],o.prototype,"endgamenotify",null),o}(t.ProxyBase);t.PKWinproxy=e,__reflect(e.prototype,"game.PKWinproxy")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var t=e.call(this,"gameSkin.PKWinSkin")||this;return t._listData=new eui.ArrayCollection,t}return __extends(o,e),o.prototype.createComponent=function(){},o.prototype._initView=function(){this.group_pkNRank.visible=!1,this.group_pklevel.visible=!1,this.group_countDown.visible=!0},o.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.balance_rank.dataProvider=this._listData,this.balance_rank.itemRenderer=t.PKRankItem,this.btn_leave.on(egret.TouchEvent.TOUCH_TAP,this.onLeaveClick,this),this.btn_more.on(egret.TouchEvent.TOUCH_TAP,this.onMoreClick,this),this.btn_lookRank.on(egret.TouchEvent.TOUCH_TAP,this.onSeeRankClick,this)},o.prototype.onLeaveClick=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),this.dispatch(0,!0)},o.prototype.onMoreClick=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),this.dispatch(1,!0)},o.prototype.onSeeRankClick=function(){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),this.dispatch(2,!0)},o.prototype.analysisBalanceData=function(t){this.group_pklevel.visible=!0,this.group_pkNRank.visible=!1,this.updateBalanceRankData(t)},o.prototype.analysisInfo=function(e){this.group_pklevel.visible=!1,this.group_pkNRank.visible=!0,this.btn_headImg.source=t.$userData.account.avatarUrl,this.btn_gold.text="第     名",this.btn_gold1.text=e.Info,this.countDown_txt.text="倒计时：";var o=t.$userData.account.userid.toString(),n=t.$userData.pkRoomVO.getGamer(o);this.gamerInfo.data=n},o.prototype.updateBalanceRankData=function(t){this._listData.source=t,this._listData.refresh()},o}(t.FullWindowBase);t.PKWinFullWindow=e,__reflect(e.prototype,"game.PKWinFullWindow")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){var t=this.data;this.gamerInfo.data=t,this.txt_gold.text=t.gold,this.txt_nRank.text=t.nRank,this.txt_time.text=t.time,this.txt_nLevel.text=t.nLevel},e}(eui.ItemRenderer);t.PKRankItem=e,__reflect(e.prototype,"game.PKRankItem")}(game||(game={}));var game;!function(t){var e=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.onRegister=function(){e.prototype.onRegister.call(this),this._view.update(t.$userData.portList.portList),this._view.bml_starNum.text=t.$userData.portList.starNum},o.prototype.clickSet=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),t.$facade.addModule(t.ModuleID.menu)},o.prototype.clickStart=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl);var o=e.data;this.gmStart(o)},o.prototype.clickExit=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),t.$facade.addModule(t.ModuleID.menu)},o.prototype.gmStart=function(e){var o=t.$userData.portList.getPort(e),n=t.$userData.gamePortVO=new t.GamePortVO;n.update(o),n.playProId=e,t.$facade.addModule(t.ModuleID.main)},o.prototype.updatePortSart=function(e){t.$facade.addModule(t.ModuleID.main)},__decorate([t.InjectProxy(2)],o.prototype,"model",void 0),__decorate([t.InterestEvent(2)],o.prototype,"clickSet",null),__decorate([t.InterestEvent(1)],o.prototype,"clickStart",null),__decorate([t.InterestEvent(4)],o.prototype,"clickExit",null),__decorate([t.InterestNotify(11)],o.prototype,"updatePortSart",null),o}(t.MediatorBase);t.PortMediator=e,__reflect(e.prototype,"game.PortMediator")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return t.call(this,2)||this}return __extends(e,t),e}(t.ProxyBase);t.PortProxy=e,__reflect(e.prototype,"game.PortProxy")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var t=e.call(this,"gameSkin.PortSkin")||this;return t._listData=new eui.ArrayCollection,t}return __extends(o,e),o.prototype.createComponent=function(){},o.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.list_port.dataProvider=this._listData,this.list_port.itemRenderer=t.PortBtnItem,this.btn_back.on(egret.TouchEvent.TOUCH_TAP,this.onBackClick,this),this.btn_exit.on(egret.TouchEvent.TOUCH_TAP,this.onExitClick,this)},o.prototype.onBackClick=function(t){this.dispatch(2,!0)},o.prototype.onExitClick=function(t){this.dispatch(4,!0)},o.prototype.update=function(t){this._listData.source=t,this._listData.refresh()},o}(t.FullWindowBase);t.PortFullWindow=e,__reflect(e.prototype,"game.PortFullWindow")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var t=e.call(this)||this;return t._listData=new eui.ArrayCollection,t}return __extends(o,e),o.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.btn_start.on(egret.TouchEvent.TOUCH_TAP,this.onStartClick,this),this.list_star.dataProvider=this._listData,this.list_star.itemRenderer=t.StarsItem},o.prototype.onStartClick=function(t){this.dispatch(1,!0,this.data.id)},o.prototype.dataChanged=function(){var t=this.data;t.state;this.bml_num.text=""+t.id,this.bml_num2.text=""+t.id,this.updateState(t.state),this.updateStartNum(t.starNum)},o.prototype.updateState=function(t){switch(t){case 0:this.currentState="lock";break;case 1:this.currentState="unlocked"}},o.prototype.updateStartNum=function(t){for(var e=[],o=1;3>=o;o++)t>=o?e.push(0):e.push(1);this.updateStar(e)},o.prototype.updateStar=function(t){this._listData.source=t,this._listData.refresh()},o}(eui.ItemRenderer);t.PortBtnItem=e,__reflect(e.prototype,"game.PortBtnItem")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){var t=this.data;switch(t){case 0:this.currentState="owen";break;case 1:this.currentState="unowen"}},e}(eui.ItemRenderer);t.StarsItem=e,__reflect(e.prototype,"game.StarsItem")}(game||(game={}));var game;!function(t){var e=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.onRegister=function(){e.prototype.onRegister.call(this),this.sendRankReq()},o.prototype.click=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),this._view.goOne.play(0),setTimeout(function(){t.$facade.removeModule(t.ModuleID.rank)},250)},o.prototype.sendRankReq=function(){this.model.reqRank()},o.prototype.rankUpdate=function(){var t=this.model.getDataArr();this._view.visible=!0,this._view.comOne.play(0),this._view.refreshList(t)},__decorate([t.InjectProxy(4)],o.prototype,"model",void 0),__decorate([t.InterestEvent(0)],o.prototype,"click",null),__decorate([t.InterestNotify(13)],o.prototype,"rankUpdate",null),o}(t.MediatorBase);t.RankMediator=e,__reflect(e.prototype,"game.RankMediator")}(game||(game={}));var game;!function(t){var e=function(e){function o(){return e.call(this,4)||this}return __extends(o,e),o.prototype.reqRank=function(){this._senderHttp.send_Rank()},o.prototype.rankresponse=function(e){var o=e.data,n=o.response.rankDatas;this._dataArr=n,t.$facade.dispatch(13)},o.prototype.getDataArr=function(){return this._dataArr},__decorate([t.InterestMessage(gameMsg.EnumMsg.rankresponse)],o.prototype,"rankresponse",null),o}(t.ProxyBase);t.RankProxy=e,__reflect(e.prototype,"game.RankProxy")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var t=e.call(this,"gameSkin.RankSkin")||this;return t._listData=new eui.ArrayCollection,t}return __extends(o,e),o.prototype.createComponent=function(){},o.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.btn_close.on(egret.TouchEvent.TOUCH_TAP,this.onCloseClick,this),this.list_rank.dataProvider=this._listData,this.list_rank.itemRenderer=t.RankItem
},o.prototype.refreshList=function(t){this._listData.source=t,this._listData.refresh()},o.prototype.onCloseClick=function(t){this.dispatch(0,!0)},o}(t.DialogBase);t.RankDialog=e,__reflect(e.prototype,"game.RankDialog")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){var t=this,e=t.data;t.txt_rank.text=e.nRank+1,t.txt_starNum.text=e.starNum},e}(eui.ItemRenderer);t.RankItem=e,__reflect(e.prototype,"game.RankItem")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var o=null!==e&&e.apply(this,arguments)||this;return o._GamerInfo=t.$singlon(t.GamerInfoCFG),o}return __extends(o,e),o.prototype.onRegister=function(){e.prototype.onRegister.call(this),this._view._initView()},o.prototype.setModuleData=function(t){console.log(t),"wait"===t&&(this.updateGamerInfo(),this._view.group_wait.visible=!0,this._view.group_create_room.visible=!1)},o.prototype.onBackClick=function(t){this._model.reqLeaveRoom()},o.prototype.clickStart=function(t){this._model.reqStarGame()},o.prototype.clickInvite=function(e){this._view.show_roomID.text=t.$userData.pkRoomVO.id},o.prototype.clickCreateRoom=function(t){this.createRoom()},o.prototype.createRoom=function(){this._view.btn_return.visible=!0,this._model.reqCreateRoom()},o.prototype.clickMatching=function(t){this.MatchingRoom()},o.prototype.MatchingRoom=function(){this._model.reqMatchGame()},o.prototype.updateRoom=function(){this._view.showWait(),this.updateGamerInfo()},o.prototype.createroom=function(){t.$userData.account.userid.toString()===t.$userData.pkRoomVO.bossID&&(this._view.btn_return.visible=!0,this._view.btn_strGame.visible=!0),this._view.group_invite.visible=!0,this._view.group_create.visible=!1,this.updateGamerInfo()},o.prototype.updateGamerInfo=function(){var e=[];e=t.$userData.pkRoomVO.gamerList,this._view.updateGamer(e),1===t.$userData.pkRoomVO.gamerList.length&&(this._view.btn_strGame.currentState="disabled")},o.prototype.pkGameStart=function(){var e=t.$userData.pkRoomVO.playProtPKId,o=t.$userData.portList.getPort(e),n=t.$userData.gamePortVO=new t.GamePortVO;n.update(o),n.playProId=e,t.$userData.pkRoomVO.playProtMoodNum=n.curPort.moodListVO.length,t.$facade.removeModule(t.ModuleID.room),t.$facade.addModule(t.ModuleID.pkmain)},o.prototype.clickJionRoom=function(t){var e=this._view.text_roomID.text;this._model.reqJoinRoom(e)},o.prototype.clickStarGame=function(e){this._model.reqStarGame(),t.SoundManager.getInstance().playPKMusic(),t.SoundManager.getInstance().stopBgMusic()},o.prototype.updateGamer=function(){this.updateGamerInfo()},o.prototype.toolUpdate=function(){this._view.updateTool()},__decorate([t.InjectProxy(6)],o.prototype,"_model",void 0),__decorate([t.InterestEvent(2)],o.prototype,"onBackClick",null),__decorate([t.InterestEvent(1)],o.prototype,"clickStart",null),__decorate([t.InterestEvent(3)],o.prototype,"clickInvite",null),__decorate([t.InterestEvent(4)],o.prototype,"clickCreateRoom",null),__decorate([t.InterestEvent(5)],o.prototype,"clickMatching",null),__decorate([t.InterestNotify(21)],o.prototype,"updateRoom",null),__decorate([t.InterestNotify(25)],o.prototype,"createroom",null),__decorate([t.InterestNotify(18)],o.prototype,"pkGameStart",null),__decorate([t.InterestEvent(6)],o.prototype,"clickJionRoom",null),__decorate([t.InterestEvent(7)],o.prototype,"clickStarGame",null),__decorate([t.InterestNotify(22)],o.prototype,"updateGamer",null),__decorate([t.InterestNotify(27)],o.prototype,"toolUpdate",null),o}(t.MediatorBase);t.RoomMediator=e,__reflect(e.prototype,"game.RoomMediator")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var o=e.call(this,6)||this;return o._GamerInfo=t.$singlon(t.GamerInfoCFG),o}return __extends(o,e),o.prototype.reqCreateRoom=function(){this._sender.send_CreateRoom()},o.prototype.createroomresponse=function(e){var o=e.data,n=new t.GamerVO;n.sID=t.$userData.account.userid.toString(),n.sHeadImg=t.GlobalInfo.userinfo.avatarUrl,n.sNick=t.GlobalInfo.userinfo.nickName,n.nRankLevel=0;var i=t.$userData.pkRoomVO=new t.RoomVO;i.id=o.createRoomResponse.sRoomID,i.bossID=t.$userData.account.userid.toString(),i.gamerList=[],i.updateOneGamer(n),t.$facade.dispatch(25)},o.prototype.reqJoinRoom=function(t){this._sender.send_JoinRoom(t)},o.prototype.joinroomresponse=function(e){var o=e.data,n=o.joinRoomResponse.joinRoom,i=t.$userData.pkRoomVO=new t.RoomVO;i.update(n),t.$facade.dispatch(21)},o.prototype.joinroomnotify=function(e){var o=e.data,n=o.joinRoomNotify.joinGamer;if(""===n.sNick||void 0===n.sNick){var i=this._GamerInfo.getGamerInfo();n.sHeadImg=i.sHeadImg,n.sNick=i.sNick,n.nRankLevel=i.nRankLevel}var r=t.$userData.pkRoomVO;r.updateOneGamer(n),t.$facade.dispatch(21),4===t.$userData.pkRoomVO.gamerList.length&&t.$facade.addModule(t.ModuleID.msg,void 0,"房间人数已达上限,请开始游戏")},o.prototype.reqLeaveRoom=function(){this._sender.send_LeaveRoom(t.$userData.pkRoomVO.id)},o.prototype.leaveroomresponse=function(e){t.$facade.removeModule(t.ModuleID.room),t.$facade.addModule(t.ModuleID.menu)},o.prototype.leaveroomnotify=function(e){var o=e.data,n=o.leaveRoomNotify.sID;n===t.$userData.pkRoomVO.bossID?(t.$facade.removeModule(t.ModuleID.room),t.$facade.addModule(t.ModuleID.menu)):(t.$userData.pkRoomVO.removeGamer(n),t.$facade.dispatch(22))},o.prototype.reqStarGame=function(){var e=t.$userData.pkRoomVO.id;this._sender.send_StarPkGame(e)},o.prototype.startgamenotify=function(e){var o=e.data,n=(o.startGameNotify.sRoomID,o.startGameNotify.nGID);t.$userData.pkRoomVO.playProtPKId=n,t.$facade.dispatch(18)},o.prototype.startgameresponse=function(t){t.data},o.prototype.reqMatchGame=function(){t.$userData.pkRoomVO.id;this._sender.send_MatchGame(t.$userData.pkRoomVO.id)},o.prototype.matchgameresponse=function(e){e.data;t.$facade.dispatch(21)},__decorate([t.InterestMessage(gameMsg.EnumMsg.createroomresponse)],o.prototype,"createroomresponse",null),__decorate([t.InterestMessage(gameMsg.EnumMsg.joinroomresponse)],o.prototype,"joinroomresponse",null),__decorate([t.InterestMessage(gameMsg.EnumMsg.joinroomnotify)],o.prototype,"joinroomnotify",null),__decorate([t.InterestMessage(gameMsg.EnumMsg.leaveroomresponse)],o.prototype,"leaveroomresponse",null),__decorate([t.InterestMessage(gameMsg.EnumMsg.leaveroomnotify)],o.prototype,"leaveroomnotify",null),__decorate([t.InterestMessage(gameMsg.EnumMsg.startgamenotify)],o.prototype,"startgamenotify",null),__decorate([t.InterestMessage(gameMsg.EnumMsg.startgameresponse)],o.prototype,"startgameresponse",null),__decorate([t.InterestMessage(gameMsg.EnumMsg.matchgameresponse)],o.prototype,"matchgameresponse",null),o}(t.ProxyBase);t.RoomProxy=e,__reflect(e.prototype,"game.RoomProxy")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var t=e.call(this,"gameSkin.RoomSkin")||this;return t.clickNum=0,t._listData=new eui.ArrayCollection,t}return __extends(o,e),o.prototype.createComponent=function(){},o.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.gamer_list.dataProvider=this._listData,this.gamer_list.itemRenderer=t.GamerInfo,this.btn_menu.on(egret.TouchEvent.TOUCH_TAP,this.GoMenuClick,this),this.btn_rank.on(egret.TouchEvent.TOUCH_TAP,this.GoRankClick,this),this.btn_return.on(egret.TouchEvent.TOUCH_TAP,this.onBackClick,this),this.btn_invite.on(egret.TouchEvent.TOUCH_TAP,this.onInviteClick,this),this.btn_create.on(egret.TouchEvent.TOUCH_TAP,this.onCreateClick,this),this.btn_match.on(egret.TouchEvent.TOUCH_TAP,this.onMatchingClick,this),this.btn_join.on(egret.TouchEvent.TOUCH_TAP,this.onJionRoomClick,this),this.btn_strGame.on(egret.TouchEvent.TOUCH_TAP,this.onStarGameClick,this)},o.prototype._initView=function(){this.group_create_room.visible=!0,this.group_create.visible=!0,this.group_invite.visible=!1,this.group_wait.visible=!1,this.text_roomID.text="",this.show_roomID.text="",this.updateTool()},o.prototype.onInviteClick=function(){0===this.clickNum?(this.show_roomID.text=t.$userData.pkRoomVO.id,this.clickNum=1):(this.group_create_room.visible=!1,this.group_wait.visible=!0,this.clickNum=0)},o.prototype.onBackClick=function(){this.dispatch(2,!0)},o.prototype.onStartClick=function(){this.dispatch(1,!0)},o.prototype.onCreateClick=function(){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),this.dispatch(4,!0)},o.prototype.onMatchingClick=function(){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),this.dispatch(5,!0)},o.prototype.onJionRoomClick=function(){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),this.text_roomID.visible?(this.dispatch(6,!0),this.text_roomID.visible=!1):this.text_roomID.visible=!0},o.prototype.GoMenuClick=function(){t.$facade.removeModule(t.ModuleID.room),t.$facade.addModule(t.ModuleID.menu)},o.prototype.GoRankClick=function(){t.$facade.addModule(t.ModuleID.rank)},o.prototype.onStarGameClick=function(){return"disabled"===this.btn_strGame.currentState?void t.$facade.addModule(t.ModuleID.msg,void 0,"等待好友加入......"):void this.dispatch(7,!0)},o.prototype.updateGamer=function(t){t.length<=2?this.sc_gamer.y=this.sc_gamer.y<=215?3*this.sc_gamer.y/2:this.sc_gamer.y:this.sc_gamer.y=this.sc_gamer.y>=215?this.sc_gamer.y/2:this.sc_gamer.y,this._listData.source=t,this._listData.refresh()},o.prototype.showWait=function(){t.$userData.account.userid.toString()===t.$userData.pkRoomVO.bossID&&(this.btn_return.visible=!0,this.btn_strGame.visible=!0,1===t.$userData.pkRoomVO.gamerList.length?this.btn_strGame.currentState="disabled":this.btn_strGame.currentState="up"),this.group_wait.visible=!0,this.group_create_room.visible=!1},o.prototype.updateTool=function(){this.addTime_Num.text=t.$userData.playerVO.toolMap[0].count.toString(),this.reduceTime_Num.text=t.$userData.playerVO.toolMap[1].count.toString()},o}(t.FullWindowBase);t.RoomFullWindow=e,__reflect(e.prototype,"game.RoomFullWindow")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onRegister=function(){t.prototype.onRegister.call(this)},e}(t.MediatorBase);t.SceneMediator=e,__reflect(e.prototype,"game.SceneMediator")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.percentHeight=100,this.percentWidth=100},Object.defineProperty(e.prototype,"layer",{get:function(){return 2},enumerable:!0,configurable:!0}),e}(eui.Component);t.SceneView=e,__reflect(e.prototype,"game.SceneView",["game.IModuleView"])}(game||(game={}));var game;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onRegister=function(){t.prototype.onRegister.call(this)},e}(t.MediatorBase);t.SetMediator=e,__reflect(e.prototype,"game.SetMediator")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var o=e.call(this,"gameSkin.SetSkin")||this;return o.btn_soundTab.touchEnabled=!1,o.btn_musicTab.touchEnabled=!1,o.sound=t.SoundManager.getInstance(),o}return __extends(o,e),o.prototype.createComponent=function(){},o.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.init(),this.btn_close.on(egret.TouchEvent.TOUCH_TAP,this.onCloseClick,this),this.btn_music.on(egret.TouchEvent.TOUCH_TAP,this.onMusicClick,this),this.btn_sound.on(egret.TouchEvent.TOUCH_TAP,this.isEffect,this)},o.prototype.init=function(){this.btn_music.currentState=t.SoundManager.getInstance().isMusic?"up":"down",this.btn_musicTab.currentState=this.btn_music.currentState,this.btn_sound.currentState=t.SoundManager.getInstance().isEffect?"up":"down",this.btn_soundTab.currentState=this.btn_sound.currentState},o.prototype.onCloseClick=function(t){this.dispatch(0,!0)},o.prototype.isEffect=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),t.SoundManager.getInstance().isEffect?(t.SoundManager.getInstance().isEffect=!1,this.btn_sound.currentState="down",this.btn_soundTab.currentState="down"):(t.SoundManager.getInstance().isEffect=!0,this.btn_sound.currentState="up",this.btn_soundTab.currentState="up")},o.prototype.onMusicClick=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),t.SoundManager.getInstance().isMusic?(t.SoundManager.getInstance().isMusic=!1,this.btn_music.currentState="down",this.btn_musicTab.currentState="down"):(t.SoundManager.getInstance().isMusic=!0,this.btn_music.currentState="up",this.btn_musicTab.currentState="up")},o}(t.DialogBase);t.SetDialog=e,__reflect(e.prototype,"game.SetDialog")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var o=e.call(this)||this;return o.sound=t.SoundManager.getInstance(),o}return __extends(o,e),o.prototype.createComponent=function(){},o.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.grp_dialog.visible=!1,this.btn_set.on(egret.TouchEvent.TOUCH_TAP,this.onSetClick,this),this.grp_music.on(egret.TouchEvent.TOUCH_TAP,this.onMusicClick,this),this.grp_sound.on(egret.TouchEvent.TOUCH_TAP,this.onSoundClick,this),this.init()},o.prototype.init=function(){this.img_music_off.visible=t.SoundManager.getInstance().isMusic?!1:!0,this.img_sound_off.visible=t.SoundManager.getInstance().isEffect?!1:!0},o.prototype.onSetClick=function(){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),this.grp_dialog.visible?this.grp_dialog.visible=!1:this.grp_dialog.visible=!0},o.prototype.onSoundClick=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),t.SoundManager.getInstance().isEffect?(t.SoundManager.getInstance().isEffect=!1,this.img_sound_off.visible=!0):(t.SoundManager.getInstance().isEffect=!0,this.img_sound_off.visible=!1)},o.prototype.onMusicClick=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),t.SoundManager.getInstance().isMusic?(t.SoundManager.getInstance().isMusic=!1,this.img_music_off.visible=!0):(t.SoundManager.getInstance().isMusic=!0,this.img_music_off.visible=!1)},o}(eui.Component);t.SetView=e,__reflect(e.prototype,"game.SetView")}(game||(game={}));var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(game.GameApp);__reflect(Main.prototype,"Main");var game;!function(t){var e=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.onRegister=function(){e.prototype.onRegister.call(this),this._view.getListData()},o.prototype.click=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl)},o.prototype.clickBack=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),t.$facade.addModule(t.ModuleID.menu)},o.prototype.clickToolBuy=function(e){if(t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),this._view.isToolCheckedFlage){var o=this._view._toolBuyIndex,n=this._view._SetMealCFG.getSetMealCFG(o),i={nID:n.toolId,nCount:n.num},r=[];r.push(i),this.model.reqToolBuy(r)}else t.$facade.addModule(t.ModuleID.msg,void 0,"请选择要购买的套餐")},o.prototype.clickDiamondBuy=function(e){if(t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),this._view.isDiamondCheckedFlage){var o=this._view._diamondBuyIndex;this._view._SetMealCFG.getDiamondCFG(o)}else t.$facade.addModule(t.ModuleID.msg,void 0,"请选择要购买的个数")},o.prototype.buyToolSuccess=function(){this._view.getListData(),this._view.total_money.text="0"},__decorate([t.InjectProxy(10)],o.prototype,"model",void 0),__decorate([t.InterestEvent(0)],o.prototype,"click",null),__decorate([t.InterestEvent(3)],o.prototype,"clickBack",null),__decorate([t.InterestEvent(1)],o.prototype,"clickToolBuy",null),__decorate([t.InterestEvent(2)],o.prototype,"clickDiamondBuy",null),__decorate([t.InterestNotify(28)],o.prototype,"buyToolSuccess",null),o}(t.MediatorBase);t.ShopMediator=e,__reflect(e.prototype,"game.ShopMediator")}(game||(game={}));var game;!function(t){var e=function(e){function o(){return e.call(this,10)||this}return __extends(o,e),o.prototype.reqToolBuy=function(t){this._senderHttp.send_BuyTool(t)},o.prototype.buyresponse=function(e){t.$facade.addModule(t.ModuleID.msg,void 0,"购买成功"),t.$facade.dispatch(28);var o=e.data.response;t.$userData.playerVO.nMoney=o.newAssets.nMoney,t.$userData.playerVO.nGold=o.newAssets.nGold,t.$userData.playerVO.updateTool(o.newAssets.sAssets)},__decorate([t.InterestMessage(gameMsg.EnumMsg.buyresponse)],o.prototype,"buyresponse",null),o}(t.ProxyBase);t.ShopProxy=e,__reflect(e.prototype,"game.ShopProxy")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var o=e.call(this,"gameSkin.ShopSkin")||this;return o._SetMealCFG=t.$singlon(t.SetMealCFG),o._toolListData=new eui.ArrayCollection,o._diamondListData=new eui.ArrayCollection,o}return __extends(o,e),o.prototype.createComponent=function(){},o.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.tool_list.dataProvider=this._toolListData,this.tool_list.itemRenderer=t.ShopItem,this.diamond_list.dataProvider=this._diamondListData,this.diamond_list.itemRenderer=t.DiamondItem,this.btn_back.on(egret.TouchEvent.TOUCH_TAP,this.onBackClick,this),this.sc_group.on(eui.UIEvent.CHANGE_START,this.onStartMove,this),this.sc_group.on(eui.UIEvent.CHANGE_END,this.onEndMove,this),this.btn_ToolBuy.on(egret.TouchEvent.TOUCH_TAP,this.onBuyToolClick,this),this.btn_diamondBuy.on(egret.TouchEvent.TOUCH_TAP,this.onBuyDiamondClick,this),this.tool_list.on(eui.ItemTapEvent.ITEM_TAP,this.onChecked,this),this.diamond_list.on(eui.ItemTapEvent.ITEM_TAP,this.onDiamondChecked,this)},o.prototype.onBackClick=function(t){this.dispatch(3,!0)},o.prototype.onBuyToolClick=function(t){this.dispatch(1,!0)},o.prototype.onBuyDiamondClick=function(t){this.dispatch(2,!0)},o.prototype.onStartMove=function(t){this.offsetXStart=this.sc_group.viewport.scrollH},o.prototype.onEndMove=function(t){this.offsetXEnd=this.sc_group.viewport.scrollH;var e=this.isRtoL(this.offsetXStart,this.offsetXEnd);e?this.offsetXEnd<=this.group_tool.width/2?egret.Tween.get(this.sc_group.viewport).to({scrollH:0},500,egret.Ease.backInOut).call(this.showToolTitle,this):egret.Tween.get(this.sc_group.viewport).to({scrollH:this.group_tool.width},500,egret.Ease.backInOut).call(this.showDiamondTitle,this):this.offsetXEnd<=this.group_tool.width/2?egret.Tween.get(this.sc_group.viewport).to({scrollH:0},500,egret.Ease.backInOut).call(this.showToolTitle,this):egret.Tween.get(this.sc_group.viewport).to({scrollH:this.group_tool.width},500,egret.Ease.backInOut).call(this.showDiamondTitle,this)},o.prototype.isRtoL=function(t,e){return e>=t?!1:!0},o.prototype.showToolTitle=function(){console.log("showToolTitle"),this.Tool_title.visible=!0,this.Diamond_title.visible=!1},o.prototype.showDiamondTitle=function(){console.log("showDiamondTitle"),this.Tool_title.visible=!1,this.Diamond_title.visible=!0},o.prototype.getListData=function(){this.Tool_title.visible=!0,this.isToolCheckedFlage=!1,this.isDiamondCheckedFlage=!1;for(var t=this._SetMealCFG.getAllSetMealCFG(),e=this._SetMealCFG.getSetMealLength(),o=[],n=0;e>n;n++)t[n].check=!1,o.push(t[n]);this.updateToolListData(o);for(var i=this._SetMealCFG.getAllDiamondCFG(),r=this._SetMealCFG.getDiamondLength(),a=[],n=0;r>n;n++)i[n].check=!1,a.push(i[n]);this.updateDiamondListData(a)},o.prototype.updateToolListData=function(t){this._toolListData.source=t,this._toolListData.refresh()},o.prototype.updateDiamondListData=function(t){this._diamondListData.source=t,this._diamondListData.refresh()},o.prototype.onChecked=function(t){this.isToolCheckedFlage=!0;for(var e=t.itemIndex,o=this._toolListData.source,n=0;n<o.length;n++)o[n].check=!1;o[e].check=!0,this.updateToolListData(o),0===o[e].gold?(this.total_money.text=o[e].money,this.flage_gold.visible=!1,this.flage_money.visible=!0):(this.total_money.text=o[e].gold,this.flage_money.visible=!1,this.flage_gold.visible=!0),this._toolBuyIndex=e},o.prototype.onDiamondChecked=function(t){this.isDiamondCheckedFlage=!0;for(var e=t.itemIndex,o=this._diamondListData.source,n=0;n<o.length;n++)o[n].check=!1;o[e].check=!0,this.updateDiamondListData(o),this._diamondBuyIndex=e},o}(t.FullWindowBase);t.ShopView=e,__reflect(e.prototype,"game.ShopView")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){var t=this.data;t.check?this.currentState="selected":this.currentState="normal",this.item_num.text=t.num,this.item_money.text=t.rmb},e}(eui.ItemRenderer);t.DiamondItem=e,__reflect(e.prototype,"game.DiamondItem")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){var t=this.data;this.updateState(t),t.check?this.currentState="selected":this.currentState="normal",this.item_num.text=t.num,0===t.money?(this.item_money.text=t.gold,this.flage_gold.visible=!0):(this.item_money.text=t.money,this.flage_money.visible=!0)},e.prototype.updateState=function(t){switch(t.toolId){case 0:this.add_time.visible=!0;case 1:this.reduce_time.visible=!0}},e}(eui.ItemRenderer);t.ShopItem=e,__reflect(e.prototype,"game.ShopItem")}(game||(game={}));var game;!function(t){var e=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.execute=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o]},o=__decorate([t.CacheCommand],o)}(t.Command);t.BagCommand=e,__reflect(e.prototype,"game.BagCommand")}(game||(game={})),Array.from||(Array.from=function(){var t=Object.prototype.toString,e=function(e){return"function"==typeof e||"[object Function]"===t.call(e)},o=function(t){var e=Number(t);return isNaN(e)?0:0!==e&&isFinite(e)?(e>0?1:-1)*Math.floor(Math.abs(e)):e},n=Math.pow(2,53)-1,i=function(t){var e=o(t);return Math.min(Math.max(e,0),n)};return function(t){var o=this,n=Object(t);if(null==t)throw new TypeError("Array.from requires an array-like object - not null or undefined");var r,a=arguments.length>1?arguments[1]:void 0;if("undefined"!=typeof a){if(!e(a))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(r=arguments[2])}for(var s,c=i(n.length),u=e(o)?Object(new o(c)):new Array(c),p=0;c>p;)s=n[p],a?u[p]="undefined"==typeof r?a(s,p):a.call(r,s,p):u[p]=s,p+=1;return u.length=c,u}}()),Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(t){if(null==this)throw new TypeError("this is null or not defined");for(var e=Object(this),o=e.length>>>0,n=arguments[1],i=n>>0,r=0>i?Math.max(o+i,0):Math.min(i,o),a=arguments[2],s=void 0===a?o:a>>0,c=0>s?Math.max(o+s,0):Math.min(s,o);c>r;)e[r]=t,r++;return e}});var game;!function(t){var e=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.onRegister=function(){e.prototype.onRegister.call(this);for(var t=[],o=1;100>o;o++)t.push({name:o});this._view.refreshList(t)},o.prototype.click=function(t){this._view.setTxt("你好")},__decorate([t.InjectProxy(0)],o.prototype,"model",void 0),__decorate([t.InterestEvent(0)],o.prototype,"click",null),o}(t.MediatorBase);t.TestMediator=e,__reflect(e.prototype,"game.TestMediator")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return t.call(this,0)||this}return __extends(e,t),e}(t.ProxyBase);t.TestProxy=e,__reflect(e.prototype,"game.TestProxy")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var t=e.call(this)||this;return t._listData=new eui.ArrayCollection,t}return __extends(o,e),Object.defineProperty(o.prototype,"layer",{get:function(){return 4},enumerable:!0,configurable:!0}),o.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.btn_click.on(egret.TouchEvent.TOUCH_TAP,this.onCLick,this),this.list_item.dataProvider=this._listData,this.list_item.itemRenderer=t.TestItem,this.item.data={name:200},this.itemcom.data={name:500}},o.prototype.onCLick=function(t){this.dispatch(0)},o.prototype.setTxt=function(t){this.txt_label.text=t},o.prototype.refreshList=function(t){this._listData.source=t,this._listData.refresh()},o}(eui.Component);t.TestView=e,__reflect(e.prototype,"game.TestView",["game.IModuleView"])}(game||(game={}));var game;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._invalidateDataFlag=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t,this._invalidateDataFlag=!0,this.invalidateProperties()},enumerable:!0,configurable:!0}),e.prototype.commitProperties=function(){t.prototype.commitProperties.call(this),this._invalidateDataFlag&&(this._invalidateDataFlag=!1,this.txt_name.text="第"+this.data.name+"关")},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){var t=this.data;this.txt_name.text="第"+t.name+"关"},e}(eui.Component);t.TestComponent=e,__reflect(e.prototype,"game.TestComponent")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){var t=this.data;this.txt_name.text="第"+t.name+"关"},e}(eui.ItemRenderer);t.TestItem=e,__reflect(e.prototype,"game.TestItem")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onRegister=function(){t.prototype.onRegister.call(this),this._view.showGamerInfo()},e}(t.MediatorBase);t.ToolMediator=e,__reflect(e.prototype,"game.ToolMediator")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var t=e.call(this,"gameSkin.ToolSkin")||this;return t._listData=new eui.ArrayCollection,t}return __extends(o,e),o.prototype.createComponent=function(){},o.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.gamerHead_list.dataProvider=this._listData,this.gamerHead_list.itemRenderer=t.GamerHeadItem,this.gamerHead_list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onItemTapHandler,this),this.btn_tool.on(egret.TouchEvent.TOUCH_TAP,this.onRemove,this)},o.prototype.onToolClick=function(){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),this.grp_tool.visible?this.grp_tool.visible=!1:this.grp_tool.visible=!0},o.prototype.showGamerInfo=function(){for(var e=[],o=t.$userData.pkRoomVO.gamerList,n=0;n<o.length;n++){var i=t.$userData.account.userid;o[n].sID!==i.toString()&&e.push(o[n])}console.log(e),this._listData.source=e,this._listData.refresh(),this.reduceTime_num.text=t.$userData.playerVO.toolMap[1].count.toString()},o.prototype.onItemTapHandler=function(e){var o=e.itemIndex,n=this._listData.source[o].sID;t.$userData.pkRoomVO.opponentID=n,t.$userData.pkRoomVO.toolID=1,t.$facade.removeModule(t.ModuleID.tool),t.$facade.dispatch(23)},o.prototype.onRemove=function(){t.$facade.removeModule(t.ModuleID.tool)},o}(t.DialogBase);t.ToolView=e,__reflect(e.prototype,"game.ToolView")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.drawMask(this.headImg_item0)},e.prototype.drawMask=function(t){var e=new egret.Shape;e.graphics.beginFill(255),e.graphics.drawCircle(28,28,25),e.graphics.endFill(),this.addChild(e),t.mask=e},e}(eui.ItemRenderer);t.GamerHeadItem=e,__reflect(e.prototype,"game.GamerHeadItem")}(game||(game={}));var game;!function(t){var e=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.seeAdFlage=!1,t}return __extends(o,e),o.prototype.onRegister=function(){e.prototype.onRegister.call(this),this.resetStar(),this.updatePortSart()},o.prototype.clickClose=function(e){this._view.goOne.play(0),setTimeout(function(){t.$facade.removeModule(t.ModuleID.win)},250)},o.prototype.clickNext=function(e){t.$facade.removeModule(t.ModuleID.win);var o=t.$userData.gamePortVO.playProId;o<t.$userData.portList.portList.length&&t.$facade.dispatch(15)},o.prototype.clickAgain=function(e){t.$facade.removeModule(t.ModuleID.win),t.$facade.dispatch(14)},o.prototype.clickRank=function(e){t.$facade.addModule(t.ModuleID.rank)},o.prototype.clickAd=function(t){this.seeAdFlage?console.log("请进行下一关"):(this.model.senSeeAd(),this.seeAdFlage=!0)},o.prototype.resetStar=function(){this._view.image0.alpha=this._view.image1.alpha=this._view.image2.alpha=0,this._view.image0.x=this._view.image1.x=this._view.image2.x=246,this._view.image0.y=this._view.image1.y=this._view.image2.y=211},o.prototype.updatePortSart=function(){this.seeAdFlage=!1;var e=t.$userData.gamePortVO.playProId,o=t.$userData.portList.getPort(e),n=o.starNum;this._view.refreshViewData(n),this._view.animationPlay(this._view)},__decorate([t.InjectProxy(3)],o.prototype,"model",void 0),__decorate([t.InterestEvent(1)],o.prototype,"clickClose",null),__decorate([t.InterestEvent(2)],o.prototype,"clickNext",null),__decorate([t.InterestEvent(3)],o.prototype,"clickAgain",null),__decorate([t.InterestEvent(4)],o.prototype,"clickRank",null),__decorate([t.InterestEvent(6)],o.prototype,"clickAd",null),__decorate([t.InterestNotify(11)],o.prototype,"updatePortSart",null),o}(t.MediatorBase);t.WinMediator=e,__reflect(e.prototype,"game.WinMediator")}(game||(game={}));var game;!function(t){var e=function(e){function o(){return e.call(this,3)||this}return __extends(o,e),o.prototype.senSeeAd=function(){this._senderHttp.send_See_Ad(1)},o.prototype.seeadresponse=function(e){var o=e.data;t.$userData.portList.updateKeyNum(o.response.nPrompt),t.$facade.addModule(t.ModuleID.ad)},__decorate([t.InterestMessage(gameMsg.EnumMsg.seeadresponse)],o.prototype,"seeadresponse",null),o}(t.ProxyBase);t.WinProxy=e,__reflect(e.prototype,"game.WinProxy")}(game||(game={}));var game;!function(t){var e=function(e){function o(){return e.call(this,"gameSkin.WinSkin")||this}return __extends(o,e),o.prototype.createComponent=function(){},o.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this);this._component;this.btn_close.on(egret.TouchEvent.TOUCH_TAP,this.onCloseClick,this),this.btn_next.on(egret.TouchEvent.TOUCH_TAP,this.onNextClick,this),this.btn_again.on(egret.TouchEvent.TOUCH_TAP,this.onAgainClick,this),this.btn_rank.on(egret.TouchEvent.TOUCH_TAP,this.onRankClick,this),this.btn_ad.on(egret.TouchEvent.TOUCH_TAP,this.onAdClick,this),this.btn_ad.group.addChild(this.image3)},o.prototype.onCloseClick=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),this.dispatch(1,!0)},o.prototype.onNextClick=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),this.dispatch(2,!0)},o.prototype.onAgainClick=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),this.dispatch(3,!0)},o.prototype.onRankClick=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),this.dispatch(4,!0)},o.prototype.onAdClick=function(e){t.SoundManager.getInstance().PlaySound(t.SoundManager.mClickAudioUrl),this.dispatch(6,!0)},o.prototype.animationPlay=function(t){switch(t.comeOne.play(0),this._starNum){case 1:t.starOne.play(0);break;case 2:t.starTwo.play(0);break;case 3:t.starThree.play(0)}},Object.defineProperty(o.prototype,"getStarNum",{get:function(){return this._starNum},enumerable:!0,configurable:!0}),o.prototype.refreshViewData=function(t){this._starNum=t},o}(t.DialogBase);t.WinDialog=e,__reflect(e.prototype,"game.WinDialog")}(game||(game={}));var game;!function(t){var e=function(){function e(){this._commonClock=new t.ClockManagerImpl,this._fightClock=new t.ClockManagerImpl
}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"commonClock",{get:function(){return this._commonClock},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fightClock",{get:function(){return this._fightClock},enumerable:!0,configurable:!0}),e}();t.Clock=e,__reflect(e.prototype,"game.Clock")}(game||(game={}));var game;!function(t){t.errorList=[];var e;!function(e){function o(e){t.$stage=e,t.$facade=t.Facade.instance,t.$clock=t.Clock.instance,t.$userData=t.UserData.instance,t.$singlon=t.getSinglon,t.GlobalInfo.init(),t.deployPool(egret.Bitmap,100),t.deployPool(eui.Image,100),e.on(egret.Event.RESIZE,function(){t.$facade.dispatch(0)},this),e.on(egret.Event.ENTER_FRAME,function(){t.GameTime.tick()},this);var o=egret.ticker.update;egret.ticker.update=function(){try{o.call(egret.ticker)}catch(e){var n=JSON.stringify({name:e.name,msg:e.message,stack:e.stack});if(-1==t.errorList.indexOf(n))throw t.errorList.push(n),e}},window.onerror=function(e,o,n,i,r){var a=JSON.stringify({msg:e,url:o,lineNo:n,columnNo:i,error:r});-1==t.errorList.indexOf(a)&&t.errorList.push(a)},window.addEventListener("unhandledrejection",function(e){var o="Uncaught (in promise) Error: "+e.reason;-1==t.errorList.indexOf(o)&&t.errorList.push(o)});var n=window.alert;n&&(window.alert=function(t){t&&/sound decode error:/.test(t)||n(t)})}e.init=o}(e=t.Global||(t.Global={}))}(game||(game={}));var game;!function(t){var e;!function(e){function o(e,o){return o||(o=e),t.MapUtil.getMoodPixel(e,o),o.x-=t.MapUtil.mapGridHeight/2,o.y-=t.MapUtil.mapGridWidth/2,o}function n(e,o){var n=t.$userData.gamePortVO.GameMapVO.mapData;return r.checkMap(e,o,n.data)}e.getMapBorderPixel=o,e.getBorderType=n;var i=function(){function t(){}return t.prototype.checkMap=function(t,e,o){return this._row=t,this._col=e,this._map=o,this.checkCenter()&&this.checkRight()&&this.checkBottom()&&this.checkRightBottom()?"":this.checkCenter()||this.checkRight()||this.checkBottom()||this.checkRightBottom()?this.checkCenter()&&this.checkRight()&&!this.checkBottom()&&!this.checkRightBottom()?"top":!this.checkCenter()&&!this.checkRight()&&this.checkBottom()&&this.checkRightBottom()?"bottom":this.checkCenter()&&!this.checkRight()&&this.checkBottom()&&!this.checkRightBottom()?"left":!this.checkCenter()&&this.checkRight()&&!this.checkBottom()&&this.checkRightBottom()?"right":this.checkCenter()||this.checkRight()||this.checkBottom()||!this.checkRightBottom()?!this.checkCenter()&&this.checkRight()&&this.checkBottom()&&this.checkRightBottom()?"leftTopMin":this.checkCenter()||this.checkRight()||!this.checkBottom()||this.checkRightBottom()?this.checkCenter()&&!this.checkRight()&&this.checkBottom()&&this.checkRightBottom()?"rightTopMin":this.checkCenter()||!this.checkRight()||this.checkBottom()||this.checkRightBottom()?this.checkCenter()&&this.checkRight()&&!this.checkBottom()&&this.checkRightBottom()?"leftBottomMin":!this.checkCenter()||this.checkRight()||this.checkBottom()||this.checkRightBottom()?this.checkCenter()&&this.checkRight()&&this.checkBottom()&&!this.checkRightBottom()?"rightBottomMin":"":"rightBottomMax":"leftBottomMax":"rightTopMax":"leftTopMax":""},t.prototype.checkCenter=function(){return!!this._map[this._row][this._col]},t.prototype.checkBottom=function(){return!!this._map[this._row+1][this._col]},t.prototype.checkRight=function(){return!!this._map[this._row][this._col+1]},t.prototype.checkRightBottom=function(){return this._col==this._map[0].length-1?!1:this._row==this._map.length-1?!1:!!this._map[this._row+1][this._col+1]},t}();__reflect(i.prototype,"CheckMap");var r=new i}(e=t.MapBorderUtil||(t.MapBorderUtil={}))}(game||(game={}));var game;!function(t){var e;!function(e){function o(t,o){return o||(o=t),t.x-=1,t.y-=1,e.getMoodPixel(t,o),o}function n(e){var n=t.recyclable(egret.Point);return n.x=e.x,n.y=e.y,o(n),n}function i(t,o){return o||(o=t),o.x=t.x*e.mapGridWidth,o.y=t.y*e.mapGridHeight,o}function r(e){var n=t.recyclable(egret.Point);return n.x=e.x,n.y=e.y,o(n),n}function a(t,o){return o||(o=t),t.x>=0?o.x=t.x%e.mapGridWidth/e.mapGridWidth>.5?Math.ceil(t.x/e.mapGridWidth):Math.floor(t.x/e.mapGridWidth):o.x=t.x%e.mapGridWidth/e.mapGridWidth>.5?Math.floor(t.x/e.mapGridWidth):Math.ceil(t.x/e.mapGridWidth),t.y>=0?o.y=t.y%e.mapGridHeight/e.mapGridHeight>.5?Math.ceil(t.y/e.mapGridHeight):Math.floor(t.y/e.mapGridHeight):o.y=t.y%e.mapGridHeight/e.mapGridHeight>.5?Math.floor(t.y/e.mapGridHeight):Math.ceil(t.y/e.mapGridHeight),o}function s(e){var o=t.recyclable(egret.Point);return o.x=e.x,o.y=e.y,a(o),o}e.mapTileWidth=50,e.mapTileHeight=50,e.mapGridWidth=50,e.mapGridHeight=50,e.getPixel=o,e.getPixelPoint=n,e.getMoodPixel=i,e.getMoodPixelPoint=r,e.getGrid=a,e.getGridPoint=s}(e=t.MapUtil||(t.MapUtil={}))}(game||(game={}));var game;!function(t){t.ErrorCodeText={2:"用户已存在",3:"密码错误",4:"余额不足",5:"关卡未解锁",6:"提示机会不足",7:"全部通关，大满贯"}}(game||(game={}));var game;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"useFilter",{get:function(){return"canvas"==egret.Capabilities.renderMode?!1:this._useFilter},set:function(t){this._useFilter=t},enumerable:!0,configurable:!0}),t._useFilter=!0,t}();t.GlobalConfig=e,__reflect(e.prototype,"game.GlobalConfig")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return Object.defineProperty(e,"account",{get:function(){return this._account},set:function(t){this._account=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"userinfo",{get:function(){return js_userInfo},enumerable:!0,configurable:!0}),e.init=function(){},e.initUserinfo=function(t){js_userInfo=t},e.initAccount=function(e){e&&"login:ok"==e.errMsg?this._account=e.code:(this._account=Date.now().toString(),t.setItem("userId",this._account));var o=t.$userData.account=new t.AccountVO;o.userid=this._account},e}();t.GlobalInfo=e,__reflect(e.prototype,"game.GlobalInfo")}(game||(game={}));var game;!function(t){var e;!function(t){t.loginwx="/loginwx",t.palybegin="/palybegin",t.palyend="/palyend",t.useprompt="/useprompt",t.seead="/seead",t.rank="/rank",t.game="/game",t.buy="/buy"}(e=t.Route||(t.Route={}))}(game||(game={}));var game;!function(t){var e;!function(t){t.HttpType="http://",t.SocketType="ws://",t.serverIP="58.87.124.239",t.port=8002}(e=t.ServerIP||(t.ServerIP={}))}(game||(game={}));